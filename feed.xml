<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
   <channel>
      <title><![CDATA[Delta Thoughts]]></title>
      <description><![CDATA[Delta Thoughts]]></description>
      <link>http://xperimex.github.io</link>
      <generator>RSS for Node</generator>
      <lastBuildDate>Thu, 15 Sep 2022 07:04:53 GMT</lastBuildDate>
      <atom:link href="http://xperimex.github.io/feed.xml" rel="self" type="application/rss+xml"/>
      <language><![CDATA[en]]></language>
      <item>
         <title><![CDATA[First Blog Post]]></title>
         <description><![CDATA[Hello, world! 

 <p><img src="/img/wildExponential.png" alt="Greetings..."></p>
<p><strong>Hello, World</strong>! I’m Adi Mittal, a student at <a href="http://terman.pausd.org">Terman Middle School</a>. I enjoy food, math, running, martial arts, and music of memes.</p>
<p>My main intent in starting this blog is to share my thoughts, ideas, and outlooks on cool math. My primary goal is to create content that&#39;s interesting and to share my thoughts on the world around me. I hope my ideas and thoughts can appeal to you, just as it did to me and showed me the interests of math!</p>
<hr>
<p><strong>UPDATE (AUGUST 1ST, 2021)</strong></p>
<p>As the years have gone by, I have moved on from my lowly middle school self and am now a rising senior at <a href="https://gunn.pausd.org/">Henry M. Gunn High School</a> who is still obsessing over math, but am also actively participating in track and field, the concert and jazz bands, Model United Nations, and acting as a key organizer in my school&#39;s <a href="https://tedxgunnhighschool.com/">TEDx organization</a>. My first year of high school was primarily situating myself in the new social dynamics and with all of these great clubs, so blogging was put on an indefinite hiatus as it floated to the back of my mind. A couple years ago, I partook in a research class in my sophomore year (which you can read about <a href="http://xperimex.com/blog/absenteeism/">here</a>) asked to summarize our work in a blog post, and it seemed like a great time to restart the site and continue writing. Since then, I&#39;ve been trying to write between school vacations, writing a couple times a month at my most efficient, but I try to get post at least once every couple of months.</p>
]]></description>
         <link>http://xperimex.github.io/blog/hello-world</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/hello-world</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[The Math of Coins]]></title>
         <description><![CDATA[Spinning Coins 

 <p><img src="https://media.giphy.com/media/11QVoapNuz4T8A/giphy.gif" alt="Spinning Coin"></p>
<p><strong>Coins!</strong> As some of you may relate to this, I love to take a coin, and just spin it on a flat surface or table. It&#39;s just satisfying, but being put to shame by the so called &quot;Fidget Spinner&quot;. I was spinning a coin a few days ago, and was ultimately bored at the time, so I decided to ask myself a simple question: <strong>What  information from the coin can be taken away from it spinning?</strong> This then was taken into is there a <strong>correlation</strong>, or ratio, between the <strong>rate at which the coin rotates</strong>, and the <strong>rate at which it &quot;wobbles&quot;</strong>. With a goal in mind, I picked up my pencil and started to work things out.</p>
<p>First things first, defining and finding all of our givens:</p>
<p><img src="/img/coinRep2.png" alt=""></p>
<p>This diagram represents what the coin might look like at a given instance.</p>
<p>What we know about the coin:</p>
<p>The <strong>radius</strong> of our coin $= R$<br>
The <strong>circumference</strong> of our coin $C = 2 \pi R$<br></p>
<p>Now for the circle our coin rotates and wobbles upon:</p>
<p>The <strong>radius</strong> of this circle is entirely dependant on the angle of the coin to the horizontal (table/flat surface. We will define that as $\theta$). Using the diagram, we can find that $r = R \cos (\theta)$ <br>
The <strong>circumference</strong> is $c = 2 \pi R \cos (\theta)$</p>
<p>With all the givens that we need out of the way, on to the application.</p>
<p>A thing to note is that as the coin completes a <strong>full rotation</strong> around the smaller circle, the <strong>original placement of the coin moves by a certain amount</strong>. You can easily demonstrate this by drawing an arrow on a quarter, and guiding it through a rotation on a circle smaller than the quarter.</p>
<p><br></p>
<p><img src="/img/quarter2.jpg" alt=""></p>
<center>This was the quarter I used when getting ideas on how the coin behaved.</center>

<p><br></p>
<p>This extra distance it covers can easily be thought out to be as $C - c$.</p>
<center>$C - c = 2 \pi R - 2 \pi R \cos (\theta) = 2 \pi R (1 - \cos(\theta))$</center>

<p>$2 \pi R (1 - \cos(\theta)) =$ the rate at which the distance our coin completes per revolution.</p>
<p>The rate for the distance per revolution our coin completes while &quot;wobbling&quot; is the same as the circumference our coin moves around upon, which we know is $2 \pi R \cos(\theta)$</p>
<p>Putting these two together as ratio of rate of rotation, to rate of &quot;wobbling&quot;, we get:</p>
<center> $\frac{\textrm{Rate of Spinning}}{\textrm{Rate of Wobbling}} = \frac{2 \pi R \cos (1 - \theta)}{2 \pi R cos (\theta)}$<br><br> $\large= \frac{1}{\cos (\theta)} - 1$ </center>


<p>This expression represents that at any given moment, the ratio between how fast the coin is spinning, and the how fast the coin is &quot;wobbling&quot; (which can be seen as the amount of hertz produced by the coin), will be $\frac{1}{\cos (\theta)} - 1$. This also means that if you multiply the frequency of &quot;wobbling&quot; by this expression, it will output how fast the coin should be spinning at the given value of theta. For example, let&#39;s say the coin is wobbling at a frequency of $5\,hertz$ at an angle of $\frac{\pi}{4}\,radians$ (because radians are cool), the coin would have to be rotating about $4.52\,revolutions\,a\,second$ to maintain that angle to the horizontal at that &quot;wobbling&quot; frequency (because of how hertz measure $cycles\,per\,second$, the cycles translate into revolutions for the output). </p>
<p>Of course, this is all theoretical. In practice, the coin may slip. Wind may change the local air pressure, thus changing the air resistance. Everything needs to stay <strong>constant</strong>, with no disturbances or changes occuring during the coin&#39;s movement. But this is still a neat thing if you were to ask me!</p>
<p>Just to recap, we took the basics and givens of our coin and it&#39;s enviornment. Used those to get the generalized rates of the coin spinning and wobbling. We then used those calculate our ratio between the two at a given instant. Not bad!</p>
<p>If you have any questions or comments, send me an email or leave a comment!</p>
]]></description>
         <link>http://xperimex.github.io/blog/math-of-coins</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/math-of-coins</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Trial and Eventual-Success]]></title>
         <description><![CDATA[This triangle though... 

 <p><img src="" alt=""></p>
<p><strong>How do you... How do you even...</strong> This is when you know the problem you are about to be shown, will be annoying. When a friend of mine first introduced this problem, I thought this would be very, VERY simple, to solve. Use some angle properties, use the given similar triangles, and soon enough, a solution will be found. Of course this didn&#39;t work. I tried a few other things, same result. Showed it to my family, not much help was gained. They tried what I did. Then it hit me. The goal is to find a specific <strong>measure</strong> of the <strong>triangle</strong>s. <strong>Trigonometry</strong> $=$ The <strong>Measurement of Triangles</strong>. The solution quickly followed using a specific property, and I was like, &quot;Meh. That was quite obvious.&quot; Enough ranting, it&#39;s time you got a look at the problem itself.</p>
<p><br>
<em>In the diagram below,</em> $\angle ABC = \angle ACB = \angle DEC = \angle CDE$, $\,\overline {BC} = 8$, <em>and</em> $\,\overline {DB} = 2$. <em>Find</em> $\,\overline {AB}$
<img src="/img/trollTriangle.png" alt=""></p>
<p><br>
When drawing everyting out...</p>
<p><img src="/img/trollTriangleGiven.png" alt=""></p>
<center>
<em>SPOILER ALERT</em>
<br>
Before you continue reading, I highly encourage you attempt this geometry problem. It&#39;s an interesting problem, and once you found the concept you need to use to solve it, it&#39;s all an easy ride down from there. Following this warning will be the full solution and my thoughts on how I solved this myself. I know I already talked about my thoughts and how I solved this a little in the beginning of this post, but from here on will be <em>everything</em> I thought about.
<br>
<strong>You have been warned...</strong>
</center>
<br><br>

The property I thought of (after my 45 minutes of trial-and-error) that we can use to solve for $\,\overline {AB}$ is the <strong>The Law of Sines</strong>, which states:
<center>
$\large \frac{a}{\sin A} = \frac{b}{\sin B} = \frac{c}{\sin C}$
<br><br>
Where $A$ is the angle oposite of $a$, $\,B$ is the angle oposite of $b$, and $C$ is the angle oposite of $c$.
</center>

<p>We can rewrite this using the diagram:</p>
<center>

$\large \frac{\overline{BC}}{\sin \angle BAC} = \frac{\overline{AC}}{\sin \angle ABC} = \frac{\overline{AB}}{\sin \angle ACB}$

</center>

<p><br>
So now that we have this written out, we can start solving for $\,\overline {AB}$. For convenience, I&#39;m going to refer to the angles equivalent to $\,\angle ABC$ as $\,\theta$.</p>
<p>Using the <strong>Angle Sum Theorem</strong>, $\,\angle BAC = 180 - 2 \theta$. Using this, we can find an expression equal to $\,\overline {AB}$.</p>
<center>

$\large \frac{\overline {BC}}{\sin \angle BAC} = \frac{\overline {AB}}{\sin \angle ACB}$

<br><br>Doing some substitution...<br><br>

$\large \frac{8}{\sin 2 \theta} = \frac{\overline {AB}}{\sin \theta}$


</center>


<p>For where the $\sin 2 \theta$ came from, $\sin 180 - 2 \theta$ when evaluated, is the same as $\sin 2 \theta$. Now for some expansion and evaluation...</p>
<center>

$\large \frac{8}{2 \sin \theta \cos \theta} = \frac{\overline {AB}}{\sin \theta}$

<br><br>

$\overline {AB} \sin \theta \cos \theta = 4 \sin \theta$

<br><br>

$\overline {AB} = \large \frac{4}{\cos \theta}$

</center>

<p>Now that we have an <strong>expression</strong> for $\overline {AB}$, we just need to find a value of $\cos \theta$, and that will give us the length of $\overline {AB}$! So now, what can we do? What I first thought (based on the information we were given), if we find two expressions representing the value of the <strong>same side length</strong>, we can set those two expressions to equal one another, to find a value that makes that equation true. That equation will mostly likely output a value of a function of an angle, as we know very few side lengths, and know no angles (we&#39;re hoping it would output a value of $\cos \theta$). Again, this is only what I was thinking when solving this problem at the time. The only reason I thought this, is that I noticed two triangles, that were similar to $\triangle ABC$, contained within $\triangle ABC$. </p>
<p><img src="/img/trollTriangleSimilars.png" alt=""></p>
<p><br></p>
<p>We have similar triangles $\triangle DEC$ and $\triangle BEC$. And we know that they are similar as the both triangles share the same angles ($\theta, \theta, and \,180 - \theta$) as the original triangle $\triangle ABC$. And rememeber that side length I mentioned earlier that we could find two expressions for, and use those to solve for its length (that&#39;s a mouthful)? That length is $\overline {CE}$! It shares a side length with $\triangle DEC$ and $\triangle BEC$, and we can find our two expressions, by solving for the length of $\overline {CE}$ once, in $\triangle DEC$, and again in $\triangle BEC$. Agian, we&#39;re hoping for a value of $\cos \theta$. Starting by solving for $\triangle BEC$...</p>
<p>We are given the length of $\overline {BC} = 8$, which simplifies our job quite a bit. We can do the same thing we did to find an expression for $\overline {AB}$: Use the <strong>Law of Sines</strong>!</p>
<center>

$\large \frac{8}{\sin \theta} = \frac{\overline {CE}}{\sin 2 \theta}$

<br><br>

$\large \frac{8}{\sin \theta} = \frac{\overline {CE}}{2 \sin \theta \cos \theta}$

<br><br>

$\overline {CE} \sin \theta = 16 \sin \theta \cos \theta$

<br><br>

$\overline {CE} = 16 \cos \theta$


</center>


<p><br></p>
<p>We now have a value of $\overline {CE}$ from $\triangle BEC$, time to solve $\overline {CE}$ for $\triangle DEC$...</p>
<p><br>
First off, all though it&#39;s not stated, we know the length of $\overline {DE}$. $\triangle BEC$ is an isosceles, where $\angle BEC = \angle ECB$, which also means $\overline {BC} = \overline {BE}$. As $\overline {BC} = 8$, therfore $\overline {BE} = 8$. Since we were told $\overline {DB} = 2$, we can solve $\overline {BE} - \overline {BD} = \overline {DE} = 6$. Now back to the all-mighty, <strong>Law of Sines</strong>...</p>
<center>

$\large \frac{\overline {DE}}{\sin 2 \theta} = \frac{\overline {CE}}{\sin \theta}$

<br><br>

Substitution and expansion...

<br><br>

$\large \frac{3}{\sin \theta \cos \theta} = \frac{\overline {CE}}{\sin \theta}$

<br><br>

$\overline {CE} \sin \theta \cos \theta = 3 \sin \theta$

<br><br>

$\overline {CE} = \large \frac{3}{\cos \theta}$

</center>

<p><br></p>
<p>Great! We&#39;re lucky that it came out as a value of $\cos \theta$, but anyways, we have our two expressions, now just to set them equal to one another...</p>
<center>


$16 \cos \theta = \large \frac{3}{\cos \theta}$

<br><br>

$16 \cos^2 \theta = 3$

<br><br>


$cos^2 \theta = \large \frac{3}{16}$

<br><br>

$\cos \theta = \large \frac{\sqrt{3}}{4}$


</center>

<p><br></p>
<p>Now that we have our value of $\cos \theta$, we can just substitute this into our original expression for $\overline {AB}$...</p>
<center>

$\overline {AB} = \large \frac{4}{\cos \theta}$

<br><br>

$= \large \frac{4}{(\frac{\sqrt{3}}{4})}$

<br><br>

$ = \large \frac{16}{\sqrt{3}}$
</center>


<p><br></p>
<p>And there it would be, our solution! Although it might of seemed quite lengthy to get to $\frac{16}{\sqrt{3}}$, it all just revolved around the one concept of the <strong>Law of Sines</strong>, so not to bad.</p>
<p><br></p>
<p>Although this is one way to obtain the solution, I&#39;m sure there are other ways to tackle this problem, and I found another way which completely negates our first step, to find an expression for $\overline {AB}$, but adds an extra step to the end.</p>
<p><br>
With our value of $\cos \theta = \frac{\sqrt{3}}{4}$, we can draw a right triangle with this as one of our angles with a bit moving around.</p>
<center>

$\theta = \arccos \large \frac {\sqrt{3}}{4}$

</center>

<p><img src="/img/trollTriangleRight.png" alt=""></p>
<p><br></p>
<p>We can do this, because as we stated earlier $\theta = any\,angle\,equivalent\,to\, \angle ABC$ (and that&#39;s the exact angle we&#39;re working with). We also <strong>bisected</strong> $\overline {BC}$ at $F$ to form the 2 right triangles within our isosceles triangle, so the length of $\overline {BF} = 4$. We can then use some basic trigonometry and evaluation to solve for $\overline {AB}$.</p>
<p><br></p>
<center>

$\theta = \arccos \large \frac {\sqrt{3}}{4}$
<br><br>

$\cos \theta = \large \frac {4}{\overline {AB}}$

<br><br>

$\cos (\arccos \large \frac {\sqrt{3}}{4}) = \large \frac {4}{\overline {AB}}$

<br><br>

$\large \frac {\sqrt{3}}{4} = \large \frac {4}{\overline {AB}}$

<br><br>

${\large \frac {\sqrt{3}}{4}} \overline {AB} = 4$

<br><br>

$\overline {AB} = \large \frac{16}{\sqrt{3}}$

</center>
<br>
Just another simple way of getting to the exact same answer.


<br><br>
If you have any questions or comments, send me an email or leave a comment!




<br><br><br>

<strong>EDIT (JULY 3RD, 2017): RECURSIVE DIVISIONS SOLUTION</strong>

<br>

This specific solution, is one of my favorites that I have seen. One of my inital attempts was to use the dimensions of the similar triangels and find the common ratio between the side length and the base of the triangle. I knew it could be done, but never put my finger on it. However, when a friend of mine took a look at this problem, after a bit of thought, he managed to come up with this. It&#39;s really quite a spectacular of a solution, and this is credited entirely to him (no use of name for privacy reasons). Oh, and I&#39;ll be speaking in first person, just so I don&#39;t cause any confusion, or make it seem like I&#39;m taking it as mine. Just to be clear.

<br>

So the first step is to take the three triangles we know to be similar to one another ($\triangle ABC, \triangle BEC, and \triangle CED$. We know that they are similar due to the fact they all share two common angles, which force them to have a common ratio between the base and a leg of the triangle. This will be important to remember later), and we will $0-index$ them from the original triangle, to the following divisions within one another. I will also now be referring to the triangles by their respective index numbers.

<img src="/img/trollTriangleDivided.png" alt="">

<br>

Now using the fact that every triangle is similar, and that each progressive triangle was formed by using the base length of the previous triangle to form the leg of the next triangle, we can find a ratio between a dimension (say, the base) of a triangle, and its previous/next triangle, and use that to find the length of $\overline{AB}$. I know that is kind of confusing right now, but trust me, it will makes more sense the more I go on.

<br>

So we know the base length of two bases of two triangles ($\triangle 0$, and $\triangle 2$). Since we know that they should share a common ratio, we can right them as a ratio between one another, and hence find said ratio.

<br><center>

$\large \frac{\overline{BC}}{\overline{DE}} = \frac{8}{6}$

<br><br>

$\large = \frac{4}{3}$

<br>

</center>

<p>So we have a ratio, but the problem with this ratio it&#39;s for two divisions. It&#39;s for going between $\triangle 0$ and $\triangle 2$. We want one between $\triangle 0$ and $\triangle 1$, or $\triangle 1$ and $\triangle 2$. But this is easy! Since a division in this case is a factor of the previous triangle. This means if we take some dimenstion _a_ of a triangle, multiply it by our ratio <strong>once</strong>, we will obtain the dimension _a_ of the next division&#39;s triangle. For an example, if we have triangle-base $\overline{BC}$, and multiply it by our ratio, we should get the length of triangle-base $\overline{EC}$. Take a look at the diagram if that helps. Essentially, the base length of $\triangle 0$, multiplied by some ratio, we will get the base length of $\triangle 2$, and do that again, we will get the base length of $\triangle 3$. Now if you see, we had to multiply <strong>twice</strong> to get from $\triangle 0$ to $\triangle 2$. A.K.A., take the square of the ratio. To undo a square, you take the <strong>squareroot</strong>. So we can undo our two-division ratio, by taking the squareroot of that, to get our one-division ratio.
<br></p>
<center>

$\sqrt{\large{\frac{4}{3}}} = \large{\frac{2}{\sqrt{3}}}$ 

</center>

<p>So that&#39;s our ratio between a one triangle division. So now we need to find the length of $\overline{AB}$. So we can do what we did originally with the base lengths, only with the legs of the triangle. Larger triangle, over the divided triangle. In this case, $\triangle 0$ over $\triangle 1$.</p>
<p><br></p>
<center>

<p>$\large \frac{\overline{AB}}{\overline{BC}} = \frac{2}{\sqrt{3}}$</p>
<p><br><br></p>
<p>$\large \frac{\overline{AB}}{8} = \frac{2}{\sqrt{3}}$</p>
<p><br><br></p>
<p>$\overline{AB} = \large \frac{2 \cdot 8}{\sqrt{3}}$</p>
<p><br><br></p>
<p>$\overline{AB} = \large \frac{16}{\sqrt{3}}$</p>
<p><br>
</center>
And there it is! The answer we had before. I cannot tell you how cool of a solution this is. Simple in concept, but well executed. So major props to my friend for carrying out such a clean solution. I tried this, completely missed the obvious, and he did not. Major props to him.</p>
]]></description>
         <link>http://xperimex.github.io/blog/similar-trangles-problem</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/similar-trangles-problem</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[How fast can I travel? Part 1]]></title>
         <description><![CDATA[Answer: Too fast 

 <p><img src="" alt=""></p>
<p>The Earth has a diameter of approximately 12742000 meters. Most people of course wouldn&#39;t travel that far, but what if you did? How fast can you get across with nothing but yourself? That&#39;s essentially what people have asked in the form of the question: How long will it take to fall through the center of the Earth?
<br><br></p>
<center>

<em>SPOLIER WARINING:</em><br>

<em>THIS WARNING IS TO INDICATE ANY WORD FOLLOWING THIS MESSAGE WILL BE A PART OF THE SOLUTION TO THIS PROBLEM. HIGHLY ENCOURAGE THE ATTEMPT TO SOLVE THIS PROBLEM.</em> <br>

<em>YOU HAVE BEEN WARNED...</em>


</center>
<br><br><br> Following our standard procedure, let&#39;s list all the givens:

<br>
<center>
$The\,radius\,of\,the\,Earth is R = 6,371,000$ meters

<br><br>
$The\,Force\,of\,Gravity\,is\,F = \large \frac{G m M}{r^2}$
<br><br>
Where...<br> $G = Gravity$<br>
$m = Mass\,of\,Object_1\, (in\,this\,case,\,us)$<br>
$M = Mass\,of\,Object_2\,(in\,this\,case,\,Earth)$<br>
$r = the\,distance\,between\,m\,and\,M.$
</center>

<p>So now we are just trying to find as many values or expressions to variables within that eqauation of force. We can leave $m$ as is, becuase that&#39;s the mass of our human/us. So what we really need is $r$ and $M$.</p>
<p><img src="/img/earthModel.png" alt=""></p>
<p><br></p>
<p>One thing we have to worry about though, is that as we fall $r$ will change. As we fall we will get clsoer to Earth&#39;s center of mass, eventually pass it, and then get farther from it. So we will call our current distance relative to Earth&#39;s center of mass as $x$. And what&#39;s great about this, if we are any distance into our fall, we can just ignore any mass above us. Using the diagram as an example, if we are $R-x$ deep into our fall, we can ignore any mass of Earth contained between $R$ and $x$. Some of you may think, &quot;But wait! Wouldn&#39;t the mass above us have it&#39;s own force of gravity acting upon you, and therefore slowing you down as you fall?&quot; The answer is technically yes, but that all balances out with the mass <em>below</em> you and to the <em>side of</em> you. All these forces cancel out, making it not affect you at all. So, all we really care about is the amount of mass below us, and the distance between us and the Earth&#39;s center of mass (which would be the radius $x$ as we have been discussing). So we have one variable filled.</p>
<p><br></p>
<center>

$F = \large \frac{G m M}{x^2}$

</center>

<p>Now we need $M$. The formula for mass is $M = volume \times density$. The volume of the Earth $= \frac{4 \pi x^3}{3}$ (we are using $x$ again as the mass affecting us changes over our fall). And we can represent density with $\rho$. So the $M$ equals:</p>
<p><br></p>
<center>

$\large \frac{4 \pi \rho x^3}{3}$

</center>

<p>Putting this all together, the force of gravity acting upon us during this fall equals:</p>
<p><br></p>
<center>

$F = \large \frac{4 \pi G m \rho x^3}{3 x^2}$
<br><br>

$ = \large \frac{4 \pi G m \rho}{3} x$

</center>

<p>If we let $\frac{4 \pi G m \rho}{3} =$ say, v, we get $F = -v x$. It&#39;s negative because we are falling first. This is actually an <strong>oscillating system</strong>. To represent this, I&#39;ve made a mock graph to show how gravity affects us over time starting from the top of &quot;Earth&quot;. The graph is just a representation.</p>
<p><img src="/img/oscillatingModel.png" alt=""></p>
<p><br></p>
<p>If the x-axis is time, and we fell from the top of Earth (and there is NO air resistence), as you can see, we would just continuously bounce back and forth between the top and bottom of the Earth. Now we need to find the <strong>period</strong> of our oscillating system. The period is the time it takes for one cycle to be completed. To be more precise, we need <em>half</em> of the period. That is because one cycle (in this case) is falling all the way down, and coming all the way back. We only want the time it takes to fall down, so that&#39;s why the half.</p>
<p>The eqauation for the period of a simple oscillating system (also called a harmonic motion) is:</p>
<p><br></p>
<center>

$P = 2 \pi \sqrt {\large \frac {m}{k}}$


</center>


<p>The variable representation is that $k$ is our oscillating system, and $m$ is our mass. But since we want half of that, so therefor time to fall through the Earth is...</p>
<p><br></p>
<center>

$Time = \pi \sqrt {\large \frac {m}{k}}$
<br><br>
Doing some substitution...

<br><br>


$Time = \pi \sqrt {\large \frac {m}{\large \frac{4 \pi G m \rho}{3}}}$

<br><br>

$ = \pi \sqrt {\large \frac {3 m }{4 \pi G m \rho}}$

<br><br>

$ = \sqrt {\large \frac {3 m \pi^2}{4 \pi G m \rho}}$

<br><br>

$ = \sqrt {\large \frac {3 \pi}{4 G \rho}}$


</center>

<p>Now all we need to do is put in $G$ as the Gravitational Constant, and $\rho$ as the density ($\rho = \frac{mass}{volume}$) of Earth (I did some Googling...)!</p>
<p><br></p>
<center>

$Time = \sqrt {\large \frac {3 \pi}{4 \cdot 6.67408 \cdot 10^{-11} \cdot m^3 \cdot kg^{-1} \cdot s^{-2} \cdot \frac{5.972 \cdot 10^{24}\, kg}{\frac{4 \pi \cdot 6371000^3}{3} \, m^3} }}$

<br><br>

</center> This looks bad. Let&#39;s clean it up.
<br><br>

<center>
$= \sqrt {\large \frac {3 \pi}{4 \cdot 6.67408 \cdot 10^{-11} \cdot m^3 \cdot kg^{-1} \cdot s^{-2} \cdot \frac{5.972 \cdot 10^{24} \cdot 3 \, kg}{4 \pi \cdot 6371000^3 \, m^3} }}$

<br><br>

$= \sqrt {\large \frac {3 \pi}{4 \cdot 6.67408 \cdot 10^{-11} \cdot s^{-2} \cdot \frac{5.972 \cdot 10^{24} \cdot 3}{4 \pi \cdot 6371000^3} }}$

<br><br>

$ = \sqrt {\large \frac {3 \pi \cdot s^{2}}{4 \cdot 6.67408 \cdot 10^{-11} \cdot \frac{5.972 \cdot 10^{24} \cdot 3}{4 \pi \cdot 6371000^3} }}$

<br><br>


$ = s \sqrt {\large \frac {3 \pi}{4 \cdot 6.67408 \cdot 10^{-11} \cdot \frac{5.972 \cdot 10^{24} \cdot 3}{4 \pi \cdot 6371000^3} }}$

</center>

<p>So, I don&#39;t know about you, but when I have something like this, I just straight up put it into <a href ="http://www.m.wolframalpha.com"> <em>Wolfram Alpha</em> </a>, or a similar calculator, as I am just lazy and it&#39;s a pain to evaluate. So, letting it be computed by the calculator...</p>
<p><br></p>
<center>

$Time = s \sqrt {\large \frac {3 \pi}{4 \cdot 6.67408 \cdot 10^{-11} \cdot \frac{5.972 \cdot 10^{24} \cdot 3}{4 \pi \cdot 6371000^3} }}$

<br><br>

$ \large = 2530.5\,seconds$

</center>

<p>This, funnily enough is also the answer to the universe and all of its questions. $2530.5\,seconds = 42\,minutes\,(+10.5\,seconds)$. Quite a coincidence if I say so!</p>
<p><br></p>
<p>Now what&#39;s great about our equation we used ($ = \sqrt {\frac {3 \pi}{4 G \rho}}$), it&#39;s quite easy to apply to other objects, as most of it is constant! 3, is well, a constant. So is 4. $\pi$ has been universally agreed upon for its value. And as far as we can tell in the universe, the Gravitational Constant is true. The only thing that determines the fall length is the density. So you could have two planets, one with $x$ as its radius, and the other as $100 x$. If the are just as dense as one another, you will fall through them (across the diameter) in the same time.</p>
<p><br></p>
<p>Now just as a random fact that I thought was amusing, was the top speed you would attain. We know that acceleration due to gravity on Earth is $\frac{9.807\,m}{s^2}$. The top speed would be when you reach the center of the Earth, which is 6,371,000 meters from the surface (aka, the radius of Earth). Using this, we can calculate the speed at which we would be at in meters per second at the center. Just to be sure, we can calculate acceleration due to gravity, using our original formula, where we ignore our mass: $g = \frac{G \cdot M_{Earth}}{R^2}$</p>
<p><br></p>
<center>

$g = \large \frac{G \cdot M_{Earth} }{R^2}$


<br><br>

</center> Substituting everything we have... <center> <br><br>

$g = \frac{6.67408 \cdot 10^{-11} \cdot m^3 \cdot kg^{-1} \cdot s^{-2} \cdot 5.972 \cdot 10^{24}\, kg }{6371000^2\,m^2}$

<br><br>

$g = \frac{6.67408 \cdot 5.972 \cdot 10^{13} \cdot m}{6371000^2 \cdot s^2}$

<br><br>

Thanks to a calculator...

<br><br>

$\approx \large\frac{9.82m}{s^2}$

</center>

<p>Of course this is not the same as what others have put on the internet, values will differ from here to there. I trust the value of $\frac{9.807m}{s^2}, as I think there values they used to calculate it would be more accurate. Back to the top speed now.</p>
<p><br></p>
<center>

$g = \large \frac{9.807\,m}{s^2}$

<br><br>

$ = \large \frac{9.807 \cdot 6371000}{s^2}$

<br><br>

$ = \large \frac{\sqrt{9.807 \cdot 6371000}}{s}$

<br><br>

$\approx \large \frac{7904.454251 m}{s}$

<br>
</center>
Which is equivalent to...

<br><br>

<center>

$\approx \large \frac{28456.035304\,km}{hour}$

<br><br>

$\approx \large \frac{17681.760583\,miles}{hour}$

</center>

<p>That&#39;s about 23.23 times the speed of sound! This literally means you can&#39;t yell during this fall, as you would be going literally faster than the time it takes to vibrate the air around you. It will be a silent fall. That is, if there was air, and the terminal velcoity of a human wasn&#39;t $\frac{53m}{s}$.</p>
<p><br></p>
<p>So that would be it for this post! We found out we can cross Earth in under 45 minutes, and break the sound barrier 23 times over! <br></p>
<p>I plan on following it up with another post showing how you can use integration to find the time to fall through Earth (and that equation to find the period of an oscillating system/simple harmonic motion that kind of came out of nowhere. The $2 \pi \sqrt{\frac{m}{k}}$), and to show some other cool properties and interesting things about falling, pendulums, and oscillating systems in general.</p>
<p><br></p>
<p>Now here&#39;s an extra challenge for you: How long will it take to fall through Earth, 500 kilometers above the surface?</p>
<p><br></p>
<p>If you have any questions or comments, send me an email or leave a comment!</p>
]]></description>
         <link>http://xperimex.github.io/blog/falling-through-earth</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/falling-through-earth</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[To equal NP or to not equal NP. That is the question.]]></title>
         <description><![CDATA[I tried... 

 <p><img src="" alt=""></p>
<p>There is just no introduction needed here. The problem at hand is probably one of the hardest, most controversial topic in computer science:
<br><br></p>
<center><em>Prove that</em> $P = NP$, <em>or otherwise</em></center>

<p><br></p>
<p>In case this is not clear (or never have heard this problem before), it is to show that all NP-hard problems are P problems, or show that they are not equal. An NP-hard problem is a problem that cannot be solved in polynomial time ($NP$ represents for non-deterministic polynomial-time, and $P$ just represents for polynomial-time). Polynomial time is time that can be represented as a function of the input (input being whatever you need to achieve/solve for in the problem), and the function is a simple polynomial function. For example, the following function representing the time it takes to solve some problem,
<br></p>
<center>$f(x) = p(x^k)$, where $k$ is constant</center>
<br>
..., this would classify the problem as a $P$ problem, as we can represent the time it takes to solve the problem as a simple polynomial function. An example for how long some $NP-hard$ problem might take to solve would be such as...
<br>
<center>$f(x) = p(k^x)$, where $k$ is constant</center>
<br>
This is bad for computation time, since $x$ is our input, our values would explode the greater the amount of input we have. That&#39;s why this is an $NP-hard$ problem. We would essentially have to brute force our, and check every possible scenario (within allotted values for our problem) to solve for this. 
<br>
So now the reason why this problem is so controversial, it&#39;s because that if we can show that $P = NP$ is true, we can then theoretically solve ANY problem within an algorithmic, and in polynomial time. It will cut so much time off of the time it takes to solve all the crazy hard, unsolved problems.

<br>
And I know, some of you may be thinking, &quot;But, hey! Wouldn&#39;t most problems need a completely different approach to solve, than another problem?&quot; Well, my response to this, would be yes, but, there are some $NP-hard$ problems that <em>have</em> been solved. These are called $NP-complete$ problems. The reason why these are important (especially when answering the above question) is because a common way to tackle these $NP-hard$ problems is by boiling it down to a smaller, similar, $NP-complete$ problem, and then brute force it in a way similar to that $NP-complete$ problem. <a href = "https://en.wikipedia.org/wiki/List_of_NP-complete_problems"> Here is a list of $NP-complete$ problems. </a>

<br><br>

<img src="/img/np-reduction.png" alt="">
<center>This here shows how you can work from one $NP-hard$ problem to another, smaller, but related problem.</center>

<p><br></p>
<p>Okay, now with that all out of the way, the reason why I started discussing $NP-problems$, the $P$ versus $NP$ problem. This problem bothers me so much, for a few reasons. <strong>ONE</strong>: This seems a lot easier to solve than it actually is, and this just intuitively bothers me more than other problems do. It seems like such a simple statement to show, but it&#39;s just not. <strong>TWO</strong>: The way people are approaching this problem, it seems all to <em>awkward</em> and incorrect to me. It seems that they are overcomplicating this quite a bit. But this is computer science, so I don&#39;t have much say. And the person who proved <em>Fermat&#39;s Last Theorem</em> did so in more or less 150 pages (I think), so this could very well be so as well.</p>
<p><br></p>
<p>My attempts haven&#39;t been as successful (well, if it was successful, I would be too excited to write this up), but I do have a few thoughts on the matter. My first attempt was rather bleak. Take a generalized form of the time it takes to solve an $NP-hard$ problem, and just try to work it down to some representation of polynomial time. This obviously, did not work. What ended up happening was that I was trying to represent the wrong variable into polynomial-time representation, and couldn&#39;t find a way to expand on onto the variable that I needed to express. So, that idea was gone. The second idea, would be a bit more practical. Take some $NP-complete$ problem, look at it how it&#39;s time is in its NP form, then try to find some algorithm that results in the same solution, but is in polynomial time. The reason why I would do this, is because you can link almost any $NP-problem$ to one of the $NP-complete$ problems. Using this, we can creat a map, linking every $NP-complete$ problem to another. That way, if we can solve for one, we have then technically shown for every $NP-problem$. We can do that, or generalize somehow our $NP-complete$ problem, and show from there. My last idea on the matter, is to think of the consequences of this statement ($P=NP$) of being <strong>true</strong>, or <strong>false</strong>. If this is <strong>true</strong>, I feel that this would create a paradox. Because finding the polynomial-time fuction of a $NP-problem$ is $NP-hard$ in itself. But that cannot happen, as we said that $P=NP$, so we have a contradiction in itself. So you would then have to show that finding a P function of a NP function is in P. But that is also $NP-hard$. Then you would have to show that is also in P. But that&#39;s also $NP-hard$, so we have to show that it&#39;s in P, etc., etc. So we end up with having to contiuously prove that something that is in NP is in P, to show that the smaller $NP-hard$ problem of P versus NP (showing the conversion of NP to P in a given $NP-problem$), is also in P (that was a bit long and a mouthful. Essentially you get a recursive $NP-problem$, and each iteration of this recursive problem is slightly different than the last iteration, but with the same goal of showing that that iteration of an $NP-problem$ takes P time to actually solve). If it was <strong>false</strong>, we would stay where we are computationally, and nothing would of changed. Personally, based on what I have done so far, I think $P \neq NP$. But don&#39;t think that is my final decision. People have shown $NP-hard$ problems to be computed in polynomial-time, so based on my second idea of mapping $NP-complete$ problems, there is still some possibility. Expect some updates, and future posts, as this is one of many other problems (I&#39;ll just say them: The Millenium Problems) that have gotten me thinking in almost no way I have done before (that&#39;s probably because they are not all math-based, and I&#39;m a math-based guy, so math-based + not-math-based-problem = new type of thinking). Actually, don&#39;t expect future updates and posts, just know there will be future updates and posts.</p>
<p><br><br>
If you have any questions or comments, send me an email or leave a comment!</p>
]]></description>
         <link>http://xperimex.github.io/blog/p-vs-np</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/p-vs-np</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[(Un)Expected Value]]></title>
         <description><![CDATA[Okay, you don't make that much... 

 <p><img src="" alt=""></p>
<p>Not much for an introduction this post. Found this problem when looking for interesting problems for myself. Shoutout to <a href = "https://www.physics.harvard.edu/academics/undergrad/problems">Harvard&#39;s Problem of the Week</a> (from 2002 to 2004). The problem at hand is:</p>
<center>

Consider the following game: You flip a coin until you get tails, and the amount of money you win is equal to number of coins you end up flipping (i.e. If you flip a coin, and immediately get tails, you win one dollar. If it takes 2 flips to get tails, you get 2 dollars. 3 flips = 3 dollars. So on, and so on).
<br><br>
(a) What is your expected value you win when playing the game?
<br><br>
(b) Play the same game, except let your earnings be $2^{n-1}$, where $n$ is the amount of flips. What do you expect to win now? Does it make sense?

</center>

<p><br><br><br></p>
<center><strong>SPOILER WARNING: SOLUTION INCOMING</strong></center>

<p><br><br><br></p>
<p><strong>(a)</strong>: Expected value is the amount you win, multiplied by the probability of it occuring, and adding up all the possible outcomes.
<br>
You have a 50% chance to win 1 dollar. 25% chance to win 2 dollars. 12.5% chance to win 3 dollars...</p>
<p><br></p>
<center>

<p>$\large \frac{1}{2} + \frac{2}{4} + \frac{3}{8} + \frac{4}{16} + ...$</p>
<p><br><br></p>
<p>$= \large \sum _{n=1}^{\infty }\: \frac{n}{2^n}$
<br><br></p>
<p>$= \large 2$</p>
<p><br><br></p>
<p><strong>OR</strong></p>
<p><br><br>
$\large \frac{1}{2} + \frac{2}{4} + \frac{3}{8} + \frac{4}{16} + ...$</p>
<p><br><br>
$\large =(\frac{1}{2} + \frac{1}{4} + \frac{1}{8} + \frac{1}{6} + ...) + (\frac{1}{4} + \frac{1}{8} + \frac{1}{16} + ...) + (\frac{1}{8} + \frac{1}{16} + ...) + ...$</p>
<p><br><br></p>
<p>$= (1) + \large (\frac{1}{2}) + (\frac{1}{4}) + (\frac{1}{8}) + (\frac{1}{16}) +...$</p>
<p><br><br></p>
<p>$\large = 2$
</center>
<br>
So you can expect to win <strong>2 dollars</strong> every time you play this game.</p>
<p><br>
This is where the fun is at.</p>
<p><br>
<strong>(b)</strong>: We have 50% chance to win 1 dollar. We have a 25% chance to win 2 dollars. We have a 12.5% chance to win 4 dollars...
<br></p>
<center>

<p>$\large \frac{1}{2} + \frac{2}{4} + \frac{4}{8} + \frac{8}{16} +...$</p>
<p><br><br>
If you don&#39;t mind, since I like to write things in sigma notation, I would like to write the simplified verison of this sum in sigma notation.
<br><br></p>
<p>$=\large \sum _{n=1}^{\infty}\: \frac{1}{2}$
<br><br></p>
<p>$\large = \infty$</p>
<p></center>
<br>
This is why I picked this problem. The first part is quite simple, but this part creates quite a dilemma. What can we do now? How should we interpret this for the expected value of our game? Now one would ever put up a game in which the player is expected to win an infinte amount of money, since no one has an infinite amount money!
<br></p>
<p>The following explanation is a jumble between what I thought, and Harvard&#39;s. I recommend looking at what they <a href = "https://www.physics.harvard.edu/uploads/files/undergrad/probweek/sol6.pdf">said</a> specifically.</p>
<p><br></p>
<p>The solution is that our game (would be known as the <em>experiment</em> in our scenario) doesn&#39;t agree with the exact definition of <strong>expected value</strong>. Expected value is defined as an average over an <em>infinite</em> amount of attempts/trials (this can be viewed at least as the limit towards an infinite number of attempts/trials). The thing is that, you&#39;ll never be able to play an infinite amount of games. Essentially, our experiment (game) doesn&#39;t agree with our calculated expected value, as the experiment has nothing to do whatsoever with the precise defintion of expected value. Just as an example, if you were to (somehow) play an infinite amount of games, your earnings would indeed average an infinite amount. This whole idea of this expecting to win an infinite amount, and it &quot;not working/making sense/not being possible&quot; arises when we try to make expected value, something it isn&#39;t.</p>
<p><br> Okay, I like math, but from this point onward I didn&#39;t have much. And what I did wasn&#39;t cohesive, as 25% was written down, the other 75% was in my head. The problem is, that 75% <em>was</em> in my head. I would try to go through and get my complete explanation, but I feel that Harvard&#39;s solution is already quite nice. So the rest is all Harvard&#39;s explanation. Only credit I get here is for the fact I formatted it for this page. Here you go.<br></p>
<p>&quot;<em>This might not be a very satisfying explanation, so let us get a better feeling for the problem by looking at a situation where someone plays $N = 2^n$ games. How much money would a “reasonable” person be willing to put up front for the opportunity to play these N games? Well, in about $2^{n−1}$ games he will win one dollar; in about 2^{n−2} he will win two dollars; in about $2^{n−3}$ games he will win four dollars; etc., until in about one game he will win $2^{n−1}$ dollars. In addition, there are the “fractional” numbers of games where he wins much larger quantities of money (for example, inhalf a game he will win $2^n$ dollars, etc.), and this is indeed where the infinite expectation value comes from, in the calculation above. But let us forget about these for the moment, in order to just get a lower bound on what a reasonable person should put on the table. Adding up the above cases gives the total winnings as: $2^{n−1}(1) + 2^{n−2}(2) + 2^{n−3}(4) +· · ·+ 1(2^{n−1}) = 2^{n−1}n$. The average value of these winnings in the $N = 2^n$ games is therefore $\frac{2^{n−1}n}{2^n} = \frac{n}{2} = \frac{(\log_2 N)}{2}$. A reasonable person should therefore expect to win at least $\frac{(\log_2 N)}{2}$ dollars per game. (By “expect”, we mean that if the player plays a very large number of sets of $N$ games, and then takes an average over these sets, he will win at least $2^{n−1}n$ dollars per set.) This clearly increases with $N$, and goes to infinity as $N$ goes to infinity. It is nice to see that we can obtain this infinite limit without having to worry about what happens in the infinite number of “fractional” games. Remember, though, that this quantity, $\frac{(\log_2 N)}{2}$, has nothing to do with a true expectation value, which is only defined for $N → ∞$. Someone may still not be satisfied and want to ask, “But what if I play only $N$ games? I will never ever play another game. How much money do I expect to win?” The proper answer is that the question has no meaning. It is not possible to define how much one expects to win, if one is not willing to take an average over a arbitrarily large number of trials.</em>&quot;</p>
<p><br><br></p>
<p>Neat little problem if I do say so myself. Some of my work, some of Harvard&#39;s, hope it was cohesive and clear who was writing what when. I wish I could of gotten my last piece of explanation, just would of taken a bit too long for something I need to redo. Moral of the story: Take complete notes.</p>
<p><br><br>
If you have any questions or comments, send me an email or leave a comment!</p>
]]></description>
         <link>http://xperimex.github.io/blog/flipping-coins</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/flipping-coins</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Persuasion is Hard]]></title>
         <description><![CDATA[System 1 and System 2 Persuasion Tactics and Their Impacts on Secondary School Absenteeism 

 <p>This was done as part of the Advanced Authentic Research program during the 2019-2020 academic school year.</p>
<hr>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>Over 7 million students</strong> across the United States missed 15+ days of school in the 2015-16 school year (US Department of Education, 2012). These <em>chronically absent</em> who miss 10% of their academic year cause over 40 <em>billion</em> worth of instructional minutes to go to waste. Even more jarring, in the same report, it was cited that inconsistent student attendance is a better indicator than test scores to whether a student will drop out of school or not. In case it wasn&#39;t clear enough, student absenteeism is a major issue haunting the education system, and the need find a solution to it is greater than ever. Over the past 8 months, I have conducted a small series of experiments to try and alter the state of this issue in one public high school in Palo Alto, California.</p>
<h2 id="introduction">Introduction</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>In the case of Palo Alto&#39;s Henry M. Gunn High School</strong>, only 5% of the school&#39;s 2000 students are in this category of the chronically absent. That means on average, 1 student is missing in every class on campus. What makes this statistic concerning though is when one considers the demographic of Palo Alto. Here are two maps of the United States: one of the median household income (New York Public Radio), and another of chronic absentee rates by district (US Department of Education, 2012).</p>
<center>

<table>
<colgroup>
       <col span="1" style="width: 44.25105485%;">
       <col span="2" style="width: 55.74894515%;">
</colgroup>
<tr>
<td>
<a href="/img/medianIncome1.png">
<img src="/img/medianIncome1.png" height=300 />
</a>
</td>
<td>
<a href="/img/absenteeRate.png">
<img src="/img/absenteeRate.png" height=300 />
</a>
</td>
</tr>
</table>

</center>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Although Palo Alto is in one of the most affluent neighborhoods in the nation, its chronic absentee rate is equal to some areas with with not even half its median household income. This led to the idea that absenteeism may be fueled by different motivators across the country. For example, in some less fortunate neighborhoods, kids may be an active contributor to their family income, leading to conflicts with their academic commitment. Similarly, because of Palo Alto&#39;s wealth and greater access to resources, academic competitiveness may fuel absenteeism. This may seem counterintuitive at first: if someone wants to do well in class, why would they skip it? These <em>strategic absentees</em> skip class not because they want to, but rather as a necessary evil: they feel the need to skip a class a means to prepare for another one. These are the students that can most affect the absentee rate, as not only are they motivated to go to class, but their absences are likely more sporadic than they standard chronically absent, meaning that they are more likely to be in class to be influenced by a teacher or administrator, which nicely leads into the next section.</p>
<h2 id="nudges">Nudges</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>Students can&#39;t be forced to go to class</strong>. Especially as Henry M. Gunn High School sports an open-campus policy, it is impossible to be able to force a substantial number of absentees to go to class beyond the already instated measures. So, instead, we tried to <strong>persuade</strong> the students, as if they agree for themselves attending class is the right thing to do, they are more likely to act on it. To do so, we used specially engineered social measures to try and convince the students as best as possible, known as <strong>nudges</strong>.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nudges, at their core, are suggestions. They don&#39;t affect one&#39;s ability to choose, but they utilize the person&#39;s experience to guide them to pick an option. The most commonly used nudge utilizes comparisons: let&#39;s say a restaurant has a dish that doesn&#39;t sell super well, and is ultimately costing them money having it listed on the menu. To boost its sales, they can list a slightly cheaper dish that has no intention of actually being sold in large quantities. This &quot;fake&quot; dish provides a reference frame for the buyer, making what originally seemed as overprice as suddenly as a great deal. The first time this type of persuasion was first formalized in a book of the same name: <em>Nudge: Improving Decisions About Health, Wealth, and Happiness</em>, written by Cass Sunstein and Richard Thaler (<a href="https://www.amazon.com/Nudge-Improving-Decisions-Health-Happiness/dp/014311526X"> highly recommended read </a>). It should be reiterated that this doesn&#39;t change one&#39;s ability to pick what food item they want, and that&#39;s what makes a nudge so effective. It allows the person to convince themselves without needing to feel as if the choice was imposed on them (i.e. remove everything on the menu except one dish). This is a form of <em>indirect persuasion</em>: we&#39;re not explicitly saying what we want the affected person to do, but we are adding information to guide one choice over another. The counterpart to this would be <em>direct persuasion</em>: giving explicit desires for which option to choose.</p>
<h2 id="experimental-model">Experimental Model</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>This project employed 2 types of persuasion tactics that were each disseminated via 2 types of mediums</strong>. The two types of mediums you are already familiar with: direct and indirect persuasion. This was examined by having the teacher give information by describing a set of data (see below) for direct persuasion. Indirect persuasion was tested by having the environment give the information, meaning instead of having the teacher give information on data, the students take in the information for themselves by noticing the data as a poster in the classroom. Now, I have been purposely vague about what data was shown to the students as there were actually <em>two</em> different sets of data that were shown to different classes, but they communicated the same idea.</p>
<p><a href="/img/dataStimuli1.png">
<img src="/img/dataStimuli1.png" height=250 />
</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If these curves look the same, that&#39;s because they are; they are the same set of data, but one is presented with a positive connotation (attendance is good) and the other with a negative connotation (absenteeism is bad). These are the two sets of data presented, as to see whether <em>how</em> one presents data affects one&#39;s ability to influence.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; So, in total, there are 5 classes: $\mathrm{i})$ teacher presents positive connotation data; $\mathrm{ii})$ teacher presents negative connotation data; $\mathrm{iii})$ classroom presents positive connotation data; $\mathrm{iv})$ classroom presents negative connotation data; and lastly, all compared to a  $\mathrm{v})$ control with no intervention (this is formally known as <a href="https://en.wikipedia.org/wiki/Framing_effect_(psychology">framing</a>)).</p>
<h2 id="results">Results</h2>
<p><a href="/img/results.png">
<img src="/img/results.png" height=450 />
</a></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As you can see, there are 5 lines shown on the graph: 4 lines, 2 blue and 2 red, to represent data collected and a green line that represents the aforementioned Gunn&#39;s 5% chronic absentee rate. The blue lines represent tardy and absentee data from January, to collect pre-experimental data. Red lines represent data collected in February, the month in which the experiment was set in motion.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This graph may be a bit intimidating to read, but it helps to realize that the x-axis is not a representation of time like most line graphs, but rather are the individual class models. This allows for easy comparison between months, as if there was, say, a virus moving throughout the classes that caused a 3% increase to absences to all classes, it will look as if one line was shifted upwards, having the same structure more or less to the other.</p>
<h2 id="analyses">Analyses</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; These results are really surprising, as there was <em>no</em> improvement at all from any implementation of our stimulus. If anything, it got marginally <em>worse</em> with a slight increase to tardies in all classes ($\approx$3-4% increase). Which makes some sense as when you consider whenever someone commands you to do something or says you&#39;re doing something wrong, the first instinct is to disagree and defend your actions. This feeling is known as <strong>reactance</strong>, and it is likely what caused this mild increase in tardies.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; What is extremely concerning however is the massive increase in absences seen in the &quot;-/teacher&quot; class (negative connotation data presented by teacher), which observed an astonishing <strong>85% increase</strong> in absences. That is the difference between another <strong>90 additional students</strong> absent in Gunn, and an <strong>additional 560 across all of the Palo Alto Unified School District</strong>. This incites an interesting thought: <strong>subconscious effects, such as reactance, can be amplified by other effects as well</strong>. In this case, it was the <em>negativity bias</em> -- the idea that negative connotations tend to be overestimated in their impact than positive ones -- that amplified the reactance. For instance, say you are an avid fan of the fruit, apples. If someone says oranges are better than apples, reactance will be incurred and you&#39;ll likely disagree. If someone says apples are worse than oranges, however, now there is this feeling of losing an opinion as well, amplifying the disagreement. Here, it is the difference between saying attending class is better than skipping it, and vice versa.</p>
<h2 id="conclusion">Conclusion</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>These results are highly specific</strong>. Before you try to go and apply these ideas beyond the realm of this project, you should consider who were subject to this experiment. In fact, I had witnessed this exact concept during my trials: the inspiration for an easy experimental model was inspired by Moore (2004), who conducted an almost identical scenario of my experiment and found it to be effective for <em>university</em> students, while mine showed to not be effective for high schoolers. Further testing is needed, but the greatest takeaway from this experiment is that communication and persuasion is something that can only be achieved when it is very specifically tailored for a specific audience.</p>
<p><br></p>
<hr>
<p>If you want to read to a higher degree of depth on the matter, everything cited here and more can be found in my <a href="/img/absenteePaper.pdf">original paper</a>.</p>
<hr>
<p><br></p>
<h2 id="process">Process</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>Originally, this project was never supposed to be about attendance</strong>. Originally, I was intending on studying voting theory as I was (and still am) super interested in how individual behavior affects the collective, and how that can be leveraged. I was looking at networks and graph theory, synchronization, and other related topics, but I was especially looking at behavioral economics and prospect theory. Realizing I was about a year too early to be able to study any recent elections or voting processes, I honed in on the behavioral economics aspect of the research, and started to look for a new problem to address. I talked to Gunn High School&#39;s principal on school issues that could be examined, and attendance was a recurring theme. This was only corroborated by the <em>California Healthy Kids Survey</em>, a questionnaire that surveyed 9th and 11th graders each year, and it reported that 7% of freshmen and 11% of juniors cut class to prepare for another class alone in the month the survey was distributed (California Department of Education, 2017-18). So, I started directing my attention to different studies and papers that were already conducted to learn what ideas have been tried and tested, such as what Moore (2004) and Self (2012) did.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Very quickly on, however, I realized I was probably going to have the same issue that I was going to have with voting theory: gathering original experimental data. Not that there is anything wrong with using pre-existing data, I personally wanted to collect my own original data to analyze, especially as I wasn&#39;t sure if something like attendance would be internalized the same way in a high school population as the more frequently studied college population (and as stated previously, there was in fact a discrepancy between Moore&#39;s and my findings due to different populations studied). So, I began reaching out to different teachers to see who would be willing to help run the experiment in their classes. Doing so proved to be very difficult, as I needed a teacher who taught at least 5 classes of 20+ students that had some absentees in each class, who also had the class time to be able to explain the necessary information to 2 classes. I was able to properly contact 2 teachers, one of which I was able to collect data for, and the other I was not due to the sudden COVID-19 outbreak.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Another thing that made this project difficult was that I had an incredible workload set out for this year. Between the 5 required academic classes, 2 electives, an after-school elective, club commitments, and a sport for two-thirds of the year, I just didn&#39;t have the time in my schedule to devote another 2+ hours of class time, which didn&#39;t even include time needed outside of class to research and write. Not to mention any extracurriculars I had in place as well. I had to schedule almost all of my meetings at 7am or earlier, or worse, do them entirely across email threads, which made communication ambiguous and difficult at times.</p>
<p>Regardless, this whole experience taught me so much about academia beyond the scope of what any high school classroom could have, and taught me how no matter no simple a question one has, willing to ask it can lead to incredible results.</p>
<h2 id="about-aar">About AAR</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; As stated at the top, this was done as part of the <a href="https://aar.pausd.org/"> <b>A</b>dvanced <b>A</b>uthentic <b>R</b>esearch</a> program that PAUSD provides to its two high schools as a means to introduce students to formal research and academic writing, well beyond what a standard English class essay or chemistry lab write-up teaches. Providing students with community mentors, experts, and connections, it fosters student growth via the students&#39; own motivation to learn, creating an environment where projects, such as the former, can be created out of curiosity, and not by seeking a letter on a report card.</p>
]]></description>
         <link>http://xperimex.github.io/blog/absenteeism</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/absenteeism</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Golden Quartics]]></title>
         <description><![CDATA[The hidden relationship of quartics and phi 

 <meta name="viewport" content="width=device-width">

<script src="https://www.desmos.com/api/v1.5/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>

<p>This post looks to describe an interesting property intrinsic to any and all quartic functions, and it has to do with the relationship between the functions&#39; inflection points. Below is a Desmos graph, with labeled $f(x)=Ax^4+Bx^3+Cx^2+Dx+E$, the general quartic equation, as well as its 2 inflection points $P$ and $Q$. A third point $R$ is labeled, which is the point that intersects the line between $P$ and $Q$ and $f(x)$. What we are interested in today is the ratio $\frac{PR}{PQ}$. Play with the graph below to vary $f(x)$ and see what happens to that ratio.</p>
<center>
  <div id="intro" style="width: 660px; height: 570px;"></div>

  <script src="/js/introGraph.js"></script>
</center>

<p>Quickly you will notice that for (most) non-zero $A$ values, $\frac{PR}{PQ}$ always remains at the rather famous constant, $\varphi=1.61803...$, the golden ratio. This may seem coincidental, but there is a rather nice way of proving that this ratio is <em>exactly</em> equal to the golden ratio.</p>
<h2 id="the-golden-ratio">The Golden Ratio</h2>
<p>The classic definition of $\varphi$ comes from a specific geometric construction of a rectangle.</p>
<center>
<img src="/img/goldenRectangle.png" style="background-color: #fff;">
</center>

<p>In this <em>golden rectangle</em>, there are two rectangles to focus on: the large one with aspect ratio $\frac{a+b}{a}$, and the smaller red one with aspect ratio $\frac{a}{b}$. The golden ratio is given by $\frac{a}{b}$ when the small red rectangle has the <em>same</em> aspect ratio as the larger rectangle (made up of the blue square and red rectangle). Letting $\varphi=\frac{a}{b}$, and setting the ratios equal to each other nets us:</p>
<center>
<!-- $\frac{a+b}{a}=\frac{a}{b}$
<br>
$1+\frac{b}{a}=\frac{a}{b}$
<br>
$1+\frac{1}{\varphi}=\varphi$
<br>
$\varphi+1=\varphi^2$
<br>
$\varphi^2-\varphi-1=0$
<br>
$\varphi=\large{ \frac{1 \pm \sqrt{5}}{2} }$ -->

$\begin{align}
  \frac{a+b}{a} &amp; = \frac{a}{b} \
  \newline
  1+\frac{b}{a} &amp; = \frac{a}{b} \
  \newline
  1+\frac{1}{\varphi} &amp; = \varphi \
  \newline
  \varphi+1 &amp; = \varphi^2 \
  \newline
  \varphi^2-\varphi-1 &amp; = 0 \
  \newline
\end{align}$
<br><br>
$\large{\varphi = \large{\frac{1 \pm \sqrt{5}}{2}}}$

</center>

<p>The positive solution to this quadratic is the more well known value $\varphi$. Taking some variations of the previous equations can net other interesting relationships that $\varphi$ pertains to. For example, taking the third line from the derivation of $\varphi$ nets a recursive, cyclic definition of the golden ratio. Expanding out the relation gives another famous definition of $\varphi$.</p>
<center>
$\varphi = 1 + \large{ \frac{1}{1 + \frac{1}{1 + \frac{1}{1 + \frac{1}{\ddots}}}} }$
</center>

<p>An infinite descending fraction solely containing 1s. Taking a variation of the fourth line also gives an interesting appearance of $\varphi$.</p>
<center>
$\varphi = \sqrt{1 + \sqrt{1 + \sqrt{1 + \sqrt{1 + \ldots}}}}$
</center>

<p>An infinitely nested radical solely containing 1s. Notice, however, that the solution to the golden ratio has a negative counter part as well: $1-\varphi=-.61803$. Although it may seem nonsensical to assign a negative value to many of the expressions we used in defining $\varphi$, this value holds many of the same properties that $\varphi$ holds on its own as well, and the reason we don&#39;t see it as often has to do with the volatility of the value in these iterated scenarios, but that&#39;s for <a href="http://xperimex.com/blog/fixed-points/">another time</a>.</p>
<h2 id="the-proof">The Proof</h2>
<p>First, let&#39;s look at how to find the inflection points of a quartic. Inflection points are given by the quality that it&#39;s the point along a function where its concavity changes. I.e. if you look at the tangent lines along a curve as you vary the input $x$, the tangent lines&#39; slopes will change. The inflection points are found when the slopes&#39; behavior alters. Take the function $x^3$, for example.</p>
<center>
  <div id="exampleInflection" style="width: 660px; height: 300px;"></div>
  <script src="/js/exampleInflection.js"></script>
</center>


<p>Notice how as we let our value $a$ increase, the slope of our tangent line — the first derivative of $f(x)$ — decreases from $-1.5$ to $0$. But from $0$ to $1.5$, the slope begins to increase. This is all visualized in our graph $f&#39;(x)$ which plots every point $x$ and the value of its slope at $f(x)$. One can clearly see $f&#39;(x)$ tends in a downward manner initially, before rising again. And for $f&#39;(x)$ to have a slope that&#39;s first negative (decreasing) then positive (increasing), it must have a slope of zero in between. So, our point where our concavity changes is when the slope of $f&#39;(x)$ equals 0. In other words, when the second derivative $f&#39;&#39;(x)=0$. Here we can see it clearly visualized at the solution $x=0$, which confirms all of our previous observations. Doing so for any general quartic nets us:</p>
<center>
$\begin{align}
f(x) &amp; = Ax^4+Bx^3+Cx^2+Dx+E \
\newline
f&#39;(x) &amp; = 4Ax^3+3Bx^2+2Cx+D \
\newline
f&#39;&#39;(x) &amp; = 12Ax^2+6Bx+2C = 0
\end{align}$
</center>

<p>As this is a degree 2 polynomial, the quadratic formula quickly gives our two solutions for $x$ in general, which we will call $p$ and $q$.</p>
<center>
$p = \large{ \frac{-3B-\sqrt{9B^2-24AC}}{12A} }$ &nbsp;&nbsp; $q = \large{ \frac{-3B+\sqrt{9B^2-24AC}}{12A} }$
</center>

<p>This also explains why only most values of our constants have inflection points, as if the $9B^2-24AC$ term is negative, it results in an imaginary solution, meaning no inflection point is found within the real plane. With valid constants giving us solutions for our inflection points $P$ and $Q$ respectively, the line through them can quickly be written as:</p>
<center>
$g(x)=\frac{f(q)-f(p)}{q-p}(x-p)+f(p)$
</center>

<p>The intersection point $R$ can be found solving for when $f(x)=g(x)$, or in other words, when $f(x)-g(x)=0$</p>
<center>
$f(x)-g(x)=0$
<br>
$Ax^4+Bx^3+Cx^2+Dx+E-\frac{f(q)-f(p)}{q-p}(x-p)-f(p) = 0$
</center>

<p>One can try to factor and work this out, but there is a much nicer approach that avoids working with this messy equation.</p>
<h2 id="transformations">Transformations</h2>
<p>If we limit our transformations to purely scaling and translating our graph, all of our ratios will remain equivalent. So if we can find a set of transformations to make our work easier, we will still be able to prove our initial proposition, but in a much easier way. To (re)start, we&#39;re going to define a new function $h(x)$ that takes $f(x)$, and scales and moves it around as follows:</p>
<center>
$h(x) = \frac{1}{q-p}(f([q-p]x+p)-f(p))$
</center>

<p>This may seem arbitrary, but keeping in mind what $p$ and $q$ mean, this transformation alters the graph in a rather specific and useful way. First notice these two key components in our transformation:</p>
<center>
$h(x) = \frac{1}{q-p}(f([q-p]x+{\bf p})-{\bf f(p)})$
</center>

<p>This results in shifting the graph over to the left $p$ units and down $f(p)$ units. Or more clearly, it takes our first inflection point $(p,f(p)) \rightarrow (0,0)$, the origin. We&#39;ll refer to the origin as $P&#39;$. Now, let&#39;s look at the remaining components of the transformation:</p>
<center>
$h(x) = {\bf \frac{1}{q-p} }(f({\bf [q-p]}x+p)-f(p))$
</center>

<p>Multiplying $x$ by $q-p$ results in <em>compressing</em> the $x$-axis by a factor of $q-p$. So, the x coordinate distance between our inflection points is condensed from a length of $q-p$ to a length $\frac{q-p}{q-p} = 1$. Just to keep our scaling consistent throughout $f(x)$, we also scale the $y$-axis down by a factor $q-p$, so we add an extra factor of $\frac{1}{q-p}$. This factor is almost purely for aesthetic purposes, as you will see it will preserve the structure of our graphs and make it easier to see our scaled copy of $f(x)$ in $h(x)$. So, as the difference in $x$ coordinates between $P&#39;$ and $Q&#39;$ is 1, $Q&#39;$ will be at $(1,h(1))$. $R&#39;$ will retain its same definition as $R$, differing only in that it is on our newly transformed function.</p>
<center>
  <div id="transformedGraph" style="width: 660px; height: 530px;"></div>
  <script src="/js/transformedGraph.js"></script>
</center>

<p>Notice how the two inflection lines are parallel. That is due to that extra factor of $\frac{1}{q-p}$ in $h(x)$, but note that the math that follows is not dependent on it.</p>
<p>It&#39;s worth noting that we don&#39;t actually know any of the constants that shape our new quartic $h(x)=ax^4+bx^3+cx^2+dx+e$ as they don&#39;t change according to our scaling factors (notice the change in capitalization; these new constants for $h(x)$ is separate and different to those of $f(x)$). However, we do know the solutions to $h&#39;&#39;(x)=0$. Instead of using our function to find its second derivative like we did in our original approach, we are working backwards from our second derivative to narrow in on our function. Since we know where our inflection points are at, we can rewrite our $h&#39;&#39;(x)$ as a product of factors.</p>
<center>
$h&#39;&#39;(x)=0 \rightarrow x=P&#39;,Q&#39; \rightarrow x=0,1 \rightarrow h&#39;&#39;(x)=12ax(x-1)$
</center>

<p>The factor of $12a$ comes from the leading term when taking the second derivative of any general quartic, as we saw in the original attempt to prove this. Expanding this expression and integrating twice gives us:</p>
<center>
$\begin{align}
  h&#39;&#39;(x) &amp; = 12ax(x-1)=12ax^2-12ax \
  \newline
  h&#39;(x) &amp; = 4ax^3-6ax^2+b \
  \newline
  h(x) &amp; = ax^4-2ax^3+bx
\end{align}$
</center>

<p>Notice I didn&#39;t add a new constant after the second integration, as that is equivalent to the $y$-intercept, which we know to be at $(0,0)$. Now that we have $h(x)$ in terms of itself, separated from $f(x)$, we can easily find the coordinates of $Q&#39;$ and find $h(1)$.</p>
<center>
$h(1)=a(1)^4-2a(1)^3+b(1)=b-a \rightarrow Q&#39;:(1,b-a)$
</center>

<p>Now we can create a new secant line $g(x)$ to pass through our two inflection points, $P&#39;:(0,0)$ and $Q&#39;:(1,b-a)$.</p>
<center>
$g(x)=\frac{b-a-0}{1-0}(x-0)+0=(b-a)x$
</center>

<p>Now we can continue using our original method, which is to find all solutions to $h(x)-g(x)=0$. Only this time, our transformations should net a cleaner equation.</p>
<center>
$\begin{align}
  h(x)-g(x) &amp; = 0 \
  \newline
  ax^4-2ax^3+bx-(b-a)x &amp; = 0 \
  \newline
  ax^4-2ax^3+bx-bx+ax &amp; = 0 \
  \newline
  ax^4-2ax^3+ax &amp; = 0 \
  \newline
  ax(x^3-2x^2+1) &amp; = 0 
  \end{align}$
</center>

<p>That $ax$ we factored out is our solution at $x=0$, or $P&#39;$, which we used to construct the line in the first place. Similarly, because we used $Q&#39;$ to construct the line as well at $x=1$, we can factor out an $x-1$ as well.</p>
<center>
$\begin{align}
  ax(x^3-2x^2+1) &amp; = 0 \
  \newline
  ax(x-1)(x^2-x-1) &amp; = 0
\end{align}$
</center>

<p>That last factor is the exact quadratic that we derived to define the golden ratio. Knowing that, we now have all of our solutions to the intersection points between our quartic and secant line.</p>
<center>
$x=0,1,\large{ \frac{1 \pm \sqrt{5}}{2} }$
</center>

<p>The negative solution to the golden ratio here is the fourth point of intersection at $S:(s,h(s))$ with $s&lt;0$. Now the last thing to note is that our 3 points of interest, $P&#39;$, $Q&#39;$, and $R&#39;$, are all collinear. So, they can be thought of as a projection of the $x$-axis to a sloped line that scales how far they are spaced apart. However, since this is multiplicative, the ratios will be the same, so we only need to look at the ratios between their $x$ coordinates.</p>
<center>
$\large{ \frac{PR}{PQ} = \large{ \frac{P&#39;R&#39;}{P&#39;Q&#39;} } = \frac{\frac{1 + \sqrt{5}}{2} - 0}{1 - 0} = \varphi }$
</center>

<p>You can also quickly find other ratios of different lengths and find other interesting connections. Take $\frac{PQ}{QR}$, for example.</p>
<center>
$\large{ \frac{PQ}{QR} = \large{ \frac{P&#39;Q&#39;}{Q&#39;R&#39;} } = \frac{1 - 0}{\frac{1 + \sqrt{5}}{2} - 1} = \frac{1}{\varphi-1} }$
</center>

<p>If you look at our defining quadratic $\varphi^2-\varphi-1=0$, it can be rewritten as $\varphi(\varphi-1)=1 \rightarrow \varphi=\frac{1}{\varphi-1}$. Completing our expression gives us:</p>
<center>
$\large{ \frac{PQ}{QR} = \large{ \frac{P&#39;Q&#39;}{Q&#39;R&#39;} } = \frac{1 - 0}{\frac{1 + \sqrt{5}}{2} - 1} = \frac{1}{\varphi-1} = \varphi}$
</center>

<p>Just as our golden rectangle previously foretold.</p>
]]></description>
         <link>http://xperimex.github.io/blog/golden-quartics</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/golden-quartics</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Retroreflectors]]></title>
         <description><![CDATA[The utility of right angles 

 <p>If you ever seen a bike at night, you&#39;ve likely noticed the bright reflector many people use to ensure they&#39;re visible while riding. Why are they so effective at creating such visibility? It lies in the construction of the reflector itself. Looking closely at a bicycle reflector, you will notice that they aren&#39;t just plain mirrored facets; they have an almost pixelated, grid like look to them.</p>
<p><img src="/img/retroreflector.jpg" style="width:500px; height=auto "></p>
<p>They are surfaces not covered in flat mirrors, but rather are tessellated with the corners of cubes that are mirrored. Why is that? To find out, we first need to talk about Fermat&#39;s principle, and $90^\circ$ angles.</p>
<h2 id="fermat-s-principle">Fermat&#39;s Principle</h2>
<p>Fermat&#39;s principle, or the principle of least time, was an idea coined in 1662 by the mathematician of the same name, and it states that the path taken by any given ray of light is always the quickest one. Although this may seem obvious, it allows for many properties of light and optics to be derived from it. The one that it helps demonstrate for us is the common equality of the <em>Law of Reflection</em>: the angle a light approaches a surface is the same angle it reflects at.</p>
<center>
<iframe src="https://www.desmos.com/calculator/1s5r5iqlyc?embed" width="570px" height="570px" style="border: 1px solid #ccc" frameborder=0></iframe>
</center>

<p>Let&#39;s say we have a light source $S$, and we&#39;re reflecting it off a mirror (black) at point $R$, to have our ray reach an end point $E$. To show that the angle of incidence must equal the angle of reflection, we are going to create a mirrored copy of our end point, $E&#39;$ (points $P$ and $Q$ are exclusively reference points). As $E&#39;$ is a reflection of $E$ across the mirror, they are both equidistant to $R$, so we end up with two orange lines of equal length, $\overline{RE}$ and $\overline{RE&#39;}$. However, because $\overline{RE} = \overline{RE&#39;}$, our original path of reflection $SRE$ can be modeled with the new path $SRE&#39;$. Note that the speed of the light isn&#39;t changing throughout our model, so we only need to find the shortest path $SE&#39;$. To minimize $\overline{SE&#39;}$, the shortest path is clearly just a straight line (blue). We already new that the angle $\angle{ERQ} = \angle{E&#39;RQ}$ by definition of reflection of $E \rightarrow E&#39;$, and now that we know $\overline{SE&#39;}$ is a straight line, the angle that $\angle{SRP} = \angle{E&#39;RQ}$. Combining these two inequalities nets us $\angle{SRP} = \angle{E&#39;RQ} = \angle{ERQ}$, which was what we wanted to show.</p>
<p>Although this seems like an obvious fact, knowing why it this fact is true helps to understand how we will apply it to our bike reflector and corner cubes.</p>
<h2 id="right-angles">Right Angles</h2>
<p>To understand why corner cubes are chosen as bike reflectors structure, looking at simpler cases always helps. Instead of looking at corners of cubes to see how light interacts with them, we can first work from the corner of a square and see what happens.</p>
<center>
<iframe src="https://www.desmos.com/calculator/y6c0ifjbxx?embed" width="650px" height="650px" style="border: 1px solid #ccc" frameborder=0></iframe>
</center>

<p>Notice how regardless of what angle the light is hitting the corner, the light reflected from the corner is always parallel to the ray entering it. We can prove this remains true for any angle $\alpha$ quite simply using some basic geometry.</p>
<p><img src="/img/cornerSquare1.png"></p>
<p>We want to show that ray $\overrightarrow{M}$ is parallel to $\overrightarrow{N}$ given $\overrightarrow{M}$ intersects the corner at an angle $\alpha$ and that we have a true square corner that is a right angle. Filling in the givens, the rest follows nicely. The Law of Reflection gives the angle congruent to the initial $\alpha$, and the idea that all triangles&#39; angles sum to $180^\circ$ gives the $90-\alpha$. The trick in proving this involves adding an auxiliary line as such and the rest follows.</p>
<p><img src="/img/cornerSquare2.png"></p>
<p>We add another line parallel to one of the sides of our corner. This creates another right angle. Since we know that $90-\alpha$ makes part of the right angle, we know that $\alpha$ must make up the rest of the right angle, as $90-\alpha+\alpha=90$. By Law of Reflection we then know that there is a symmetrical angle of measure $\alpha$. Now since $\overrightarrow{M}$ and $\overrightarrow{N}$ both are attached to parallel lines at congruent angles, the only way that can happen is if $\overrightarrow{M}$ was parallel to $\overrightarrow{N}$ as well. Hence, a ray $\overrightarrow{M}$ has a reflected path $\overrightarrow{N}$ that exits parallel to its ray of incidence.</p>
<p>Moreover, we can show this only holds true for right angles using very similar logic. Setting our once right angle to $\theta$...</p>
<p><img src="/img/cornerSquareGeneral.png"></p>
<p>From our diagram, it&#39;s clear that for $\overrightarrow{M}$ to be parallel to $\overrightarrow{N}$, $\alpha=\alpha+\theta-90$, which when solving for $\theta$ gives $\theta=90$, our previous right angle.</p>
<p>All of the previous arguments can be applied to the 3-dimensional case by decomposing the ray of light into two other rays, and by showing that those two rays are parallel to the initial, that the composite ray is as well. With all of this together, it makes perfect sense why bike reflectors are corners of cubes: they send light back to its source. If you had a standard mirror, no light would return back to where it came from unless looking perfectly perpendicular to the mirror.</p>
<center>
<iframe src="https://www.desmos.com/calculator/yzy5cfaimu?embed" width="650px" height="650px" style="border: 1px solid #ccc" frameborder=0></iframe>
</center>

<p>If no light goes back to its source, to say, a car&#39;s headlights, no light will hit the driver&#39;s eye to indicate that there is a bright, shining reflector to show that there is a bike up ahead (for this reason exactly, most reflectors actually have angles slightly large than 90$^\circ$ so that most light returns back to its source, and some can scatter to an observer slightly above/below/left/right of the source). These reflectors actually have a specific name to it, and they&#39;re known as <em>retroreflectors</em>, literally meaning to reflect backwards. This concept has been leveraged to aid satellites, and indirectly the military. There&#39;s a reason why no stealth-based aerial technology has no right angles: they want to avoid creating an accidental retroreflector that can return radio waves.</p>
<p>Hopefully this gave insight into a seemingly arbitrary design choice in one of the most common bike accessories used today.</p>
]]></description>
         <link>http://xperimex.github.io/blog/retroreflectors</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/retroreflectors</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Mad Max: Fury Road]]></title>
         <description><![CDATA[Yes, the flamethrowing guitar was necessary 

 <p>This post is a collection of essays analyzing scenes, themes, dialogue, and scoring of George Miller&#39;s 2015 120-minute action packed car chase of a movie, <em>Mad Max: Fury Road</em>. It is truly one of my favorite, raw action movies I&#39;ve seen in a long time as it knows exactly what it is: an action movie. It delivers in spades what every action enthusiasts craves with some of the wildest practical effects seen to date, it still manages to have tender moments and characters develop through the action rather than just through some corny moments or having explosions for the sake of explosions. If you have not seen it, do what you can to do so, as even if you&#39;re not a fan of action movies, <em>Fury Road</em> transcends the category and delivers so much more.</p>
<p>You should also watch it as these essays assume: a) that you know the movie so you don&#39;t walk into thousands of words of spoilers, and b) that you are familiar with some of the terminology introduced in the film as well. </p>
<p>To start, let&#39;s look at the end.</p>
<h3 id="the-end-">The End…?</h3>
<p>The ending could be a sort of allusion to the western genre as a whole (after all it is commonly referred to as a “western on wheels”). After having found his name and fulfilling his moral duties to the extent as he feels needed, Max leaves to be his lone ranger just as he started to move onto his next wandering adventure. This sort of functions with how Max blends into the crowd, illustrating how he is just as anyone in that crowd: seeking a purpose, and having now fulfilled that, he walks in the opposite direction from whichever everyone else walks, no longer looking at the Citadel nor Furiosa <em>for</em> hope, but walking away as he has already been <em>given</em> hope by it. This is furthered by the final quote presented by The First History Man at the film’s conclusion: “Where must we go, we who wander this wasteland, in search of our better selves?” This implies that the place to seek to better oneself doesn’t exist, or is unknown at the very least, and it has to do with because one of the central themes of the movie is that redemption is a self-realizing process, not one induced by a place or material object, but rather <em>conducted through</em> places, objects, and or people. They can be mediums, but not the incitation of being redeemed. Nux, having abandoned his technological faith in Immortan Joe, is a key example of the process, as he takes the phrase, “Witness me!,” to be one not of sacrificing himself, but rather as remembrance by asking the wives who he’s befriended to not forget him for the person he was rather than his death for them. </p>
<p>Returning back to Max’s extraneous leaving of the Citadel, having found redemption and reacquainting himself with his past, Max feels no obligation to stay as while the Citadel, the Wives, Furiosa, and Nux were his mediums of redemption, they weren’t a part of what he was redeeming: his quest was purely for himself and his past, ideas and memories unassociated with the movie’s setting, it’s the parallels that he inevitably sees in the other characters that draws him to help. Contrasted to the other characters’, such as aforementioned Nux, while they do have their own redemption arcs, they tie in directly to the immediate setting which gives them motive beyond personal reason to stay; they’re not only redeeming themselves, but the land itself (note that these should be treated as separate actions; intertwined as they are, Nux, Furiosa, and the Wives, redeeming the Citadel is more of a byproduct of their personal growth that was conducted through their reclaiming of the stronghold). While Max and the rest of the cast are all given hope from the present and their actions through the movie, what differentiates them is how they leverage this hope to recontextualize their life: Max feels he has atoned and repented for his guilted past, while the rest have their futures recontextualized, now knowing that they no longer lead a life of forced repression. Their repression wasn’t what likely induced their guilt, but knowing that they had little hope to have a better life at all is likely what made them feel powerless, and guilty they hadn’t attempted to advocate for a more moral society. But, because they never had that opportunity physically and only the thought, there isn’t anything in their previous life that they would be to perceive differently or acknowledge: they did what they could, and they only have the future to look forward to, and we see this time and time again in the intermittent sequences which the cast breaks from the intensity of the chase scenes: Furiosa is seeking to return to her dearly beloved home, the Green Place; the Wives are motivated, almost haunted by the prospect of a haven away from Immortan Joe’s abuse (I phrase the Green Place like this as they have no concrete image of it, and are seeking the concept not necessarily a specific place); Nux is seeking technological salvation, and to make his half-life existence meaningful (similarly, Valhalla is phrased like this, as he’s motivated by the concept, not the place as he’s only ever had it described to him, he’s never seen it); these are all motives that they envision in the future for themselves, not something they are gripping on to from the past. It just so happens that in the narrative, all of these instances of their individual sanctum sanctorum converge on the Citadel over the course of their character growth as they realize that they can only seek comfort in reforming their personas, so while the direct action they take switches from materialistic to impersonal, the motivation remains the same for a prospect of the future. This is why everyone but Max staying is so crucial, as it maintains the consistency of the messaging and the individual character plots we’ve been presented with throughout the course of the movie. This film’s ending is merely a means to help individualize Max’s personal journey from the thematic and character development that underpins the work’s message and structure.</p>
<p>My last thought on the end is that this could potentially hint at how this film wasn’t necessarily completely true, but rather a myth or legend passed on. The idea of there being a <em>first</em> history man implies there are others, too, all who pass on and carry stories such as what is told in <em>Fury Road</em>, similar to how in <em>Mad Max 2: The Road Warrior</em>, the narrator of the film wasn’t Max at all, but rather a survivor who was helped by him. So perhaps, the ending quote not only explains why Max left, but potentially how everyone interpreted why he left after all they have endured: Max is a legend looking for his next outpost to wander into, to better another untouched aspect of his life we’ve yet to be revealed. Just as old cliché westerns reiterate time and time again of the wandering, lone hero who’s been mythologized and solidified in glorious memory, perhaps <em>Fury Road</em>, intended for Max to represent just that: a memory to inspire. However, this would still help maintain all of the previous messaging aforementioned, as whether he was diegetically existent as the movie presents or just a fable, his story of proposing redemption still maintains the inspirational quality that he is remembered for anyway. It’s only the scope of the amount of people it reaches that changes.</p>
<h3 id="feminism-and-the-vuvalini">Feminism and the Vuvalini</h3>
<p>There is definitely a feminist connotation and tone in throughout the film, but feminism is not the complete term based on its etymology. To be concrete from the start, according to Merriam-Webster, the term “feminism” is used to describe “the theory of political, economic, and social equality of the sexes; organizing activity on behalf of women’s rights and interests.” Even though the first definition is gender neutral, based on the word’s etymology and the more popularly associated second definition, this response will be referring to that definition of feminism throughout this response, and it’s the gender specific terminology is what prevents classifying this film as a feminist one. While it’s perfectly reasonable to say that this film exhibits feminist messaging, it’s more justified to argue that this is a more specific case tailored to our own social context in reality that is being related to the film, rather than the broader, more powerful message at hand. Given our, the audience’s, perspective on our very own society’s development and history with gender inequality, the lead antagonist being male with extremely powerful women protagonist counterparts, these are prime conditions to further a feminist message. The issue is, however, these exact messages function almost equivalently with the genders swapped in the film: if Immortan Joe was a female counterpart, the Wives and other protagonists were primarily male, the film could still be classified as feminist, which may seem contradictory, until acknowledging the innate messaging surrounding not just women, but humanity as a whole. Take the standard woman in Immortan Joe’s world: they’re treated essentially to the extent of a rape victim, being sexually abused solely for their fertility; their reduced to an object of a single purpose to forcibly bring life to Immortan’s subjects and the Citadel (this association of fertility and women is supported by the Vuvalini’s own Keeper of the Seeds who seeks to plant and sprout a new life of the Green Place). So, to have a contrast in extremely powerful women between the nomadic Vuvalini, the Wives, and Furiosa, who end up conquering Immortan Joe in the end coupled with the one of the final shots of the women releasing the “aqua-cola” to the people makes for a very strong feminist message, which in that sense, it is understandable that some critics characterizing this film as feminist. However, it’s hard to ignore the parallels between the male characters’ portrayals throughout the film. Max, even before the title card of the film has played, Max is similarly bound and exploited for his social benefits, which instead of being fertility, is holding a healthy supply of O- universally donatable blood for Immortan’s War Boys, who themselves are exploited in their own ways. War Boys, instead of being exploited for their ability to give life, it’s their ability to take it, and execute Immortan’s visions of destruction. However, more importantly than the roles themselves, is their relation to the characters themselves as these roles even reverse with Furiosa and Max by the end, where Max becomes inducted into the Vuvalini and even heals Furiosa under his own volition to perform a blood transfusion on her, while Furiosa is the one to ultimately kill Immortan Joe at the end. These intermixing of the movie’s established gender roles further blur the lines to say which gender is being empowered more, by essentially neglecting the need for it to exist and categorize the characters at all; what defined women and their exploitation, and hence motive to revolt in an empowered fashion gets reassociated with the opposite gender, making it hard to define it as a distinct trait, and hence more apt to look at it as role-specific retaliations and revolts when it is a part of a greater collective body of both genders. Similar parallels can be found between major sacrifices in the movie: Nux from the, War Boys, sacrifices himself specifically to give the women (implied more than to end Immortan’s soldiers’ lives by his care for Capable) a chance to lead a longer, more fulfilling life, while many of the Vuvalini give their life to end Immortan’s army as they stand diametrically opposed to their own morals of community (see the scene where Max convinces the group to redirect themselves towards attacking the Citadel). There’s a constant defying of expectations to mirror and reverse supposed gender-specific roles within the film to unify the genders as one. So while there is in fact a large component that empowers women, due to the parallels that the men’s stories provide, it’s more accurate to say that this is a movie about empowering humanity as a whole above the tyranny and unethical practices that Immortan Joe embodies (it’s not surprising that Immortan Joe’s name mimics not only the word “immoral” in addition to “immortal”). Even the name of the stronghold the protagonists reclaim, the Citadel, echoes deeply not just the despot they’re overthrowing, but the entire symbol for oppression: it’s not just a fortress dominating people, it is an empire dominating the humanity of the people.</p>
<p>One fact that might augment the message to be a bit more women-centric, though, is the naming of the Wives: Angharad (Welsh name for “much loved one”), The Dag (Australian slang for “funny/amusing”), Toast the Knowing, Cheedo the Fragile, and Capable, each seemingly named after a core value they embody of charismatic/leader-like, comedic, wise, fragile, and confident respectively. With each embodying an extremely distinct human quality, it’s hard not to see how they themselves personify humanity as a group. That combined with their distinct light, (relatively) elegant clothing, the group also clearly is hope incarnate, which can seen most distinctly during the nighttime Green Place car chase scene with the Bullet Farmer, where they are the ones seen to be holding the only lightsource between the crew of the War Rig, contrasting the deep, unsettling emptiness of the exhausted, corrupted Green Place. However, when interpreted like this, it’s worth noting how the <em>other</em> characters perceive the Wives: they are the ultimate prize. Immortan Joe seeks them to bear healthy children, so in a literal sense, the Wives are the ultimate material possession for him. However, Max, Furiosa, Nux, and other aiding protagonists are not drawn to the Wives for their physical traits, but rather because of who they represent; they want to protect the Wives as they are the characteristics of humanity they all seek to restore themselves, which furthers the lack of gender as a needed category of a theme. When perceived as symbols, the Wives exemplify a much greater presence in the film as the “MacGuffin” that everyone seeks to find and protect as a medium to try and redeem some humanity within themselves; the core values they represent ends up being a universally sought after, set of appreciable qualities.</p>
<h3 id="furiosa-s-story">Furiosa&#39;s Story</h3>
<p>Furiosa was born into the Green Place as the daughter of Mary Jabassa of the tribe Swaddle Dog of the Vuvalini, being taught and trained by her “initiate mother” K.T. Concannon. There, in her matriarchal society, she is taught to value her relationships and who she is in this tribe of mothers. However, she was abducted – stolen – from her home by Immortan Joe to the Citadel along with her mother, who died within 3 days of captivity. Immortan Joe took in Furiosa as one of his new wives, seeking for her to bear his new healthy son. Unable to successfully impregnate her with a possible heir, Immortan Joe had no use for her to serve in his vault as a breeder. Unable to watch a possible “resource” go underutilized, Immortan Joe gave Furiosa to one of his Imperators, a high commanding military officer who takes control of their invaluable War Rigs. Constantly exposed to war and automotive technology, Furiosa became an experienced, and newly indispensable asset from one unable to give life to others, to one able to quickly and efficiently take it. But, only so much experience can provide so much benefit without repercussions: she lost an arm in combat, forcing her to create a prosthetic extension to be able to continue serving. Once her half-life mentor had passed, she replaced his title and claimed Imperator for herself as a leader in Immortan Joe’s ranks, becoming one of his most trusted commanding officers and couriers. Due to his trust and surplus of willing warriors, Immortan Joe assigned Furiosa to watch over his most prized possessions that Furiosa was once almost inducted into: his prized breeders, the Five Wives. Relating to their physical abuse, the Wives were the first people since Furiosa’s capture that she connects with. The abuse and effort she had to commit to, though, took a toll on Furiosa across her 7000 days of imprisonment. On many occasions, she has considered defecting and escaping in search of her once lost Green Place and taking refuge in her family. Holding as much power as she did with her War Rig, she saw an opportunity, a clear one no less, to retrace her path, running from Immortan’s grasp, and find her lost home among the barren deserts of a once fruitful land. She tries to leave, but not alone: Furiosa smuggles the Five Wives with her, knowing they need the Green Place just as much as she does.</p>
<p>The first bit of basic information is given directly through her identity speech upon regrouping with the Vuvalini for the first time. We learn about her compassion and love of her people through her introductory speech to the Vuvalini: she never refers to herself by her name, but rather what that name was associated with, and she does so with very specific tenses. She <em>was</em> once part of Swaddle Dog, but <i>is</i> one of the Vuvalini. Her initiate mother <em>was</em> K.T. Concannon, but she still <i>is</i> the daughter of Mary Jabassa. She talks as if she has outgrown her childhood culture of Swaddle Dog – she had to for the sake of survival – but she still talks as one of the Many Mothers, and as if she still wishes to be associated with and accepted into this group she still cares for (present tense phrases). Seeking reaffirmation, she hopes to show that she is still selfless in the cause of the group and the people within it, because without them, Furiosa’s name means nothing to her. Elucidating on her combat experience, one could only imagine that her inability to bear children is why she was selected to become the inevitable driver of the War Rig, and how she lost her arm. <em>Fury Road</em>, within the first 5 minutes, before the title card, makes sure to establish norms and the social constructs that govern Immortan Joe’s Citadel, and from the very start, women have been boiled down to a single purpose: fertility. Her being assigned under the command of an existing Imperator would connect a lot of the scenes to losing an arm in battle, driving the War Rig in the first place, and how she is able to be so prepared for combat. Take the scene when Max, still muzzled and enchained to Nux, Furiosa is able to take down Max, be more than dominant at close quarters combat with a wrech, disarm Max of his shotgun, pull out a secret handgun on Max, while also preemptively pulling the kill switches on the War Rig as well so that even if Max proved victorious in their small skirmish, he couldn’t steal the resources. Not to mention the amount of firearms Furiosa stashes in the War Rig that Max reveals immediately after their scuffle, and her experience with a sniper rifle to take out the Bullet Farmer later during the night chase. There’s no way in her 20 years she could have advanced nearly as far as she could have without already being valued by a highly ranked member in society, as we by see the number of War Boys forced to conform to that initial ranking and die in battle, or grow only to the extent of the military’s drum corp. It is difficult to connect the Wives and Furiosa, other than the fact that Furiosa was at one point almost inducted into the group of prized breeders. We know Immortan Joe trusted Furiosa immensely for executing his water, bullet, and resource runs that extended beyond the Citadel, holding upwards of 3000 gallons of the prized resource “guzzoline” plus a surplus of water at a time. For how much of the Citadel he constantly monitored, to extend someone beyond his immediate control, and even reallocate some power and influence to someone else speaks immensely of the trust he bestowed unto Furiosa. So, for the fact that she’s a powerful commanding officer, and has a non-insignificant connection to the Wives indicates that is how she got in touch with them, and how she communicated her plan to smuggle them out as well. After she escapes the Citadel, we are now well into the film’s plot, and concludes the biography.</p>
<hr>
<p>While the above looked at three specific presences within the film, the three below are a series of more opinionated pieces discussing some of my favorite sticking points.</p>
<hr>
<h3 id="favorite-shot">Favorite Shot</h3>
<p>My favorite shot in <em>Mad Max: Fury Road</em> occurs for only a few frames during the Rock Riders chase scene after Furiosa’s exchange with them went south (this shot is one that I don’t think I consciously took in until my 2nd or 3rd viewing of the movie). They are well into the chase at this point with the Rock Rider’s signature bikers attacking the War Rig at all angles: explosives from the side, bikes jumping over the War Rig, armed bikers firing rounds whenever the can, all the meanwhile Immortan Joe in his Dodge Fargo 1940 “BigFoot” monster truck is catching up to them from the rear. In a moment of panic and without weapon, Furiosa lunges into her arsenal and grabs some kind of pistol from the bag, and in a single movement, lines up her shot alongside Max at a Rock Rider angling themselves along the side of their vehicle. This shot is only a few frames in length, but communicates so much about the character development of both Max and Furiosa and the relationship between them. We can actually map out their entire relationship visually from strangers, to foe, to forced allies, to tight-knit friends. You can see that they are strangers when they never share a frame; for the first part of the movie, there is usually a cut, or shift in lens focus to direct the audience’s attention to either Max <i>or</i> Furiosa, neither at the same time. They become foes at their first interaction after the sandstorm, and this is clearly indicated via their exchange of weapons. Furiosa attempts to shoot Max with his own shotgun, and moments later, Max threatens to shoot Furiosa with her own pistol. This helps emphasize the turbulent power dynamic between the two: they are both just as capable, but are perceiving each other as threats, so they continue to try and disarm each other, and inevitably turn one’s own weapon against them. This continues in the following scenes where they become reluctant partners, driving the War Rig together. Since Furiosa is the only one who can drive the War Rig, she seems to be in control of the situation. But, the first thing Max does before the War Rig departs is take and hold hostage every single last gun compartmentalized throughout the vehicle, bringing the power dynamic back into his favor. It’s similar to the back and forth they had as enemies, but now instead of being a constant duel of competitors, it’s now more of a dance of adversaries: they both want to accomplish different goals and have different ideas in mind separate from one another, but are both tense as they both potentially act as a threat to that success if they choose to act on it, almost like mutually assured destruction – one party stops another also forces to stop themselves. This is a change from the previous relationship where they both saw each other as direct impediments that are competing for the same goal, but they now realize that their ideas aren’t mutually exclusive. So, as unlikely companions, Max doesn’t kill Furiosa, but completely disarms her. This tension eventually gets alleviated as the two are both placed in precarious situations, and Max ultimately returns a weapon to her to help defend the crew, visually showing the trust building. Now, the shot I picked as my favorite is where the two are finally visually cued into being equals to one another: capability-wise, trust-wise, and as trusted allies. In those few frames, showing the two both aim at a single target together in the same shot is all it took for this film, with minimal dialogue between the characters, to graphically establish their relationship. I also really like it <em>because</em> of how short it is: it forces us, the audience, to passively take in the shot which helps us to understand the two characters are now strongly bonded without forcing their ever changing connection and feeding it to us directly. These cues allow us to take in a lot of information very quickly, and this is one of the best examples the film offers for how it does so with such a nuanced topic like character interaction.</p>
<h3 id="favorite-line">Favorite Line</h3>
<p>My favorite line in <em>Mad Max: Fury Road</em> is one of Furiosa’s final lines of the film during the final action sequence in which the protagonists end Immortan Joe’s corrupt rule. As Furiosa forces her way up to the driver’s side window to finally kill Immortan Joe, she delivers a final send off before he lashes out one last scream: “Remember me.” It twists the War Boys fabled motto, “Witness me!”, that they call before attempting a suicide act in an effort to be permitted into Valhalla under Immortan Joe’s servitude by giving their life in noble act of war. This phrase, “Witness me!”, evokes a tone of acknowledgement of the action; a phrase that asks for those who know they have already died to do so. It holds a connotation that what is being seen is merely recognized, but not appreciated, and that’s due in part by what the purpose of “witness” is: it’s an act to better oneself into the salvation of Valhalla, which they celebrate in normalizing their expendability of their current life and to carry on into an uncertain next. Furiosa’s spin on the phrase reverses that tone completely by saying “remember” instead of “witness”, which instead of asking for acknowledgement and self-betterment, is asking for gratitude. While Furiosa isn’t the one who physically dies, and Immortan Joe doesn’t physically survive, it makes sense to view it symbolically as if that was the way the scene was framed. By perceiving as so, it turns the messaging around by asking “Immortal” Joe to live on forever with full knowledge that she is who restored the world with the amount of sacrifices she had to endure; she’s asking not to “die” in vain, but to live in memory of those she has worked so hard to help. While it has the exact same physical outcome that the old, willing sacrifices that were “witnessed” had, it changes the mentality and respect surrounding those who may not have had a choice in their death to truly internalize the impact it had on those who had beared the trauma of the death in question.</p>
<p>This expression also immediately sets the ideology she seeks to replace Immortan Joe’s society with: people aren’t objects to watch be expended, but they are intelligent beings who deserve to forever live by their accomplishments and compassion they have shared for others beyond their self-interest. What makes this specific sentiment especially powerful is that the only memory that Immortan Joe would have to remember Furiosa by is <em>her own</em> exploitation that he leveraged, so by executing him with that memory is an extremely clear indicator that she wants those memories and experiences to die with him so no other person has to suffer through it and pushing her own abuse behind her. It’s Furiosa climactic developmental moment: just as Max gave his name to Furiosa to accept his <em>past</em>, Furiosa buries her past to accept her new <em>future</em>. She wants to have Immortan Joe explicitly know that he was the one who “killed the world” by destroying the very world he has built upon abuse and denigration with ending his life. The final component of this line that makes it so inspiring is coupled with the next important line that Nux so emotionally delivers: “Witness me.” The very phrase that Furiosa has reformed dies gently with Nux, the transitory character that was once a War Boy, now Vuvalini takes the cursed connotation of the phrase “witness” and completely transforms it to accommodate his developed moral enlightenment. Nux, for his whole life, has been told that the world doesn’t care for him, but he cares for the world; the Citadel will continue to run with the powerful machines that they worship, and they are merely the small, insignificant cogs in a social machine. Even though they are aware they are “kamakrazee”, they know that their life has no more meaning than what Immortan Joe provides. But by the end, after all he’s undergone and tolerated, he pours all of his new found emotion Furiosa has modelled throughout their adventure into his delivery, completely dropping his trochaic-accented meter of the War Boys’ chants, remnant of the famous Gregorian chant of death, Dies irae, before burying the last of the phrase along with the remaining scraps of Immortan Joe’s convoy, influence, and power. He knew he would die, and that there was no Valhalla for him to seek, but he hopes that him accepting a willing death for those he loves would be remembered beyond just a glorified suicide to the group, but someone of a friend. That last utterance of “witness” gives the very contrast needed to emphasize the importance of Furiosa’s choice of wording.</p>
<p>“Remember me!” is such a powerful line as it reverses the very sentiment that Immortan Joe terribly exploited back onto him, while also completely rebuilding a new tone and society within just those two words to break down what we, the audience, have been conditioned to hear so frequently that normalized death to respect its consequences and implications beyond a single use case. Furiosa, in just a few syllables, was able to take an entire society, destroy it, rebuild it, and accept her sacrifices for it.</p>
<h3 id="theme">Theme</h3>
<p><em>Mad Max: Fury Road</em> contains many broad, strongly supported topics of discussion, one of which includes a central thematic subject that revolves around how redemption is a self-realizing process that cannot be induced forcibly by a person, place, or material object, but can be conducted through one as a medium to enlighten oneself beyond past perception. </p>
<p>Similar to the analysis of the ended above, every major character follows an arc in which their persona is fleshed out such that they are able to newly perceive their life and how they fit into the events that they have been witness to. Continuously, the film, almost forcefully, imposes redemption as a subject matter. The first instance that redemption appears as a focus is within some of Immortan Joe’s first lines: “I am your redeemer! It is by my hand you will rise from the ashes of this world!” Many of his War Boys buy into this false ideology and into the notion that their salvation will be presented as an action that Immortan Joe provides directly to them. Max and Nux learn this first hand: literally being abandoned in the aftermath of a sandstorm, and symbolically “rising from the ashes” that Immortan Joe has incited with his chase of Furiosa. They then go on through their redemption arc (Nux’s arc won’t enter a phase of redemption until further into the film), but this scene helps to recontextualize Immortan Joe’s previous dialogue to fit the theme described. It wasn’t Immortan Joe who presented them with their redemption, but it was he whose hand presented the <em>opportunity</em> to redeem themselves; he was merely the objective that awarded redemption, not salvation himself. Another clear instance of the film’s portrayal of redemption is via Furiosa, with her deeply intimate and revealing conversation with Max, moments before her reunion with the Vuvalini. It’s here where she unveils not only why she’s seeking the Green Place for herself but for the others as well: </p>
<blockquote>
<p>“And [the Wives]?” </br>
“They’re looking for hope.” </br>
“And you?” </br>
“...Redemption.” </br></p>
</blockquote>
<p>This distinction is important as it aids in differentiating the purpose of the Green Place between the Wives and Furiosa. The Wives specifically are holding onto seeking something material — something tangible that directly impacts their life to separate them from Immortan Joe’s exploitation. They need that promise to believe in a life worth living. Furiosa, on the other hand, has a much deeper connection to the Green Place. It was her home that she was extracted from, enslaved at the hands of the very force she was trained to avoid: men. Knowing the trauma her people had to endure along with the acts she deeply laments serving Immortan Joe, Furiosa desires to repent and atone for, which she tries to do through helping the Wives and restoring herself to the Vuvalini. In the end, Furiosa does find acceptance and redemption, it doesn’t come without cost: nearly all of the Vuvalini die in her and the Wives’ names, reiterating how there isn’t manifestations of redemption that one can possess or know to enter a new state, but there are certain people and objects that can help guide one through their self-solace, because if that wasn’t true, the ending of <em>Fury Road</em> would have almost no impact; Furiosa’s story wouldn’t have a chance to resolve with the lack of the Vuvalini present, and Max’s leaving would make even less sense, as he is then literally abandoning his redemption, which is his most overarching plot motivator that has guided him through the film. </p>
<p>This is even reiterated in the music scoring for the film. When listening to the track labelled, “Redemption”, which plays during the previously described scene of Furiosa’s personal conversation with Max on their way to the Vuvalini and the Green Place. In it, a certain leitmotif is established along with a very distinct tone. However, in the following scene’s track, “Many Mothers”, it takes the redemption leitmotif that “Redemption” established, but emboldened with a fuller orchestration, connecting the theme to the scene. Similarly, during the blood transfusion scene where Max desperately tries to save Furiosa from dying of blood loss, his associated track, “My Name is Max”, it also contains the same leitmotif, but this time emphasizing rests and silence to allow room for the music to breathe and react to Max’s dialogue, especially his key titular line the track has been named for. If we were to take the connection in musical theme and apply it to the idea that redemption is something that can be contained within a person or group of people, like Max and the Vuvalini — characters who either left or died — then it would only reiterate the aforementioned theory that <em>Fury Road</em> along with many of its characters would remain unresolved, and the conclusion would have no significance nor impact that they movie clearly tried to convey. It’s more reasonable that the connection between “Redemption” and “Many Mothers” as well as “My Name is Max” is that it is used to represent the action that transpired <em>through or from</em> the relevant characters, permeating long after their presence with the others. They conducted and induced their redemption, albeit via different mediums, they are the ones who incited the redemption themselves, instead of being given it, or attained it via a sudden acquisition of someone or something.</p>
<p>There are many other examples, especially with Nux and his relationships between Capable and Max that exemplify the versatility and omnipresent nature of this theme of the film, these are some of the most distinct examples that elucidate Miller’s conveyance of the nature of redemption, and its intrinsically self-realizing and growing process.</p>
]]></description>
         <link>http://xperimex.github.io/blog/mad-max</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/mad-max</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Fixed Points and Fantastic Plots]]></title>
         <description><![CDATA[Stability amidst the chaos 

 <h2 id="introduction">Introduction</h2>
<p>Let me propose a question to start. Try to solve the following:</p>
<center>
<!-- $\fbox{ -->
  $\large{x^{x^{x^{x^{.^{\hspace{.07cm}.^{\hspace{.07cm}.}}}}}} = 2}$
<!-- }$ -->
</center>

<p>An infinite power tower which supposedly equals 2? Seems unlikely, but those familiar with these infinite-operation type problems likely know the strategy to solve this. Notice how there&#39;s a copy of our equation stacked on top of itself.</p>
<center>
  <!-- $\large{\fbox{$x^\fbox{${x^{x^{x^{.^{\hspace{.07cm}.^{\hspace{.07cm}.}}}}}}$}$} = 2}$ -->
  $\large{x^\fbox{${x^{x^{x^{.^{\hspace{.07cm}.^{\hspace{.07cm}.}}}}}}$} = 2}$
</center>

<p>Since we know that equation in the box is equal to 2 because it&#39;s a duplicate of our original equation, we can easily reduce the problem down to something much more manageable.</p>
<center>
$\large{x^2 = 2} \rightarrow x = \sqrt{2}$
</center>

<p>So, raising $\sqrt{2}$ to itself over and over again equals 2. What other equations can we solve? Let&#39;s try this one.</p>
<center>
$\large{x^{x^{x^{x^{.^{\hspace{.07cm}.^{\hspace{.07cm}.}}}}}} = 4}$
</center>

<p>Using the same strategy as before, this one is trivial.</p>
<center>
$\large{x^4 = 4} \rightarrow x = \sqrt[4]{4} = \sqrt{2}$
</center>

<p>Which is… the same answer as before? How can $f(x) = \sqrt{2}^x$ iterated over itself equal both 2 and 4 at the same time? When in doubt, we can ask our calculator for some confirmation.</p>
<h2 id="estimation-with-python">Estimation with Python</h2>
<p>With some simple Python, we can get a pretty good approximation quickly.</p>
<p><!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 11pt;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">math</span>
<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">f</span><span style="color: #f8f8f2">(x):</span>
    <span style="color: #f8f8f2">temp</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">x</span>
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(</span><span style="color: #ae81ff">1000</span><span style="color: #f8f8f2">):</span>
        <span style="color: #f8f8f2">temp</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">math</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sqrt(</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">)</span><span style="color: #f92672">**</span><span style="color: #f8f8f2">temp</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">temp</span>
<span style="color: #f8f8f2">print(f(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">))</span>
</pre></div></p>
<p>The above code creates and evaluates a power tower 1000 numbers tall, giving us an approximation of <code>2.0000000000000004</code>, which is pretty close to 2. So, is 4 anywhere to be seen? Actually, yeah; our solution wasn&#39;t <em>completely</em> false. Notice that at the end of the script it says <code>f(1)</code>. That 1 is our <em>seed value</em>. Since our power tower can&#39;t be infinite in order to get a calculable approximation, we need to cut it off after some amount (in this case, 1000 numbers high). In order to do that, though, there has to be some number there at the top of that power tower. In this case it was 1, but it can be anything as we constantly plug our output back into our input, in the case of an infinitely stacked power tower, that seed value is negligible. Let&#39;s see what happens if that is changed to <code>f(4)</code>.</p>
<p><!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 11pt;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">print(f(</span><span style="color: #ae81ff">4</span><span style="color: #f8f8f2">))</span>
</pre></div></p>
<p>Due to rounding, our script actually blows up to infinity with <code>f(4)</code>, but we can reason this out by hand. If we start with 4, then our first output of iteration will be $\sqrt{2}^4 = 4$. Since 4 is our output, that&#39;s our new input. But since 4 was also our seed value, it&#39;ll just constantly output 4 at every iteration. So 4 <i>is</i> a convergent value (as we can only calculate finite approximations) to the infinite power tower of $\sqrt{2}$, but only for its seed value. To better understand this, we can use a tool known as a <em>cobweb plot</em>.</p>
<h2 id="cobwebs">Cobwebs</h2>
<p>Cobweb plots are a simple, elegant method to model iterative functions in the Cartesian plane by utilizing a seemingly mundane auxiliary function: $y = x$. What is probably the first graphs people are taught in elementary school is one of the most helpful in modeling these complicated and  otherwise impossible to view functions. Here&#39;s how to make a cobweb plot: 1) Plot the function to be iterated on (in this case, $f(x) = \sqrt{2}^x$) and $y = x$ together. 2) Pick a seed value to start iterating on. 3) Alternately draw vertical and horizontal lines within bounds of each graph for as many iterations as one needs. Steps 1 and 2 should be clear enough as they&#39;re fairly similar to what we did above, but Step 3 might need a visual to go along with it.</p>
<p>Here&#39;s the first step&#39;s resulting plot:</p>
<p><img src="/img/fixed-points/cobweb1.png" style="width:500px; height=auto "></p>
<p>Nothing too crazy. The green graph is our $f(x) = \sqrt{2}^x$, while the red graph is our $y = x$. For Step 2 we&#39;ll pick $x = 1$ as our seed value as we did before. This is where the magic of Step 3 comes in: from $x = 1$, we&#39;ll draw a vertical line from the red graph until it intersects at the green graph.</p>
<p><img src="/img/fixed-points/cobweb2.png" style="width:500px; height=auto "></p>
<p>Now we have a line segment with points $(1,1)\rightarrow(1,f(1))$. This step is equivalent to plugging in 1 into the top of our power tower, geometrically doing the operation of $f(x)$. Since we just a drew a vertical line, we now draw a horizontal one from the green graph $f(x)$ until it intersects the red one $y = x$.</p>
<p><img src="/img/fixed-points/cobweb3.png" style="width:500px; height=auto "></p>
<p>Now we have a new line segment from $(1,f(1))\rightarrow(f(1),f(1))$. You can probably see where this is going. Now that we have a new point at $x = f(1)$, we can draw a new vertical line until it hits the green graph, geometrically finding the value of $f(f(1))$, performing our repeated operation! We can do this series of horizontal to vertical lines as many times as we want to get as many iterations of our repeated function as we want!</p>
<p><img src="/img/fixed-points/cobwebFinal.png" style="width:500px; height=auto "></p>
<p>Now you can probably see why this is called a cobweb plot, as we weave back and forth creating a net-like shape between the graphs (and it only gets more wild looking with different iterative functions!). Even in the previous graph where I set the seed value to be $x=-1$, our graph still quickly hones in on evaluating to $x = 2$ for the $\sqrt{2}$ power tower, just where it happens to be the intersection of our two plots. This is a pretty narrow scope of our graph, though; let&#39;s zoom out and see more of this plot.</p>
<p><img src="/img/fixed-points/cobwebZoom.png" style="width:500px; height=auto "></p>
<p>There&#39;s also an intersection at $x=4$! Even with all of this, I don&#39;t think it would be wrong to feel that $x=4$ should <em>not</em> be a solution to some extent. Even though, it clearly shows a lot of the same characteristics that $x=2$ does, it still feels weird for this to be considered an answer, or at least to the same extent that $x=2$ is. For any seed $x&lt;4$, our iteration converges to $x=2$, and for any $x&gt;4$, it diverges. Only at $x=4$ does our repeated power tower equal 4. To properly understand this, we&#39;ll need to utilize derivatives.</p>
<h2 id="derivatives-and-sensitivity">Derivatives and Sensitivity</h2>
<p>The classic definition of the derivative $f&#39;(x)$ is a function that returns the slope of $f(x)$ at every point $x$. While this definition of the derivative isn&#39;t wrong, it is fairly limiting when only considered in the contexts of slopes. We can reframe the idea of a derivative not to be the slope of a function at a point $(a,f(a))$ but rather how <em>sensitive</em> the function is at the point $(a,f(a))$. This will be more apparent if we plot our $f(x)=\sqrt{2}^x$ in a new way.</p>
<p><img src="/img/fixed-points/newGraph.png" style="width:700px; height=auto "></p>
<p>You can generate the above plot with the following Python:</p>
<p><!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 11pt;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">numpy</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">np</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">matplotlib.pyplot</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">plt</span></p>
<p><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">f</span><span style="color: #f8f8f2">(x):</span>
  <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sqrt(</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">)</span><span style="color: #f92672">**</span><span style="color: #f8f8f2">x</span>
<span style="color: #f8f8f2">inp</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">linspace(</span><span style="color: #f92672">-</span><span style="color: #ae81ff">5</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">5</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">40</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">out</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[f(n)</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">inp]</span>
<span style="color: #f8f8f2">d</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">10</span></p>
<p><span style="color: #f8f8f2">fig</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">plt</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">figure(figsize</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">(</span><span style="color: #ae81ff">20</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">4</span><span style="color: #f8f8f2">))</span>
<span style="color: #f8f8f2">axes</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">plt</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">gca()</span>
<span style="color: #f8f8f2">axes</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_xlim([</span><span style="color: #f92672">-</span><span style="color: #ae81ff">5.3</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">5.3</span><span style="color: #f8f8f2">])</span>
<span style="color: #f8f8f2">axes</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_ylim([</span><span style="color: #f92672">-</span><span style="color: #ae81ff">6</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">6</span><span style="color: #f8f8f2">])</span></p>
<p><span style="color: #f8f8f2">plt</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">scatter(inp,</span> <span style="color: #f8f8f2">[d</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(inp))])</span>
<span style="color: #f8f8f2">plt</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">scatter(out,</span> <span style="color: #f8f8f2">[</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">d</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(out))])</span>
<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">n</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(inp)):</span>
  <span style="color: #f8f8f2">plt</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">plot([inp[n],</span> <span style="color: #f8f8f2">out[n]],</span> <span style="color: #f8f8f2">[d</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">,</span> <span style="color: #f92672">-</span><span style="color: #f8f8f2">d</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">],</span> <span style="color: #f8f8f2">color</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39;green&#39;</span><span style="color: #f8f8f2">)</span>
</pre></div></p>
<p>This basically just took the $y$-axis of our Cartesian graph and rotated it $90^\circ$. The blue dots represent the preimage of points $x$, while the orange dots represent their associated transformations under $f(x)$ with green lines connecting them. Just looking at it, it&#39;s consistent with our Cartesian graph as $f(x)$ never goes below 0, which makes sense as an exponential is always positive. The reason why we want this graph as it guides the intuition behind this idea of sensitivity and the derivative.</p>
<p>Notice the dots around $x=-3$ in the preimage (blue) points. They all get mapped and squished down near $.354$ under $f(x)$; they get tightly pressed together. But just <em>how</em> tightly pressed together are they? That&#39;s exactly what the derivative tells us! For a small change $dx$, we want to know how much that changes the output $df$. In this case, $f(x)=\sqrt{2}^x \rightarrow f&#39;(x)=\sqrt{2}^x\cdot\ln{\sqrt{2}}$. Plugging in $f&#39;(-3)=.1225$. This means that around $x=-3$, the ratio between how much the points around it changes under $f(x)$ is $.1225$, in other words, the area around $x=-3$ appears to have shrunk <em>inward</em> by a factor of $.1225$. In the contexts of slopes, this ratio would be the slope of our tangent line, telling us how tall $df$ would be relative to $dx$. Since the derivative $f(-3)$ is small, we can say that $f(x)$ is not very sensitive around $x=-3$, as a small change in input from $-3$ will still evaluate to about the same value.</p>
<p>Now let&#39;s look on the right half of the graph. Trying $f&#39;(4.5)=1.6486$ would imply under our previous logic, that we&#39;d expect points to stretch <em>away</em> from $x=4.5$ by a factor of $1.6486$. Just by looking at our plot, that&#39;s not so hard to believe. This means that our $f(x)$ is sort of sensitive around $x=4.5$, as a small difference in input from $4.5$ can lead to a big difference in evaluating $f(x)$.</p>
<p>So now we know that for a given $a$, if $|f&#39;(a)| &lt; 1$, it&#39;s a shrink, and if $|f&#39;(a)| &gt; 1$, it&#39;s a stretch (a negative derivative implies there&#39;s also a flip occurring, but we care only about magnitude). You can now kind of imagine what effects these have when we iterate over $f(x)$ for a long time: points will gravitate towards numbers that shrink the area around them, and be repelled away from numbers that stretch them. Now, relating this back to our original Cartesian plot, let&#39;s highlight the areas in which $|f&#39;(a)| &gt; 1$.</p>
<p><img src="/img/fixed-points/derivativeGraph.png" style="width:500px; height=auto "></p>
<p>Well, look at that! Our $x=4$ solution is in our blue $|f&#39;(x)|&gt;1$ region, while our $x=2$ solution is not!</p>
<p>Connecting this all together now, we had two solutions to an iterative function, but only one of which was appearing in practically every case. When graphing its respective cobweb plot, we see that one solution lies in a non-sensitive region ($f&#39;(2) = .6931$), while the other does ($f&#39;(4) = 1.3863$). So what can we say about either solution? Since we know $f(2)$ is not sensitive to small changes and moreover shrinks space around it, we know that $x=2$ is a <strong>stable fixed point</strong> of the iterative function $f(x) = \sqrt{2}^x$. It&#39;s stable under the notion that because it isn&#39;t sensitive to small changes in its neighborhood of points, with each iteration we take, we map points closer and closer to $x=2$ due to the squishing effect of its derivative. But for $x=4$, which is sensitive, each iteration tends to stretch and repel points away from $x=4$, even though it too intersects in our cobweb plot as well as analytically solves the equation. Hence, we call $x=4$ an <strong>unstable fixed point</strong> of the system. Just like we&#39;ve described, while $x=4$ is valid for its seed value, the slightest discrepancy in value pushes numbers away from it to either start approaching $x=2$, or diverge to infinity (like in our rounding error in the Python script before!). If we quickly go back to our graph style with 2 number lines and perform the function iteratively there, we can really see what these pulls and pushes of numbers looks like. Here&#39;s what the first 10 iterations of $\sqrt{2}^x$ looks like:</p>
<p><img src="/img/fixed-points/iterativeGraph.png" style="width:700px; height=auto "></p>
<p>You can really see how tight the points coil around $x=2$, and split away from $x=4$. Even with an initial value that starts so close to $x=4$, you can still see it slightly drift away from it at each iteration. This is why thinking of derivatives as measures of sensitivity is so important: the value of the derivative tells you how strong of a pull or push certain numbers have. Consistent with our findings, $x=2$ has a pulling effect around it with a small derivative, while $x=4$ has a pushing effect with its large derivative.</p>
<p>This is why we were also able to use cobweb plots: they were the geometric algorithm to solve when $f(x)=x$, which makes sense as if something is a fixed point, no matter how many times we apply a function to it, it should remain the same. So when solving $\sqrt{2}^x = x$, you&#39;ll get the intersections we found earlier at $x=2,4$ (if you want to try and actually solve this equation, it requires the clever use of the <a href="https://mathworld.wolfram.com/LambertW-Function.html">Lambert W-function</a>). That&#39;s why we were able to analytically solve for two different solutions, but only one kept popping up everywhere. This isn&#39;t limited to just power towers, though.</p>
<h2 id="variations">Variations</h2>
<p>This type of relationship between stable and unstable fixed points is everywhere. Take the well-known infinite fraction below:</p>
<center>
$1 + \large{\frac{1}{1 + \frac{1}{1 + \frac{1}{1 + \frac{1}{\ddots}}}} }$
</center>

<p>By setting this equal to $x$, we can solve it just like we did before with the power towers.</p>
<center>
$1 + \large{\frac{1}{ \fbox{$1 + \frac{1}{1 + \frac{1}{1 + \frac{1}{\ddots}}} $} }} = x$
<br>
$1 + \frac{1}{x} = x$
<br>
$x^2-x-1=0$
</center>

<p>Using the quadratic formula, we once again get two solutions:</p>
<center>
$\varphi = \frac{1+\sqrt{5}}{2} \approx 1.618$ and $1-\varphi = \frac{1-\sqrt{5}}{2} \approx -.618$
</center>

<p>The famous Golden ratio $\varphi$ and its underrated second solution. Still, it begs the question, how can a completely positive infinite fraction equate to something negative? Illustrating this with our cobweb and sensitivity regions will make this clear once again. Setting $f(x)=1+\frac{1}{x}$, we get…</p>
<p><img src="/img/fixed-points/cobwebGolden.png" style="width:500px; height=auto "></p>
<p>A lot like $x=4$ when iterating $\sqrt{2}^x$, $1-\varphi$ is the unstable fixed point in the sensitive region, with numbers getting pushed away at every iteration, while $\varphi$ is the stable one which we quickly spiral down towards. We can quickly verify that $1-\varphi$ is a &quot;valid&quot; solution by plugging it into $1+\frac{1}{x}$ just like we did with $x=4$ into $\sqrt{2}^x$.</p>
<center>
$1+\frac{1}{1-\varphi} = 1-\varphi$
</center>

<p>For its own seed value, $1-\varphi$ is valid, but I guess that&#39;s up to you if you want to equate a negative value to a positive infinite fraction.</p>
<p>For those who are interested, try setting your seed value to a number in the form of $-\frac{F_n}{F_{n+1}}$ where $F_n$ represents the nth Fibonacci number. The Golden ratio is closely tied to the Fibonacci numbers, so it may be a bit unsurprising why they may relate here. If you try to iterate over any number in this form, you&#39;ll eventually hit a point where evaluating the function becomes undefined. Try plugging in a few and watch the strange cascading effect happen.</p>
<p>There are a whole host of functions that have interesting iterations as well. Let&#39;s try $f(x) = \cos(x)$</p>
<p><img src="/img/fixed-points/cobwebCOS.png" style="width:500px; height=auto "></p>
<p>Since $f&#39;(x) = -\sin(x)$, $|f&#39;(x)|$ is always less than or equal to 1, so all fixed points it has will not diverge. In this case, we get a solution of $\approx .73909$, sometimes referred to as the <a href="https://mathworld.wolfram.com/DottieNumber.html">Dottie number</a>, which has its own set of interesting properties (for one, it&#39;s a transcendental number of the likes of $\pi$ and $e$!). If you are interested in a bit of why this has a fixed point, allow me to point you towards the <a href="https://en.wikipedia.org/wiki/Banach_fixed-point_theorem">Banach Fixed-Point Theorem</a> for an interesting perspective that guarantees this fixed point. Let&#39;s try another function. What happens if we scale $f(x)$? Let&#39;s try $5f(x) = 5\cos(x)$</p>
<p><img src="/img/fixed-points/cobweb5COS.png" style="width:500px; height=auto "></p>
<p>We have not one, not two, but three different intersection points of where $5\cos(x) = x$. But notice, all three of them lie within the sensitive region where $f&#39;(x) &gt; 1$; they&#39;re all unstable. You can probably tell just by looking at it, it&#39;s a very chaotic diagram. This might not be unexpected for some of you though. If it doesn&#39;t converge to anything, but also not diverge, why wouldn&#39;t it just randomly jump around ad infinitum? Well, let me just present another function to explain why. Let&#39;s make a cobweb plot for $f(x) = 3.2x(1-x)$</p>
<p><img src="/img/fixed-points/logisticMap.png" style="width:500px; height=auto "></p>
<p>Here we have 2 intersection points, both of which are in the sensitive region where points should not converge to excluding its own value, and that&#39;s exactly what we see with no definite attraction to any one fixed point. Yet, it&#39;s not like our iterations are randomly moving. In fact, just looking at the diagram, it&#39;s quite predictably going in a cycle between two $x$-values of $\approx .516$ and $\approx .8$. The difference between $5\cos(x)$ and $3.2x(1-x)$ is how it interacts with our seed value. For the former, it has a quality known as <em>sensitive dependence on initial conditions</em>, or more commonly referred to as the Butterfly effect: a small change in the seed value can produce wildly different outputs in iteration in the long run, just like how a butterfly&#39;s wings can produce a hurricane years later halfway across the globe. This is a common property of what is aptly deemed <em>chaotic behavior</em>. The latter function, while it may not have a convergent value, it does not exhibit Butterfly effect-esque behavior nor chaos while iterating over it, and instead settles into this cycle. As a kickstarter for those interested, $3.2$ in the latter function was not an arbitrary choice: it comes from a family of iterative functions of the form $rx(1-x)$ known as the <a href="https://mathworld.wolfram.com/LogisticMap.html">logistic map</a>. There&#39;s so much to talk about there, it likely will be its own post later, but that&#39;s for another day.</p>
<p>I want to go back to the Golden ratio problem as there&#39;s a neat extension to a more general case of an iterative approximation technique that can be more applicable to problem solving that I want to share. It is known as the <strong>Newton-Raphson Method</strong> which can (usually) effectively hone in on roots of a polynomial quite efficiently.</p>
<h2 id="newton-raphson-method">Newton-Raphson Method</h2>
<p>The idea is fairly similar to what we did before, but since it&#39;s catered to finding roots of polynomials, its iterations have a modified step as we&#39;re looking for intersections with the $x$-axis instead of the line $y=x$. Here&#39;s the basic idea: 1) Pick an initial seed value $x_0$. 2) Draw a vertical line (like we did with the cobweb) until we hit the function $f(x)$. 3) Draw the tangent line of $f(x)$ at $x_0$, and see where it hits the $x$-axis. Call this new point $x_1$. 4) Repeat the process as many times as you&#39;d like for as accurate an approximation as you&#39;d like up to some $x_n$. Here&#39;s an example geometric interpretation for this method with $f(x) = x^2 - 13$.</p>
<p><img src="/img/fixed-points/NR1.png" style="width:500px; height=auto "></p>
<p>I had to zoom in extremely close for this graph because, as you can see, just after two iterations from a seed value $x_0=5$ finds a really accurate approximation of one of the roots of $f(x)$ and you wouldn&#39;t be able to see those lines unless magnified by this much. Let&#39;s work out a general iterative formula for this method. We first start with some $f(x)$. Just by using derivatives and definition of a line passing through the point $(x_n,f(x_n))$ for our tangent, we can solve the equation</p>
<center>
$f&#39;(x_n)(x-x_n) + f(x_n) = 0$
</center>

<p>to find the next point $x_{n+1}$ to continue iterating on (as it should be the $x$-intercept of that line like the instructions describe). Doing some basic algebra shows that:</p>
<center>
$f&#39;(x_n)(x-x_n) + f(x_n) = 0$
<br>
$f&#39;(x_n)(x-x_n) = -f(x_n)$
<br>
$x = x_n - \frac{f(x_n)}{f&#39;(x_n)}$
</center>

<p>So, tidying things up, for a given (continuous and differentiable) function $f(x)$, we can approximate its roots by iterating over with some initial $x_0$:</p>
<center>
$x_{n+1} = x_n - \frac{f(x_n)}{f&#39;(x_n)}$
</center>

<p>Trying this out with our $f(x) = x^2 - 13$, our recurrence relation after some simplifying becomes</p>
<center>
$x_{n+1} = \frac{1}{2}(x_n + \frac{13}{x_n})$
</center>

<p>Or if you liked our previous notation, we can rewrite this as a function and iterate over</p>
<center>
$g(x) = \frac{1}{2}(x + \frac{13}{x})$
</center>

<p>Since this is in function form, we can use our old friend the cobweb to solve this for us.</p>
<p><img src="/img/fixed-points/cobwebSQRT.png" style="width:500px; height=auto "></p>
<p>It nicely finds $\sqrt{13}$ as a solution, just as we would expect. However, notice that there are two intersection points that lie <em>outside</em> of the sensitive region. One we found at $x=\sqrt{13}$, and the other is actually the second solution to $x^2-13=0$ at $x=-\sqrt{13}$. Our seed value significantly matters more in this case, as now depending on which zero of $f(x)$ is closer, our iteration will target only the closest solution, and this only becomes more important the more zeroes our function contains.</p>
<p>Even with all those caveats, notice what we just made! Our iterative function $g(x)$ is essentially a square root estimator, but with no exponents! While it&#39;s nice and convenient just to use exact answers, having decimal approximations are just as useful, especially for computers who don&#39;t have unlimited memory to use exact answers. For any number $n$, we can calculate $\sqrt{n}$ as accurately as we&#39;d like by iterating over the function</p>
<center>
$g(x) = \frac{1}{2}(x + \frac{n}{x})$
</center>

<p>as many times as we want. There are some exceptions where certain seeds can infinitely cycle or actually result in no subsequent $x_{n+1}$ (imagine a horizontal tangent line), but this method is incredibly useful, as this doesn&#39;t just extend to square roots, but to any function you want to approximate using the aforementioned formula</p>
<center>
$x_{n+1} = x_n - \frac{f(x_n)}{f&#39;(x_n)}$
</center>

<p>Here are a few other iterative functions for other roots of $n$:</p>
<center>
$\sqrt{n} \rightarrow \frac{1}{2}(x + \frac{n}{x})$
<br>
$\sqrt[3]{n} \rightarrow \frac{1}{3}(2x+\frac{n}{x^2})$
<br>
$\sqrt[4]{n} \rightarrow \frac{1}{4}(3x+\frac{n}{x^3})$
<br>
$\sqrt[p]{n} \rightarrow \frac{1}{p}((p-1)x+\frac{n}{x^{p-1}})$
</center>

<p>Going back to our Golden ratio iteration, we can rewrite it under the fixed point formula $f(x)=x\rightarrow 1+\frac{1}{x}=x$. If you multiply that through by $x$ and rearrange, we get a quadratic $x^2-x-1=0$. That&#39;s a quadratic we can solve for with the Newton-Raphson Method! Plugging it into the formula, we get a function to iterate over as</p>
<center>
$g(x) = \frac{x^2+1}{2x-1}$
</center>

<p>And sure enough, it works! The advantage of using the Newton-Raphson Method in this case, is that we no longer have to worry about unstable fixed points, as all of our solutions lie outside the sensitivity region. So even if we lose some insight into the nature of each solution, we consistently find each solution of $\varphi$ and $1-\varphi$ to an accurate decimal expansion with the right seed.</p>
<p><img src="/img/fixed-points/cobwebGolden2.png" style="width:500px; height=auto "></p>
<h2 id="what-else-">What Else?</h2>
<p>Iteration and fixed points become one of the prime topics for dynamical systems and describing much of the world around us. We discussed the Newton-Raphson Method of root finding, but there are many other recurrence relations for approximating roots of functions, each catered for their own purpose with different convergence rates and fail cases. Moreover, this is just a single <em>use</em> of the Newton-Raphson Method, for it is more well known as an alternative to gradient descent. Solving systems of differential equations comes down to finding the equivalent of a higher-dimensional fixed point, or in other words, an eigenvector: a vector (which is just an object that can encode more than one number and hence dimension) which doesn&#39;t change direction under the transformation describing the system of equations. Markov chains are also another extremely important occurence of fixed points over iteration: after a long series of transitions between states, we can make an overarching statement about the system as a whole reaching an <em>equilibrium state</em> where transition probabilities are expected to remain the same (going back to that idea of eigenvectors!). Synchronization is a prime example of a fixed point under iteration: even if a group of fireflies begin out of phase with one another, their coupling over time will reduce each other into a single large group with one cyclic, uniform behavior. The Mandelbrot set (and all of the Julia sets, for that matter) arise out of the fact that some complex numbers are bounded under iteration of functions $f(z)=z^n+c$ that remain bounded after a long time (sometimes being bounded to multiple values at once!). There are even entire studies dedicated to this. <em>Invariant theory</em> studies mathematical groups and polynomials to see how they remain unchanged under transformations. Almost all of chaos theory is about stability (or the lack thereof) over long periods of time (Nicky Case has a great introduction to <a href="https://ncase.me/attractors/">attractors</a>), and especially when what should be simple, predictable equations are not (we already talked about the logistic map, but see it illustrated in the <a href="https://en.wikipedia.org/wiki/Bifurcation_diagram">Bifurcation diagram</a>. It is particularly interesting for it appears in the most unlikely of places). We saw some chaotic behavior earlier, and the way I deduced it was chaotic was with a quantifier all iterative functions and maps have known as the <a href="https://en.wikipedia.org/wiki/Lyapunov_exponent">Lyapunov exponent</a>, and this itself is so interesting to look at for how functions change in behavior along with its Lyapunov exponent. For fixed points alone, there are hundreds of theorems dedicated to analyzing them (most notable of them being <a href="https://en.wikipedia.org/wiki/Brouwer_fixed-point_theorem">Brouwer&#39;s Fixed-Point Theorem</a>).</p>
<p>If you are interested in anything covered here, popular math YouTube channel <a href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">3Blue1Brown</a> made not <a href="https://youtu.be/CfW845LNObM">one</a> but <a href="https://youtu.be/elQVZLLiod4">two</a> videos discussing this idea of derivatives and infinitely stacked operations with the exact puzzle I posed at the start of this post. Their first video is what originally inspired me to look into these objects more when I first saw it a couple yeas back. Their animations do wonders compared to what any text post can do, so please do check them out if you want a more visual approach to these processes along with some additional justification for solutions to iterative processes.</p>
<p>Fixed points appear everywhere, and I hope this shared a few insights into how they can appear, deceive, and approximate even the most out there of expressions.</p>
]]></description>
         <link>http://xperimex.github.io/blog/fixed-points</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/fixed-points</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Metropolis-Hastings and MCMC, Briefly]]></title>
         <description><![CDATA[How to guess mathematically 

 <p>Today, I want to talk about a really powerful tool in math and statistics, that on its own may seem very niche, the concept behind it is something really—and I mean <em>really</em>—powerful and is how many other discoveries and tools are made and immortalized. In particular, I want to talk about the Metropolis-Hastings algorithm and Markov chain Monte Carlo methods. If you want to skip the basics, here&#39;s a short table of contents:</p>
<ol>
<li><a href="#markov-chains">Markov Chains</a></li>
<li><a href="#monte-carlo-simulations">Monte Carlo Simulations</a></li>
<li><a href="#metropolis-hastings-and-mcmc">The Metropolis-Hastings Algorithm</a></li>
</ol>
<p>Brief summaries are at the bottom of each section if you want a quick referesher for anything above, but first, some review.</p>
<hr>
<p>This is also all written more formally with other examples in this <a href="/img/metropolis-hastings/Metropolis_Hastings_and_MCMC.pdf">paper</a>.</p>
<h2 id="markov-chains">Markov Chains</h2>
<p><strong>Markov chains</strong>, in essence, are a way to model a process that randomly jumps between different outputs, where each output is said to have some probability to jump to other outputs. They&#39;re sort of like rolling dice, but the likelihood you roll any number is only dependent on the number you rolled last. It might help to describe this with an example. Let&#39;s say you want to know what the weather will be in 5 days: will it be sunny or rainy? Fortunately, the weather doesn&#39;t vary too much, so if it&#39;s sunny one day, it&#39;s likely to be sunny again the next day with 80% chance. If it&#39;s rainy, it will likely be rainy again too, with, say, 60% chance. This can be shown quite succinctly in a little diagram:</p>
<p><img src="/img/metropolis-hastings/markovChainExample.png"></p>
<p>This is our actual Markov chain, showing the two <strong>transition states</strong>, S(unny) and R(ainy) with their associated transition probabilities. However, we can&#39;t actually <em>do</em> much with just a picture alone. So, we can rewrite these probabilities and encode them in a matrix:</p>
<center>
$
M =
\begin{bmatrix}
.8 &amp; .2 \\
.4 &amp; .6
\end{bmatrix}
$
</center>

<p>You can think of each row as a different state for current weather, and the columns as probabilities for different states of tomorrow&#39;s weather. In this case, I have written row 1 and column 1 to indicate sunny days, and row 2 and column 2 to be rainy days. That&#39;s why entry $a_{1,1}$ in row 1, column 1 shows 80%, because if it is sunny today (row 1), we expect an 80% chance for it to be sunny tomorrow (column 1). Similarly $a_{2,2}=.6$, as if it&#39;s rainy today, we expect a 60% chance for rain again. $a_{1,2}=.2$ means that if today is sunny, then there is a 20% chance of rain tomorrow, and for completeness sake, $a_{2,1}=.4$ indicates a 40% chance for it to be sunny given today is rainy.</p>
<p>What we&#39;ve built here is known as a <strong>transition matrix</strong>, as, well, it&#39;s a matrix that shows transition probabilities; it&#39;s a matrix that shows how likely we are to jump from one state to another. In this case, our states are the different weathers: sunny or rainy. So, how does this help us answer our original question of the what the weather will be in 5 days? Well, let&#39;s first try to find the weather 2 days from now. We know how to model 1 day from now, and since these are probabilities, wouldn&#39;t it make sense just to multiply our matrix by itself?</p>
<center>
$
M^2 =
\begin{bmatrix}
.72 &amp; .28 \\
.56 &amp; .44
\end{bmatrix}
$
</center>

<p>Our probabilities have changed a little bit. Now it&#39;s saying, if today is sunny, there is a 72% chance it will be sunny 2 days from now. The reason why multiplying our matrix itself to get this result makes sense is because of the mechanics of matrix multiplication essentially asks: &quot;What is the probability from getting from one state to another in two steps?&quot; If you work out the multiplication itself, it might be clearer, but the way I like to think about it is in terms of transformations of space. For those familiar with a bit of linear algebra, we can think of our matrix $M$ as a collection of basis vectors that scale space (where our vectors in space can be thought of as a collection of starting states, i.e. the initial observed proportion of sunny days to rainy days). So applying $M$ once transforms space, we can then take that as a new &quot;default&quot; or &quot;unit&quot;. If we apply $M$ again to our basis vectors, it has the effect of transforming space once again. This can be thought of as our standard, independent probability multiplication, but instead of changing a singular probability (i.e. dice value), we are changing two (likelihood of sunny <em>and</em> likelihood of rainy days).</p>
<p>With this in mind, our question is easy. It boils down to what $M^5$ is.</p>
<center>
$
M^5 =
\begin{bmatrix}
.67008 &amp; .32992 \\
.65984 &amp; .34016
\end{bmatrix}
$
</center>

<p>So if today is sunny, we look at row 1 and can expect a 67.008% chance of sunny weather, and if it&#39;s rainy, row 2 shows a 65.984% chance for sunny weather. Nice! But you might be looking at that matrix and notice that row 1 and row 2 are <em>almost</em> the same. Watch what happens if we don&#39;t check for any 5 days in the future, but if we look towards an infinite number of days ahead?</p>
<center>
$
\lim\limits_{n\to\infty} M^n =
\begin{bmatrix}
.\overline{666} &amp; .\overline{333} \\
.\overline{666} &amp; .\overline{333}
\end{bmatrix}
$
</center>

<p>The rows <em>do</em> become the same. So, if we were to pick a random day far, far into the future, we can expect it to be twice as likely to be sunny than rainy regardless of today&#39;s weather. There&#39;s two important interpretations of this fact. 1) going back to our transformation of space idea, this <strong>equilibrium state</strong> is our eigenvector (specifically for $\lambda=1$) of our transition matrix $M$. Meaning, it is the solution to the matrix equation $vM = v$ where $v$ is a row vector (here, $v=\begin{bmatrix} .\overline{666} &amp; .\overline{333} \end{bmatrix}$). The second—and more important—way to think of this equilibrium state is that it is the final, or <strong>stationary</strong> distribution of sunny and rainy days. That is, if you took the fraction of $\frac{\textrm{Sunny Days}}{\textrm{Total Days}}$, you&#39;d expect it to approach $\frac{2}{3}$ as time went on, and $\frac{\textrm{Rainy Days}}{\textrm{Total Days}}$ to likewise approach $\frac{1}{3}$.</p>
<p>To summarize, here are a few important concepts about Markov chains:</p>
<ol>
<li>A Markov chain is a random process that describes the ability to switch between multiple states.</li>
<li>A Markov chain&#39;s probability for any future state depends only on the current state (this is also known as the <a href="https://en.wikipedia.org/wiki/Markov_property">Markov property</a>).</li>
<li>The sum of each row of a Markov chain&#39;s transition matrix must sum to 1 (something has to occur at each time step for each state, even if that means not changing states)</li>
<li>All Markov chains will eventually reach an equilibrium state that describes the final distribution of states over a long time.</li>
</ol>
<p>Markov chains are extremely powerful tools to model dynamics with multiple states due to their above properties, but some of their uses from chaos to disease modeling deserve their own post another day.</p>
<hr>
<p>If you understood this so far, you&#39;ve got the hardest part of Markov chain Monte Carlo methods under your belt. That being said, we are still missing second MC of MCMC.</p>
<h2 id="monte-carlo-simulations">Monte Carlo Simulations</h2>
<p><strong>Monte Carlo simulations</strong> are probably the closest you&#39;ll ever get to the scientific version of guess-and-check. The idea is if there is something that&#39;s too hard to calculate, you do a bunch of mini, random experiments to obtain data that can give us numerical approximations. It&#39;s very akin to Bayesian thinking: the more data you give to your approximation, the better the you can &quot;update&quot; your approximation to be more accurate and confident. As with all things, let&#39;s do a quick example.</p>
<p>If I hand you a coin, you probably would assume it&#39;s a fair coin: 50/50 chance for either heads or tails. But how could you verify that it is indeed a fair coin? Well you could flip it and see what it turns up as. Heads! &quot;It must be an unfair coin as it flips heads 100% of the time!&quot; said no one ever. Of course a single data point isn&#39;t nearly enough to draw any conclusions, so you need to flip it again. Heads again! Definitely weighted, right? Even if you get only heads twice in a row, that still isn&#39;t conclusive. You need to flip the coin a lot of times. By a lot, upwards of hundreds for a reasonable guess at the balance of the coin, and upwards of thousands for an ideal approximation. For all you know, those first 2 heads could be in a much larger sequence of flips you have yet to unfold:</p>
<center>
<code>H-H-T-H-T-T-H-T-T-T-H-T-H</code>
</center>

<p>Just like that, our coin reaches that 50/50 split significantly closer within just a few additional flips. </p>
<p>Each one of our data points were flips in this case, and we call those data points <strong>samples</strong>. The important part to note, though, is that there is a sense of randomness in each sample. The idea behind a Monte Carlo simulation is that even if our sampling method is random, the more samples we take will average out to the true value (think the <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers]">Law of Large Numbers</a>). The is why the more samples we take, the more accurate our estimations become. This is a lot like unbiased sampling in research studies: you can&#39;t reasonably survey everyone in a population, so you take a smaller, random sample in the hopes that it will be representative <em>enough</em> to make reasonable conclusions of the larger population.</p>
<p>Again, just to summarize a few details:</p>
<ol>
<li>Monte Carlo simulations use random sampling to get numerical estimations for hard to otherwise calculate results.</li>
<li>The more samples/trials we take, the more accurate our results.</li>
<li>While taking more samples is more accurate, it also become less efficient to compute and gather results, so you have strike that balance between more accurate results or quicker results.</li>
</ol>
<hr>
<p>With all that out of the way, let&#39;s put it all together into one cool algorithm.</p>
<h2 id="metropolis-hastings-and-mcmc">Metropolis-Hastings and MCMC</h2>
<p>So far, we&#39;ve sampled from relativiely easy things to run trials on and get samples. Flipping a coin and rolling a dice are nice distributions to run trials on are they both can be modelled by a nice uniform distribution (even for weighted dice/coins by partitioning the uniformness). This is due to the niceness of a <strong>discrete</strong> distribution where there is only a finite number of results our black box can output. Often the case, we have a <strong>continuous function</strong> where we don&#39;t have probabilities for individual results, but rather a range of results. To get the gist of it, take the uniform probability distribution between $[0,1]$. What&#39;s the probability that you pick $0.235326…$? Obviously, out of an infinite amount of possibilities, a single, specific number to pick is probability 0. BUT, the probability of picking a number between $[.25,.75]$ is exactly $.5$, as we&#39;re picking from half of our total range. This is the idea of <strong>probability density</strong>. So, you can imagine for more complicated distributions (especially those taken from real life data) can be a lot more difficult to get samples from, or properly know the densities of regions. Here&#39;s where our MCMC comes from.</p>
<p><strong>Markov chain Monte Carlo</strong> methods combine two important aspects of the two concepts the name implies: a Markov chain&#39;s equilibrium distribution and Monte Carlo simulation&#39;s random sampling. Here, we make a Markov chain who&#39;s stationary distribution is <em>equal</em> to our hard-to-model probability distribution by doing a random walk around the distribution (for the sake of notation, we&#39;ll call our &quot;target&quot; distribution we&#39;re trying to model $\pi(x)$). In this case, we do so with the Metropolis-Hastings algorithm which is extremely simple:</p>
<ol>
<li>Pick a starting point $x_0 \rightarrow$ this is the start of our &quot;walk&quot;. An initial sample, if you will, that we provide ($x_t$ means our current sample at time $t$).</li>
<li>Now pick a new, <em>random</em> point $y$. Call $y$ the &quot;proposed state&quot; for $x_{t+1}$.</li>
<li><p>See how &quot;good&quot; $y$ is compared to $x_t$.</p>
<p>i. If $y$ is &quot;better&quot;, we let $x_{t+1}=y$</p>
<p>ii. If $y$ is &quot;worse&quot;, we <em>might</em> let $x_{t+1}=y$, but not always.</p>
</li>
<li>For $t=1,2,3,…$, repeat steps 2 and 3.</li>
<li>Profit.</li>
</ol>
<p>This is extremely vague, but I intentionally left it as such, because often times the formulas can confuse the language. In essence, this is what Metropolis-Hastings does to generate samples. We take a sample $x_t$ at a time $t$ that &quot;traces&quot; our distribution, and as $t$ gets larger, the more accurate our &quot;trace&quot; of the curve we walk around gets better. Let&#39;s put some of the formulas back into the instructions above and go at it one step at a time.</p>
<p><strong>Step 1</strong> is easy enough: we give any number for our algorithm to start with. Literally anything. You can give smart guesses that speed up the process, but that will be clear in a second.</p>
<p><strong>Step 2</strong> we don&#39;t actually perform, but rather design. Unlike Step 1 where we gave some determined number of our choosing, Step 2 we implement a <strong>transition kernel</strong> to pick a step for us. This kernel is a function $Q$ that takes a current spot $x$ and with some probability outputs a new spot $y$. That is, $Q$ is a distribution that randomly generates a new point $y$ <em>given</em> a current one $x$, which we will write $Q(y|x)$. This is how we make our &quot;proposed state&quot; and how we actually implement our walk. You may be wondering though, &quot;What <em>actually</em> is $Q$?&quot; Well, that&#39;s up to you to decide! Since $Q$ itself is a distribution around our current state $x$, you can shape $Q$ in whatever way you want! In general, though, it&#39;s not too important, but spending time to design a specific kernel can optimize and speed up the process.</p>
<p><strong>Step 3</strong> is our &quot;goodness&quot; check. Once we have a proposed state generated by $Q$, we need to see if this proposed state is in a more &quot;likely&quot; or dense spot on our distribution $\pi(x)$. The idea is we want to generate samples representative of $\pi(x)$, so it should be obvious that we should visit the probabilistically more dense spots, a.k.a. visit the spots the distribution says is more likely. Geometrically, this is a point <em>higher</em> on our distribution curve. </p>
<p><img src="/img/metropolis-hastings/metropolisAcceptance.png"></p>
<p>But remember, just because $y$ is not better doesn&#39;t mean that we outright reject it. We instead accept it with probability <em>proportional</em> to how much worse it is. If $y$ is half as high as our current spot $x$, we flip a coin and might accept it with 50% probability. If $y$ was a third as high $x$, we flip a weighted coin and might accept it with probability $\frac{1}{3}$. In other words, we can write our acceptance probability $A=\min(1, \frac{\pi(y)}{\pi(x)})$. If $y$ is higher than $x$, or $\pi(y)&gt;\pi(x)$, then $\frac{\pi(y)}{\pi(x)} &gt; 1$ and we accept it outright. If $\frac{\pi(y)}{\pi(x)} &lt; 1$, then we accept it with probability of that fraction. </p>
<p>This acceptance probability is also what makes this algorithm so good: we only need to know our target distribution $\pi(x)$ up to a constant! If $\pi(x) = c\cdot P(x)$, then our acceptance probability would be $A=\min(1, \frac{c\cdot P(y)}{c\cdot P(x)})$ which simplifies to $\min(1, \frac{P(y)}{P(x)})$, making the constant irrelevant. This is ideal for real life experiments as perfectly measuring constants from observation can be very difficult.</p>
<p><strong>Steps 4 and 5</strong> are pretty self-explanatory, so just to rewrite it more formally, here is the whole algorithm one more time:</p>
<ol>
<li>Pick a starting point $x_0$.</li>
<li>Sample a new proposal state $y$ with probability $Q(y|x_t)$</li>
<li><p>Compute $A=\min(1, \frac{\pi(y)}{\pi(x_t)})$.</p>
<p>i. With probability $A$, accept our proposed state and let $x_{t+1}=y$</p>
</li>
<li><p>For $t=1,2,3,…$, repeat steps 2 and 3.</p>
</li>
<li>Profit.</li>
</ol>
<p>However I must admit, I did lie to you, but only a <em>little</em> bit. The acceptance probability I gave is actually for the Metropolis algorithm, not the Metropolis-Hastings algorithm. The acceptance probability for the Metropolis-Hastings algorithm is $A=\min(1, \frac{\pi(y)Q(x_t|y)}{\pi(x)Q(y|x_t)})$. This is because the Metropolis algorithm only works when $Q$ is a symmetric distribution, meaning that $Q(y|x_t)=Q(x_t|y)$, which returns us to our familiar fraction from before. MH allows asymmetric kernels to speed up the algorithm, but otherwise the concept is the same.</p>
<p>With 5 very simple steps, we are able to take samples from continuous distributions just like that! The Monte Carlo aspect is pretty obvious with the random steps with generating random &quot;proposal states&quot; $y$ in <strong>Step 2</strong>. The Markov chain might be a bit more concealed, as we never actually explicitly define it. But, look at <strong>Step 3</strong> again, as that resembles something very close to our transition probabilities before. Step 3 is actually our Markov chain <em>implicitly</em> defined! Since there are an infinite number of states/values to pick and another infinite number of states to transition to, we can&#39;t define an infinitely sized transition matrix. So, instead, we define transition probabilities as needed with our kernel $Q$. And notice, our kernel maintains the Markov property as each proposed state only relies on the current. This is because we sort of reversed the way we defined our Markov chain! In our weather example with sunny and rainy days from above, we defined transition states and the stationary distribution followed suit, almost like property or characteristic of our Markov chain. Here, our Markov chain is instead defined by the fact we want our stationary distribution to mimic $\pi(x)$. This is why we don&#39;t outright reject states that are less &quot;good&quot; in our acceptance probability, but rather accept it proportional to how less &quot;good&quot; it is as that will reflect our distribution&#39;s shape.</p>
<p>But just like in our original Markov chain example, it&#39;s not perfect immediately. Notice in our original weather example with sunny and rainy days, 2 iterations with $M^2$ was no where near close our stationary distribution, and while 5 iterations at $M^5$ was closer, it still was nowhere near ideal. You have to <em>burn in</em> some states before proper, accurate samples can be generated. </p>
<p>Here&#39;s some short Python to implement the Metropolis-Hastings algorithm to estimate the following Laplace distribution:</p>
<center>
$\large{\pi(x)=\frac{1}{2}\exp(-|x|)}$
</center>

<p>Here it is in only 20 lines of code:</p>
<p><!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 11pt;"><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">numpy</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">np</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">matplotlib.pyplot</span> <span style="color: #66d9ef">as</span> <span style="color: #f8f8f2">plt</span></p>
<p><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">target</span><span style="color: #f8f8f2">(x):</span>
  <span style="color: #66d9ef">return</span> <span style="color: #f92672">.</span><span style="color: #ae81ff">5</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">exp(</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">abs(x))</span> <span style="color: #75715e"># Target distribution π(x)</span></p>
<p><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">accept</span><span style="color: #f8f8f2">(p):</span>
  <span style="color: #f8f8f2">flip</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">random</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">uniform(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
  <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">p</span> <span style="color: #f92672">&gt;=</span> <span style="color: #f8f8f2">flip</span></p>
<p><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">metropolis</span><span style="color: #f8f8f2">(iterations):</span>
  <span style="color: #f8f8f2">states</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span> <span style="color: #75715e"># Samples generated by the algorithm</span>
  <span style="color: #75715e"># Step 1 --&gt; initialize an x0</span>
  <span style="color: #f8f8f2">current</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span> 
  <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(iterations):</span>
    <span style="color: #f8f8f2">states</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(current)</span>
    <span style="color: #75715e"># Step 2 --&gt; Q generates a proposal (normal distribution)</span>
    <span style="color: #f8f8f2">proposal</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">random</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">normal(current,</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> 
    <span style="color: #75715e"># Step 3 --&gt; Check how good our proposal is</span>
    <span style="color: #f8f8f2">goodness</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">min(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">target(proposal)</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">target(current))</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">accept(goodness):</span> 
      <span style="color: #f8f8f2">current</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">proposal</span> <span style="color: #75715e"># If we like the proposal state, we jump there!</span>
  <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">states</span>
</pre></div></p>
<p>Here is the scatter plot of our algorithm walking all around $\pi(x)$ across 10000 iterations...</p>
<p><img src="/img/metropolis-hastings/scatterMH.png"></p>
<p>...and here is the corresponding histogram that fits almost too perfectly to our target distribution.</p>
<p><img src="/img/metropolis-hastings/histogramMH.png"></p>
<p>We can now generate discrete samples proportional to our continuous distribution!</p>
<hr>
<p>The algorithm aside, an extremely important concept is shown here: reframing questions and objects and asking them from a different perspective can lead to extremely powerful tools and thoughts. We take a Markov chain, and instead of letting its equilibrium state arise as a property, we use it to turn our definition inside out and use the equilibrium state itself to define the Markov chain. This pattern of rethinking concepts has always been a useful, sobeit from building intuition while learning, to defining tools in all of math. From connecting why Mandelbrot set to its cardioid and cycloids, to encoding parameters in 4-dimensional space means, to even Fourier rebuilding <a href="https://en.wikipedia.org/wiki/Fourier_series">functions from sine waves</a>, the most impactful question one can ask is usually in the form of, &quot;What if?&quot;</p>
]]></description>
         <link>http://xperimex.github.io/blog/metropolis-hastings</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/metropolis-hastings</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Fruitful Fractions and Delightful Dice]]></title>
         <description><![CDATA[A powerful tool to reimagine counting 

 <script src="https://www.desmos.com/api/v1.4/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>

<p>Try typing the fraction $\frac{1}{98}$ into your calculator see what you get. Don&#39;t have one on hand? Here&#39;s a calculator ready and waiting for you.</p>
<center>
  <div id="calculator" style="width: 610px; height: 375px;"></div>
  <script src="/js/scientificFraction.js"></script>
</center>


<p>Next try $\frac{100}{9899}$. See if anything stands out to you. Even with the few amount of decimals this displays, you might notice some patterns appearing. $\frac{1}{98}$ expanded as a decimal appears to contain the powers of 2! The second fraction might require for a more robust calculator, but with enough decimals it&#39;s clear that it too has a hidden sequence: the Fibonacci numbers are in its decimal expansion!</p>
<p>You can try and guess at other fractions with unique expansions, but there is a systematic way to generate these fractions to show not just simple sequences like this, but any sequence you want! It&#39;s all a byproduct of one of the most powerful tools in discrete math and combinatorics: the generating function.</p>
<h2 id="generating-functions-and-recurrence-relations">Generating Functions and Recurrence Relations</h2>
<p>First, some terminology and context. A <strong>generating function</strong> may look complicated, but its essence is actually very simple. If you have some sequence of numbers, say, $A = \{ a_0, a_1, a_2, a_3, \cdots \}$, its corresponding generating function is the power series $A(x) = a_0 + a_1x^1 + a_2x^2 + a_3x^3 + \cdots$. That&#39;s all a generating function is! If you like fancy math notation, we can write this more concisely as $A(x) = \sum_{n=0}^{\infty} a_nx^n$. Something important to note, though, is that the powers of $x$ in the series don&#39;t actually <em>mean</em> anything. We only really care about the coefficients, and we happen to be using the series to <strong>encode</strong> our sequence $A$. Herbet S. Wilf put this best in his aptly named book, <a href="https://www2.math.upenn.edu/~wilf/gfology2.pdf">generatingfunctionology</a>: &quot;A generating function is a clothesline on which we hang up a sequence of numbers for display.&quot; Basically, our generating function is purely a convenient way to place all of our sequence terms into a singular object. That&#39;s why it&#39;s not just any power series, but a <em>formal power series</em>, where it extends on towards an infinite number of terms where we don&#39;t really care about convergence, but rather just the representation itself. What&#39;s great about generating functions too are that it turns questions about sequences and integers into one about functions, and over the course of centuries, we can do a <em>lot</em> with functions. You&#39;ll see quickly why we use a power series specifically, as exponent properties play very nicely into the types of problems and tricks generating functions can help us out with. Knowing this, you shouldn&#39;t let the notation of a generating function ever scare you! They&#39;re truly a simple object obscured by harsh notation, so always focus what they represent instead of how they are written.</p>
<p>So, for our powers of 2, its sequence would be $P=\{ 2^n \}_{n=0}^{\infty}$ and corresponding generating function would be $P(x) = 1+2x+4x^2+8x^3+\cdots$. If you&#39;re familiar with your series, this is a geometric series and we can condense it into the following formula: $A(x) = 1+(2x)^1+(2x)^2+(2x)^3 + \cdots = \frac{1}{1-2x}$. Remember how I said the powers of $x$ don&#39;t really mean anything? This is a case where we can actually leverage the fact that our generating function is in fact a &quot;function&quot; (this is a specific use case as we normally don&#39;t treat them as standard functions). Consider the general generating function $A(x)=a_0+a_1x+a_2x^2+a_3x^3+\cdots$. Watch what happens if we plug in $A(.1) = a_0+a_1(.1)+a_2(.001)+a_3(.0001)+\cdots$. This may not look like much, but since we use a base 10 counting system, plugging in $.1$ is the same thing as moving a decimal point to the left one spot. So, we can rewrite that infinite sum as the nice float $a_0.a_1a_2a_3\ldots$ Each number in our sequence becomes a decimal in our final number! </p>
<p>But, this can become a problem if a number in our sequence $a_n$ is more than one digit long, so we can change the value we plug in to get more precise decimals with more numbers from our sequence: $A(.01) = a_0.0a_10a_20a_3\ldots$ and just like that we have buffer 0s in between numbers. So, doing this for our generating function for the powers of 2, we get that $P(.01) = \frac{1}{1-2(.01)} = \frac{1}{.98} = 1.0204081632\ldots$ Just for aesthetic pleasure, I like to multiply the final fraction by the value of $x$ we plugged in to shift that initial $a_0$ after the decimal point, and get a nicer looking fraction at the end: $\frac{1}{.98}\cdot .01 = \frac{1}{98}$, giving the familiar fraction from the start and the nice decimal of $.010204081632\ldots$</p>
<p>As cool as this may be, this relied on the fact we recognized what kind of series the generating function was (for the powers of 2, it was geometric). Let&#39;s take a look at a slightly more complicated sequence: the Fibonacci sequence. Unlike the powers of 2 where we knew a nice closed formula off the bat for each term, we don&#39;t have one (shhh) for the Fibonacci numbers. Instead, we can define the sequence by relating it to other terms. We&#39;ll call the Fibonacci sequence $F = \{ f_0, f_1, f_2, f_3, \cdots \}$ and its associated generating function $F(x) = \sum_{n=0}^{\infty} f_nx^n$ where $f_n$ is the nth Fibonacci number. By definition of the Fibonacci numbers, we also know that</p>
<center>
$f_{n+2} = f_{n+1} + f_n \hspace{.3cm} (f_0 = 0, f_1 = 1)$
</center>

<p>This equation is known as a <strong>recurrence relation</strong>, as, well, it&#39;s a recursive relationship; any given term in the sequence can be expressed in some form related to other terms. What&#39;s useful about having an equation like this is that we can relate this to our generating function! If we can solve for the generating function, we might be able to get a function that can get us our cool fraction with the sequence embedded in the decimals again! If we multiply through by $x^n$, we get…</p>
<center>
$f_{n+2}x^n = f_{n+1}x^n + f_nx^n$
</center>

<p>…and then we sum over from $0$ to $\infty$ we end up with…</p>
<center>
$\sum_{n=0}^{\infty} f_{n+2}x^n = \sum_{n=0}^{\infty} f_{n+1}x^n + \sum_{n=0}^{\infty} f_nx^n$
</center>

<p>We&#39;re now starting to have a set of terms that awfully resemble our generating function $F(x)$. Let&#39;s look at the left-hand and see if we can make any sense of it. Just writing it out can tell us a lot, so let&#39;s do that.</p>
<center>
$\sum_{n=0}^{\infty} f_{n+2}x^n = f_2 + f_3x + f_4x^2 + f_5x^3 + \cdots$
</center>

<p>It looks like our original generating function, but offset! Remember, we want the subscript of the term coefficient to equal the power of the $x$ it is attached to. We can multiply through by $x^2$ to easily fix that.</p>
<center>
$x^2 \cdot \sum_{n=0}^{\infty} f_{n+2}x^{n} = f_2x^2 + f_3x^3 + f_4x^4 + f_5x^5 + \cdots$
</center>

<p>However, we don&#39;t want to actually change the value of our recurrence and add extra factors to both sides. To counter the effects of the multiplication, we just add a term of $\frac{1}{x^2}$ before it since $\frac{1}{x^2} \cdot x^2 = 1$, negating the effects of our multiplication.</p>
<center>
$\sum_{n=0}^{\infty} f_{n+2}x^{n} = \frac{1}{x^2}(f_2x^2 + f_3x^3 + f_4x^4 + f_5x^5 + \cdots)$
</center>

<p>Now look at that right-hand side: it&#39;s our generating function $F(x)$ missing the first two terms, $f_0$ and $f_1x$!</p>
<center>
$F(x) = \color{red}{f_0 + f_1x} + f_2x^2 + f_3x^3 + f_4x^4 + f_5x^5 + \cdots$
<br>
$F(x) \color{red}{- f_0 - f_1x} = f_2x^2 + f_3x^3 + f_4x^4 + f_5x^5 + \cdots$
</center>

<p>Finally, after plugging it all back in, we end up with</p>
<center>
$\sum_{n=0}^{\infty} f_{n+2}x^{n} = \frac{1}{x^2}(F(x)-f_0-f_1x)$
</center>

<p>You can do a similar process with the other terms on the right-hand side of our original equation to finally get an expression in terms of the generating function, instead of the recurrences.</p>
<center>
$\frac{1}{x^2}(F(x)-f_0-f_1x) = \frac{1}{x}(F(x)-f_0) + F(x)$
</center>

<p>Now we just need to turn the wheel and solve for $F(x)$!</p>
<center>
$\begin{align}
\frac{1}{x^2}(F(x)-f_0-f_1x) &amp; = \frac{1}{x}(F(x)-f_0) + F(x) \
\newline
F(x)-f_0-f_1x &amp; = F(x)x-f_0x + F(x)x^2 \
\newline
F(x)-F(x)x-F(x)x^2 &amp; = f_0 - f_0x + f_1x \
\newline
F(x)(1-x-x^2) &amp; = f_0 - f_0x + f_1x \
\newline
F(x) &amp; = \small{\frac{f_0 - f_0x + f_1x}{1-x-x^2}} \
\end{align}$
</center>

<p>Remember, we had initial values $f_0=0$ and $f_1=1$, so we can plug those in to further simplify our fraction.</p>
<center>
$F(x) = \large{\frac{x}{1-x-x^2}}$
</center>

<p>And sure enough, $F(.01) = \frac{100}{9899} = 0.0101020305081321 \ldots$</p>
<p>But why stop there? Although we just solved that $F(x) = \frac{x}{1-x-x^2}$, don&#39;t forget our original definition that $F(x) = \sum_{n=0}^{\infty}f_nx^n$. These equations imply that if we can find a power series $\sum_{n=0}^{\infty}f_nx^n = \frac{x}{1-x-x^2}$, we should get a closed form for the nth Fibonacci number!</p>
<p>First, we need to decompose our function into its <a href="https://brilliant.org/wiki/partial-fractions/">partial fractions</a>. Let $\phi = \frac{1+\sqrt{5}}{2}$ and $\varphi = \frac{1-\sqrt{5}}{2}$.</p>
<center>
$\normalsize{ \frac{x}{1-x-x^2} = \frac{x}{(1-\phi x)(1-\varphi x)} = \frac{1}{\phi-\varphi}(\frac{1}{1-\phi x} - \frac{1}{1-\varphi x}) = \frac{1}{\sqrt{5}}(\frac{1}{1-\phi x} - \frac{1}{1-\varphi x}) }$
</center>

<p>Note our final result mimics the closed form of two different geometric series!</p>
<center>
$\frac{1}{\sqrt{5}}(\frac{1}{1-\phi x} - \frac{1}{1-\varphi x}) = \frac{1}{\sqrt{5}} ( \sum_{n=0}^{\infty}(\phi x)^n - \sum_{n=0}^{\infty}(\varphi x)^n) = \sum_{n=0}^{\infty}\frac{\phi^n-\varphi^n}{\sqrt{5}}x^n$
</center>

<p>So, to wrap it all up:</p>
<center>
$F(x) = \sum_{n=0}^{\infty}f_nx^n = \sum_{n=0}^{\infty}\frac{\phi^n-\varphi^n}{\sqrt{5}}x^n \rightarrow$ 
<br><br>
$\large{f_n = \frac{\phi^n-\varphi^n}{\sqrt{5}}}$
</center>

<p>Just like that, we&#39;ve found a formula for the nth Fibonacci number (this is known as <a href="https://artofproblemsolving.com/wiki/index.php/Binet%27s_Formula">Binet&#39;s formula</a>)! This is only a <em>sliver</em> of the power of generating functions: being able to turn a recurrence relation into a closed form solution, barely even interacting with the sequence at all! </p>
<p>Now, let&#39;s try a different type of problem generating functions can help us out with.</p>
<h2 id="counting-birds-with-generating-functions">Counting Birds with Generating Functions</h2>
<p>Say you&#39;re visiting an aviary with some friends. Well-respected, the aviary has a vast number of birds, but they&#39;ve noticed some interesting patterns in the behavior of their avifauna: their hummingbirds always fly solo; blue jays tend to nest in fours; toucans perch in pairs; and cassowaries chill in fives. How many ways can you see a total of 20 birds? </p>
<p>This may seeem like an odd spot for generating functions, but we&#39;ll see a nice property of exponents that allows us to use them. Here, a generating function $A(x) = \sum_{n=0}^{\infty}a_nx^n$ is an encoding such that each term $a_n$ denotes how many ways there are to see $n$ birds. Let&#39;s write the generating function for hummingbirds:</p>
<center>
$H(x) = 1+x+x^2+x^3+x^4+\cdots$
</center>

<p>So, if we want to see any number of birds, there is exactly one way we can see that many birds with only seeing hummingbirds. That makes sense! What about blue jays?</p>
<center>
$B(x) = 1+x^3+x^6+x^9+x^{12}+\cdots$
</center>

<p>Jays come in groups of 3, so it would make sense we could only see total birds in multiples of 3. If we want to see a group of 6 birds with only jays, there is one way we can do that (that is by seeing two groups of jays), but 0 ways to see 5 birds of only jays. Similar generating functions can be written for the other birds.</p>
<center>
$\begin{align}
H(x) &amp; = 1+x+x^2+x^3+x^4+\cdots
\newline
B(x) &amp; = 1+x^3+x^6+x^9+x^{12}+\cdots
\newline
T(x) &amp; = 1+x^2+x^4+x^6+x^8+\cdots
\newline
C(x) &amp; = 1+x^5+x^{10}+x^{15}+x^{20}+\cdots
\end{align}$
</center>

<p>The surprising thing is now, if we want to see the number of ways to see $n$ birds through a combination of different birds, all we have to do is multiply the generating functions together! But why would this ever work? Well, let&#39;s think of what our exponents mean in each function: they are the total number of birds we see from a group. So, if our giant product results in a term of, say, $x^{14}$, we know that is one way to see 14 birds. Why? Because exponents turn multiplication into addition: $x^a \cdot x^b = x^{a+b}$. So, if we get multiple copies of $x^{14}$, they&#39;ll all accumulate in the coefficient of that term, giving us the different ways to see a total of 14 birds! This is why using a power series specifically for generating functions are so helpful: not only do the exponents have a clear meaning when applied, they also carry over the nice exponent properties we can leverage in counting. In general, to count the number of ways to see $n$ birds, we look for the coefficient in front of $x^n$.</p>
<center>
$H(x)B(x)T(x)C(x) = $
<br> 
$(1+x+x^2+\cdots)(1+x^3+x^6+\cdots)(1+x^2+x^4+\cdots)(1+x^5+x^{10}+\cdots)$
</center>

<p>Expanding that out seems like a terrible idea, so we won&#39;t… We&#39;ll let Python do it instead! It&#39;s totally doable to do this by hand to systematically <em>extract the coefficient</em> of $x^{20}$ (especially with the series we&#39;ve selected, involving many binomial coefficients with its partial fraction decomposition), but the algebra along with it can get annoyingly tedious. I&#39;m sure there are clever ways to go about keeping track of which terms you&#39;re multiplying, but that&#39;s out of the scope of this post. </p>
<center>
$H(x)B(x)T(x)C(x) = 1+1x+2x^2+3x^3+ \cdots + 80x^{19} + 91x^{20} + 101x^{21}+\cdots$
</center>

<p>So, if you go to the aviary, we know there are 91 different ways to see a total of 20 birds. If you&#39;re interested in seeing the entire mathematical crank turn, great YouTuber Mathologer made an excellent video answering a similar question <a href="https://www.youtube.com/watch?v=VLbePGBOVeg">counting the number of ways to make change for dollar</a> in which he spends much more time going into detail the algebra to solve such a problem analytically. Regardless, I hoped this gave insight into how great generating functions are as a combinatorial tool for counting, in addition to its utility as a discrete tool.</p>
<p>Before we end, I want to show you one more cool use case of generating functions that involve probability distributions.</p>
<h2 id="delightful-dice-and-probability-distributions">Delightful Dice and Probability Distributions</h2>
<p>A staple of tabletop gaming has always been the pair of six-sided dice. Notably, it&#39;s respected for being a considerably fair distribution, with the most likely outcome being the middle value of 7 at $\frac{1}{6}$, and the two extreme values of 2 and 12 being the least likely, both at probability $\frac{1}{36}$. This makes it great for board games, with extraordinarily good, high values being just as likely as their low, unlucky counterparts. But, these dice are boring: for centuries our dice have remained a simple numbering from 1–6, but is there a different numbering that we can use to maintain our fair play?</p>
<p>If we use our familiar friend the generating function, we can find out with little thinking required! We can represent our die as a generating function $P(x) = \sum_{n=0}^{\infty}p_nx^n$ where $p_n$ is the probability of rolling a value $n$. So, for a standard die its generating function would be</p>
<center>
$\normalsize{\frac{1}{6}x^1+\frac{1}{6}x^2+\frac{1}{6}x^3+\frac{1}{6}x^4+\frac{1}{6}x^5+\frac{1}{6}x^6}$
</center>

<p>as you have an equal chance of rolling any number 1–6, and no other possible number (so all of their coefficients are 0 and get cancelled out). If we had a die with sides 1,2,2,7,7,7, it&#39;s generating function would look like</p>
<center>
$\normalsize{\frac{1}{6}x^1+\frac{1}{3}x^2+\frac{1}{2}x^7}$
</center>

<p>So, the generating function of the sum of <em>two</em> dice are just it&#39;s product like last time (to see why this is true, think about what the product means: exponents multiply into a sum, and therefore count the number of ways to sum a number from rolling two dice. We then normalize it by $\frac{1}{36}$ to get final probabilities). So, if we had two new dice—we&#39;ll call them die A and die B—with new generating functions $A(x)$ and $B(x)$, their product should equal the product of the normal dice!</p>
<center>
$A(x)B(x) = \frac{1}{36}(x^1+x^2+x^3+x^4+x^5+x^6)^2$
</center>

<p>So, now what? The right-hand side is currently packaged as two factors: two copies of the normal die&#39;s generating function. That means that if we can find a way to re-factor that right-hand side into two new generating functions, we should get the labelling for two new dice that are still just as fair as our ordinary dice!</p>
<center>
$\begin{align}
  \frac{1}{36}(x^1+x^2+x^3+x^4+x^5+x^6)^2 &amp; = \frac{1}{36}x^2(1+x+x^2+x^3+x^4+x^5)^2 \
  \newline
  &amp; = \frac{1}{36}x^2(1+x+x^2)^2(1+x^3)^2
  \newline
  &amp; = \frac{1}{36}x^2(1+x+x^2)^2(1+x)^2(1-x+x^2)^2
\end{align}$
</center>

<p>Now, we just need to figure out how to repackage this into 2 terms and we should have our dice! Some things to note: 1) All the coefficients in $A(x)$ and $B(x)$ need to be nonnegative multiples of $\frac{1}{6}$, as they all should have positive probabilitiy of rolling something and each die has 6 sides. 2) A(x) and B(x) both need to have at least one factor of $x$ as if otherwise, we might end up with 0s on our dice (which can make for some very boring dice). So, right now we have $A(x) = \frac{1}{6}x$ and $B(x) = \frac{1}{6}x$. Now we need to distribute the remaining factors $(1+x+x^2)^2(1+x)^2(1-x+x^2)^2$. Since we only have six sides on our dice, it follows that our coefficients of both $A(x)$ and $B(x)$ must sum to 6 (how can we put 7 numbers on a six sided die?). Since our factors&#39; have coefficient sums of 3, 2, and 1 respectively, <a href="#footnote">it follows immediately that both $A(x)$ and $B(x)$ need at least one factor of $(1+x+x^2)$ and one factor of $(1+x)$</a>. So, what do we do with the two factors of $(1-x+x^2)^2$? We can either give both to die A (or B, whichever you like thanks to symmetry), or one to A and one to B. If we do the latter, we get:</p>
<center>
$\begin{align}
A(x) &amp; = \frac{1}{6}x(1+x+x^2)(1+x)(1-x+x^2) \
\newline
&amp; = \frac{1}{6}(x^1+x^2+x^3+x^4+x^5+x^6) \
\newline
B(x) &amp; = \frac{1}{6}x(1+x+x^2)(1+x)(1-x+x^2) \
\newline
&amp; = \frac{1}{6}(x^1+x^2+x^3+x^4+x^5+x^6)
\end{align}$
</center>

<p>Which is just our normal dice from before, labelling both dice 1,2,3,4,5,6. But if we try the former option...</p>
<center>
$\begin{align}
A(x) &amp; = \frac{1}{6}x(1+x+x^2)(1+x)(1-x+x^2)^2 \
\newline
&amp; = \frac{1}{6}(x+x^3+x^4+x^5+x^6+x^8) \
\newline
B(x) &amp; = \frac{1}{6}x(1+x+x^2)(1+x) \
\newline
&amp; = \frac{1}{6}(x+2x^2+2x^3+x^4)
\end{align}$
</center>

<p>Now we get two very unique dice: label die A 1,3,4,5,6,8 and die B 1,2,2,3,3,4. Of course, multiplying these two generating functions together will verify their fairness as we didn&#39;t actually change any of the factors that goes into it, but you can also draw these dice&#39;s summation table and verify that all the numbers 2–12 appear as much as they should. If you want to mess with your friends a bit, making a pair of these dice for your next occasion is definitely an easy project to do in a day.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Hopefully this has shown you just how powerful generating functions and how wide of an application they have in discrete problems. From sequences, to counting, to probability, these are just a fraction of the potential generating functions have, and should always be kept in the back of your mind as not just a tool, but really as a symbol of an ongoing theme in problem solving: always look for out-of-the-box perspectives. I&#39;ve spoken about duality a bit before (and it definitely warrants its own post), but just how powerful alternative representations can be can&#39;t be understated. Generating functions took seemingly impossible questions about discrete sequences and indistinguishable counting to questions about functions and series and required at most a bit of high school algebra to manipulate some of the equations.</p>
<h3 id="footnote">Footnote</h3>
<p>While I left links to resources for relevant techniques and tools that I didn&#39;t explain, I do want to talk briefly on how I determined distributing factors for our polynomial coefficients in the dice problem as it&#39;s not completely obvious if you haven&#39;t seen it before. In the dice problem, I said that we need our final polynomial&#39;s coefficients to sum to 6. To ensure they summed to 6, I said that they both must be the product of a polynomial with coefficient sum of 3 and a polynomial with a coefficient sum of 2. This is because of the nice property that the product of two polynomials&#39; coefficient sum is equal to the coefficient sum of their polynomial product. In other words: let $C$ be a function that takes a polynomial $f(x)$ as an argument, $C(f(x))$ returns the sum of the coefficients of $f(x)$. I want to show you that $C(f(x)) \cdot C(g(x)) = C(f(x)g(x))$. </p>
<p>Let&#39;s first do an example. Let $f(x) = x^2 - 3x + 2$ and $g(x) = 2x - 4$. The coefficient sum of $f(x)$ is $C(f(x)) = 1-3+2 = 0$. Similarly, for $C(g(x)) = 2-4 = -2$. Therefore, $C(f(x))\cdot C(g(x)) = 0\cdot -2 = 0$. So, we&#39;d then expect $C(f(x)g(x)) = 0$ as well.</p>
<p>Now, let&#39;s see what the product of the two functions is and what its coefficient sum is. Let $h(x) = f(x)g(x) = 2x^3 - 10x^2 + 16x - 8$. Then, $C(h(x)) = 2-10+16-8 = 0$, just as we foresaw.</p>
<p>Why is this true? It comes down to a clever way of viewing the coefficient sums. Note that for any polynomial $f(x)$, $C(f(x)) = f(1)$. This fact is because plugging in 1 to any polynomial completely removes the powers of $x$, as $1^n = 1$ and $m\cdot 1 = m$, leaving us only with the coefficients. This allows us to rewrite $C(f(x)) \cdot C(g(x)) = f(1)\cdot g(1)$. Now, what about $C(f(x)g(x))$? Well, remember we defined $h(x) = f(x)g(x)$, so that means $C(f(x)g(x)) = C(h(x)) = h(1) = f(1)\cdot g(1)$, which is exactly what we got before! So this means that for any polynomial with coefficient $n$, it can be written as the product of two smaller polynomials with coefficient sums $a$ and $b$ with the only requirement that $ab = n$. That&#39;s how I knew in the dice problem that each die&#39;s generating function needed a factor with coefficient sums 3 and 2, since $3\cdot 2 = 6$.</p>
]]></description>
         <link>http://xperimex.github.io/blog/generating-functions</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/generating-functions</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Steiner's Porism and Incredible Inversions]]></title>
         <description><![CDATA[Time to flip circles inside out 

 <script src='https://cdnjs.cloudflare.com/ajax/libs/g9/1.0.16/g9.js'></script>
<script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>

<!-- <img src="/img/steiners-porism/steinersAnimated.gif"> -->
<div id="hook" style="flex: 2; position: relative;"></div>

<p>Today I want to talk about a type of geometry I think is grossly overlooked, especially when compared to the popularity of its Euclidean brother. In a world where linear transformations are the norm between translations, rotations, and dilations, sometimes it&#39;s hard to see anything but them as the workhorse geometric tools. However, there is an additional transformation that takes us from the solidarity of linear transforms to one of a type of circular transform that may seem novel at first, but is able to even extend complex analysis. Today I want to talk about <strong>inversive geometry</strong>. Inversive geometry takes the standard plane we know and quite literally flips it inside out. By the end of this post, you will be familiar with not only what in the world an inversion is, but a very cool theorem that results in the animation above that relates tangent circles to one another. But before we can get there, we first need to learn <em>how</em> to flip our world inside out.</p>
<h2 id="plane-inversions">Plane Inversions</h2>
<p>As you can imagine, inversive geometry is geometry that relies on something called <em>inversions</em>. You can think of an inversion as a function that takes a point $P$ and spits out a transformed point $P&#39;$. But, what exactly is our function? It&#39;s not a standard $f(x)$ as we&#39;re giving <em>two</em> coordinates not one. So maybe it&#39;s a 2-by-2 matrix, as we&#39;re giving a 2D vector and outputting another 2D vector? Not a bad idea, but it will quickly become clear why we don&#39;t want to do that. So, what <i>is</i> our functional object? It&#39;s actually a <em>circle</em>. As weird as that sounds, just hear it out. Given a circle $Ø$ with center $O$ and radius $r$, the point $P$ is inverted to $P&#39;$ based on the following equation: </p>
<center>
$\large{|OP| \cdot |OP&#39;| = r^2}$ 
</center>

<p>...where $P&#39;$ lies on the ray $\overrightarrow{OP}$. Try dragging the points below to get a handle on this idea.</p>
<div id="inversionIntro" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>Here we have the green circle $Ø$ which we are inverting the point $P$ over. Try dragging $P$, $O$, and $R$ around to see where its image $P&#39;$ goes under inversion.</p>
</center>

<p>The numbers above each point represent their distance from $O$, so you can verify the distances satisfy the inversion equation. As a nice little double entendre, this mapping is called an inversion for both algebraic and geometric reasons. The equation itself is an inverse relationship between $|OP|$ and $|OP&#39;|$ (this is why we can&#39;t use matrices <a href="https://math.stackexchange.com/questions/2626356/ill-known-original-interesting-investigations-on-applications-of-inversion-the?rq=1">in the standard sense to represent the transform</a>), but better yet, I&#39;m sure within just within a few seconds that you can much more intuitively see the geometric reason: every point $P$ on the inside of the circle gets mapped to the outside of the circle, and every point outside the circle gets mapped to the inside (and every point <i>on</i> the circle stays on the circle—we say the circle itself is <em>invariant</em> under inversion). We&#39;re taking our plane and flipping it inside out centered around the circle. </p>
<p>As such, this specific inversion is known as a <strong>circle inversion</strong> or <strong>plane inversion</strong>.</p>
<p>However, there might be a glaring issue to some of you: what if the point $P$ we&#39;re inverting is the center of the circle $O$ itself? Then we get $|OP|=0$, and how can 0 times anything equal anything but 0? To get around this issue, we have to formally introduce a <em>point at infinity</em>. That way, if we try to invert the center of our inverting circle, we have a place for it to go. </p>
<h2 id="circles-inverting-circles">Circles Inverting Circles</h2>
<p>Now that we can invert points, we can now easily invert <em>shapes</em>. All we have to do is invert the collection of points individually, and remember the order to connect them. We could try basic polygons like squares and triangles, but the one that is most interesting (and will be most helpful) is inverting other circles. Below, we&#39;ll again invert over the green circle with center $O$, but now instead of a point, we&#39;ll invert the blue circle with center $C$ to the red circle.</p>
<div id="invertingCirclesFast" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>Again, we have the green circle $Ø$ as our inversion circle, but instead of just a point $P$ that we&#39;ll invert, we&#39;ll invert the entire blue circle with center $C$. Drag the different points around to see where our blue circle inverts to along with its center $C$ to $C&#39;$.</p>
</center>

<p>A lot of our rules with inverting points can easily give us an intuition for how our circles might invert. Points on a circle that are <em>inside</em> of our green inversion circle get flipped to be outside of it, and vice versa, and points <i>on</i> the inversion circle stay on the inversion circle (see how the red circle passes through the intersections of the green and blue circles). But, since we are looking at a group of points, some discrepancies between points obviously exist. For instance: distance. I have drawn both the center of our blue circle $C$ as well as its inversion $C&#39;$. But just by looking at it, it&#39;s obvious that there&#39;s no way $C&#39;$ can be the center of the blue circle&#39;s inversion! That&#39;s due to one key aspect of inversions: <strong>they do not preserve distances</strong>. </p>
<p>That should be apparent due to the actual inversion equation $|OP| \cdot |OP&#39;| = r^2$. This inverse relationship between the length of $OP$ and $OP&#39;$ is what really exaggerates inversions with very small or very big values of $OP$. In fact, this is why inverting a circle is so interesting as even though the distances get all messed up, <a href="https://math.stackexchange.com/questions/2425789/purely-geometric-proof-that-circles-invert-to-circles">a circle will still always invert into another circle</a>. Try inverting a square and you&#39;ll almost definitely get something that doesn&#39;t look like a square (<em>almost</em> definitely as if you align the center of the square with the center of the inversion circle, then that will result in another square; just try drawing it out and it will all fall into place). Even when it doesn&#39;t <em>look</em> like a circle, it really is! Try dragging the blue circle such that it intersects the center of our green inverting circle. You&#39;ll get something that looks like a line. While it acts as a line, we formally say that this is a really really big circle. Specifically, a circle with an infinitely large radius. It&#39;s a lot like how in calculus they say if you zoom in super far in on a curve it looks like a line, if you have a super big curve it locally looks like a line from our perspective.</p>
<h2 id="recap">Recap</h2>
<p>Ok, that was a lot, but what does this tell us? Well, just experimenting with inverting one circle tells us much about inversions and some properties they have. Let&#39;s write them out.</p>
<ol>
<li>Inversions do not preserve distances. We saw this with how a circle&#39;s center may not invert to the center of the inverted circle.</li>
<li>Every point $P$ has a unique inversion $P&#39;$ for any given circle of inversion $Ø$ with center $O$ and radius $r$. This may seem obvious, but it&#39;s important to be aware of as it leads to the next very important characteristic...</li>
<li><strong>Intersections and tangency between two or more shapes are preserved during an inversion</strong>. This fact is the one you want to hold onto the most for the upcoming sections. This should make sense as if two or more shapes share some point in common such as an intersection or tangent point $P$, that singular point has only one unique inverse $P&#39;$ which they must also share. And if all the points need to be connected to that point after the inversion, then we should expect to see that intersection/tangent point remain after an inversion.</li>
<li>Lastly, just as a neat fact, performing the same inversion twice results in nothing changing (the identity). You can think of this sort of like what happens when turning a shirt inside out twice: the first time the seams come out, but the second time it just goes back to how it started. Just going back to our formula $OP \cdot OP&#39; = r^2$, we know that $OP&#39;$ has some length that corresponds with $OP$ to keep that product the same. So, if we let $P \rightarrow P&#39;$ representing our first inversion, $P&#39;$ needs to go back to $P$ to keep the formula the same for the second inversion. This makes the function of an inversion a special function called an <a href="https://en.wikipedia.org/wiki/Involution_(mathematics)">involution</a>.</li>
</ol>
<hr>
<p>With the basics of inversion down, we are now ready to explore that animation from the very top of this post.</p>
<h2 id="steiner-s-porism">Steiner&#39;s Porism</h2>
<p>Steiner&#39;s Porism can sound a lot more complicated than it is, but I promise you the animation at the top explains everything. Let&#39;s break it down step by step. First, draw two non-intersecting circles with one inside the other. Second, draw a third circle that is tangent to the inside and outside circle. Third, draw as many circles as you can, each tangent to the inside, outside, and last circle you drew until no more can fit (we call this chain of circles a <em>Steiner chain</em>). <strong>Steiner&#39;s Porism</strong> states if the last circle is tangent to the first circle you drew, then there are an infinite number of chains that are tangent to one another (and if they are not tangent, then there are an infinite number of chains that are not tangent). So in the GIF above, since the chain of black circles are tangent to one another, the black circles are free to rotate like ball bearings in between the outer blue and inner red bounding circles and the chain will always link up to make one of the infinite configurations. It&#39;s pretty interesting, but how would someone ever prove this? That&#39;s where our friend inversion comes in.</p>
<p>Before we go any further though, let&#39;s quickly see if there&#39;s an easier version of this scenario. One of the main issues I first had when looking at this was the fact that the black circles rolling around didn&#39;t have to be the same size. Fortunately, there&#39;s an obvious case where we don&#39;t have to worry about that: when the two bounding circles are concentric.</p>
<div id="concentricVariableSteinerChain" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>Try dragging the red point to change the red circle&#39;s radius, and try rotating the black point to see the symmetry in the chains of circles.</p>
</center>

<p>When the circles share the same center, then Steiner&#39;s Porism becomes obvious: our set up now becomes symmetrical, so you can think of any starting point as a rotation of the original chain of circles. Since this is an easy fact to see, we can now use a key property of inversions to prove the general case for <em>any</em> pair of bounding circles:</p>
<blockquote>
<p>Intersections and tangency between two or more shapes are preserved during an inversion</p>
</blockquote>
<p>This is great for us, as then if we can find an inversion that turns our non-concentric circles into concentric circles, we can then use the fact that our tangents of the chain circles are preserved and use the obvious concentric circles case to close out the theorem. It may sound complicated, but think of it as a way to work backwards: if we can show we can turn any non-concentric circles into concentric ones, then the reverse is also true where there is some corresponding pair of concentric circles that invert to our original, non-concentric ones. Since the rules of tangency remain true between inversions, the rules for our circle chains remain as well (since they are only governed by tangents).</p>
<p>To find our desired circle of inversion, I&#39;ll present it as a series of steps that might not make sense immediately, but will definitely make sense retroactively. So, for now, I ask that you follow along with the steps and we&#39;ll discuss it at the end.</p>
<h3 id="step-1-find-the-radical-axis">Step 1: Find the radical axis</h3>
<p>The <strong>radical axis</strong> of a pair of circles is the line (or axis, I guess) that every point $P$ along the line is the same distance away from the <em>tangents</em> of the two circles. This sounds more complicated than it is and is much easier to see with a picture. Fortunately, it&#39;s not too hard to find <a href="https://www.cut-the-knot.org/Curriculum/Geometry/GeoGebra/RadicalAxes.shtml">with some simple geometry</a>. We&#39;ll draw the radical axis in green.</p>
<div id="radicalAxis" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>Although we can drag the green point anywhere, it always allows us to find an purple orthogonal circle.</p>
</center>


<p>Of course, the point $P$ in question has to be <em>outside</em> the two circles to be able to find tangents, but that&#39;s only a worry for intersecting circles (which we don&#39;t care about). I drew a purple circle center around $P$ to show that the tangents are in fact equal in length. This purple circle, however, has one notable property due to the 4 tangent lines it has as its radii: it is <strong>orthogonal</strong> to the red and blue circles, meaning that it intersects the red and blue circles at right angles. This is a result from the fact that <a href="https://en.wikipedia.org/wiki/Tangent_lines_to_circles#:~:text=The%20radius%20of%20a%20circle,the%20axis%20of%20the%20radius.">a circle&#39;s radius is perpendicular to its tangent</a>. Hold up a corner of a piece of paper and you&#39;ll see the right angles clearly. Speaking of orthogonal circles, that brings us to our next step.</p>
<h3 id="step-2-draw-two-orthogonal-circles-and-find-their-intersection">Step 2: Draw two orthogonal circles and find their intersection</h3>
<p>This step is easy enough since we&#39;ve basically already done half of it. We just need to draw another purple orthogonal circle as we&#39;ve done before, and then find their intersection. Our space will start to get cluttered quickly, so I&#39;ll remove the purple tangency lines, but just know that those are what determine our purple circles. We&#39;ll draw this intersection point in black.</p>
<div id="intersection" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>For any pair of red and blue circles, their orthogonal circles always intersect in the same two locations.</p>
</center>


<p>Here I&#39;ve selected the outermost intersection for clarity, but we&#39;ll see in just a second that either of the two intersections work just fine. First, it&#39;s worth noting that for a given configuration of outer blue and inner red bounding circles, the intersection points remain constant. No matter how you may slide those green points, the intersection point doesn&#39;t change. That should help cue you into its importance. </p>
<p>As a separate, interesting fact (that I haven&#39;t looked into enough), the centers of the red and blue circles are collinear with the two intersection points of the purple circles. Quirk aside, though, we can move onto the third and final step of this inversion circle finding process.</p>
<h3 id="step-3-draw-any-circle-at-the-chosen-intersection-point">Step 3: Draw any circle at the chosen intersection point</h3>
<p>Notice how I said &quot;any&quot; circle. A circle with any radius will suffice as our desired circle. This will be our circle to invert over! We&#39;re going to invert a total of four circles: of course, the red and blue ones, but we&#39;ll also invert the two helper, purple circles. The diagram might look a bit busy, but just remember that this building off the same diagrams from before; look for what&#39;s new in the graphic, and it will be less overwhelming.</p>
<div id="concentricInversion" style="flex: 2; position: relative;"></div>

<center style="color: #666;">
<p>Finally, we are able to invert our red and blue circles into concentric ones based on the black intersection point.</p>
</center>


<p>And just like that, we&#39;ve obtained our concentric circles just as we desired! Just to reiterate, because tangencies are preserved through our inversion, we can then draw our chain of tangent circles in the original blue and red bounding circles and know for a fact that they&#39;ll remain tangent after our inversion as well. Moreover, since the inversion turns our circles into concentric ones which is the nice symmetric case from before, Steiner&#39;s Porism is nicely proved as we know, once again, tangencies are preserved during an inversion.</p>
<h2 id="analysis">Analysis</h2>
<p>Ok, but why does this even work? I mean, yeah, it produces concentric circles, but our steps seemed so arbitrary. Why should it work? It has to do with our purple orthogonal circles. Remember, these circles are orthogonal meaning that they intersect our blue and red circles at right angles. Moreover, remember that by definition of our construction in <strong>Step 2</strong>, these orthogonal circles pass through the center of our black inversion circle. As we saw before, a circle passing through the center of the inversion circle means that these purple circles will invert into circles of infinitely-large radii (or lines, if you prefer). Lastly, we also know that, in addition to tangencies, intersections are preserved during an inversion. So, not only do we know that our inverted purple lines must intersect, but the intersections between the red and blue circles as well as the purple circles are also maintained. </p>
<p>So, we have two lines that intersect that need to be orthogonal to two other circles. What configuration allows this? The only way that a pair of lines can be orthogonal to a circle is if those lines are the radial line of the circle! So, both circles must share the same center of the intersection of the lines which ensure the lines become radial, and by definition of sharing a center, they must be concentric! Isn&#39;t that neat?</p>
<p>Also, this explains why our black intersection points of the orthogonal circles are invariant: regardless of what pair of orthogonal circles we use, there is precisely one center of inversion that maps both circles to have the same center (two, technically, but that just flips what circle is on the outside).</p>
<p>One thing worth noting, though, is that we get a solution even when the two circles are <em>not</em> contained within one another. If the two circles are non-intersecting and are completely separated from one another, we can still follow our procedure from before: we can find a radical axis of the two circles, which leads to our two purple orthogonal circles, that finally intersect at the center of our inversion circle. However, we now get a reversed solution with the red circle becoming the outer concentric circle instead of the inner one (this only happens as a result of the choice of intersection point of our orthogonal circles).</p>
<h2 id="conclusion">Conclusion</h2>
<p>Inversive geometry has all sorts of interesting quirks and facts to explore, and should be more well known than what it is. Maybe one day I&#39;ll touch on its connection to <a href="https://en.wikipedia.org/wiki/Inverse_curve">polar curves</a>. But anyways, this post wouldn&#39;t be complete if you couldn&#39;t build a Steiner chain of circles of your own, so below there is one last widget to experiment with tangent circles. I have left the special black inversion circle on the canvas just so you can see how all of our work to get concentric circles relates to any pair of nested, bounding circles. There&#39;s so much I had to gloss over to keep this short, such as the hidden conics in the path of the tangent circles, so I highly recommend skimming other articles such as <a href="https://mathworld.wolfram.com/SteinerChain.html">Wolfram MathWorld&#39;s</a> and even <a href="https://en.wikipedia.org/wiki/Steiner_chain">Wikipedia&#39;s</a> discussions on Steiner chains. With all things in math, this story is never over: Steiner&#39;s Porism has a projective geometry cousin known as <a href="http://olivernash.org/2018/07/08/poring-over-poncelet/index.html">Poncelet&#39;s Porism</a>, but that deserves its own post entirely some day. Inversive geometry is a simple yet powerful tool, and even just knowing the concept alone is useful to keep in your back pocket as you never know when you may come across <a href="https://en.wikipedia.org/wiki/M%C3%B6bius_transformation">something that has an uncanny resemblence to it</a>. Nevertheless, I hope you can at least leave this page with not just an appreciation of a cool bit of math, but a nice animation as well. As before, don&#39;t forget to try separating the circles to be outside of one another to get some strange, but special solutions to Steiner&#39;s Porism (if you&#39;re having trouble seeing the animation clearly, try reducing the radius of the black inversion circle).</p>
<div id="steinersComplete" style="flex: 2; position: relative;"></div>


<script src="/js/steiners/hook.js"></script>
<script src="/js/steiners/inversionIntro.js"></script>
<script src="/js/steiners/invertingCirclesFast.js"></script>
<script src="/js/steiners/concentricVariableSteinerChain.js"></script>
<script src="/js/steiners/radicalAxis.js"></script>
<script src="/js/steiners/intersection.js"></script>
<script src="/js/steiners/concentricInversion.js"></script>
<script src="/js/steiners/steinersComplete.js"></script>]]></description>
         <link>http://xperimex.github.io/blog/steiners-porism</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/steiners-porism</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Rotating Regulars and Greedy Grids]]></title>
         <description><![CDATA[Why grids love squares so much 

 <script src='https://cdnjs.cloudflare.com/ajax/libs/g9/1.0.16/g9.js'></script>
<script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>

<p>We are all familiar with the idea of a grid. From making up the small pixels on our screen, to the compact city maps of New York, grids pop up everywhere due to the kind nature of the innate squares built into them; grids are extremely space efficient packing in squares above and below each other while still maintaining a sense of order. But, why do we grids love squares so much? Today, we&#39;ll look at a nice proof for why the square is the only regular polygon that can fit in a grid. </p>
<h2 id="tilted-thoughts-and-grid-properties">Tilted Thoughts and Grid Properties</h2>
<p>First, let&#39;s define what a grid is for us. A <strong>grid</strong> is a set of lattice points whose cardinal neighbors (up, down, left, right) are all equidistant from the given point. That&#39;s a lot more complicated than it sounds, but all you need to think of is a generic, <strong>square grid</strong> like you would find on a piece of graph paper.</p>
<!-- <div id="grid_example" style="flex: 2; position: relative;"></div>
<script src="/js/grid-polygons/grid_example.js"></script> -->
<p>No need to worry about any triangular or hexagonal grids (thank you organic chemistry). Obviously, squares fit in our grid, but how can any other regular polygon possibly fit? Well, remember, we don&#39;t necessarily need to only draw horizontal or vertical lines: we can easily draw tilted squares too.</p>
<p><div id="tilted_squares" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/tilted_squares.js"></script>

<p>Now that you know about tilted squares, here&#39;s nice puzzle to think about: given an $n \times n$ square grid, how many different squares can you draw? Check the <a href="#solution-to-squares-in-a-grid-puzzle">footnote</a> below if you want a solution, but just drawing it out will likely give you the intuition you need. Anyways, this tilted square reveals an important property of grids: rotating a lattice point by 90° around another point gives you a new, different lattice point. You can see this nicely with complex numbers. If you have a lattice point $a+bi$, a 90° rotation is equivalent to multiplying our number by $i\rightarrow i \cdot (a+bi) = -b + ai$. The coefficients remain integers, so if $(a,b)$ is a point, so is $(-b,a)$. </p>
<p>Another (less relevant for us) property is that if you know a line segment defined by 2 lattice points, and you are given a 3rd lattice point, you can find a 4th one by drawing a second line segment from your 3rd point (think of it like vector addition: if we know a vector and a point, we can find a new point by adding that vector the point). For the purpose of this post, though, just remember the former property.</p>
<h2 id="rotating-regular-polygons">Rotating Regular Polygons</h2>
<p>The proof that only regular polygon that a grid can define is a square is very simple, but very clever. Just as an example, we&#39;ll use a pentagon for demonstrative purposes. Let&#39;s assume that our regular $p$-gon (in our case, pentagon; I use $p$-gon due to poor variable naming later) exists in the grid.</p>
<p><div id="pentagon" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/pentagon.js"></script>

<p>If these 5 points that define our pentagon exists in the grid, then we should be able to generate 5 new, totally valid grid points by rotating them 90° around their neighbor.</p>
<p><div id="pentagon_rotate" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/pentagon_rotate.js"></script>

<p>Notice, though, that we just made another, smaller regular pentagon! ...Or did we? We can prove this quite simply geometrically (trust me, drawing it out and symmetry will guide you all the way through), but I don&#39;t want to draw anything right now so instead I&#39;ll show you a much more needlessly complicated, linear algebra approach to it (this will, though, give us specific numbers at the end of it). If you can accept this red pentagon is in fact a regular pentagon, just <a href="#skip">skip ahead</a>, but for now I&#39;ll present the proof. </p>
<p>If we can show that the new red pentagon lies on a parametric circle, we can then show that we our 5 angles to generate the original, black pentagon, maps to the new red pentagon. The way we generated our red pentagon was by taking a black point $v$, rotating it around its neighbor $t$ by 90° to land at $v&#39;$ as seen above. We can write this transformation as a product of 3 matrices: translating by $-t$, rotating 90°, then translating back by $+t$ (in a linear transformation, the origin remains fixed so the translations are our way to rotate about any point we want). If $v$ is a point of the form $(\cos\frac{2\pi n}{5}, \sin\frac{2\pi n}{5})$, then $t$ is the point $(\cos\frac{2\pi (n-1)}{5}, \sin\frac{2\pi (n-1)}{5})$ just as definition of being a pentagon on the unit circle, and $v$ and $t$ being neighboring points. So, our matrix equation of going from $v\rightarrow v&#39;$ is</p>
<center>
$
\begin{bmatrix}
1 &amp; 0 &amp; \cos\frac{2\pi (n-1)}{5} \\
0 &amp; 1 &amp; \sin\frac{2\pi (n-1)}{5} \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
0 &amp; -1 &amp; 0 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
1 &amp; 0 &amp; -\cos\frac{2\pi (n-1)}{5} \\
0 &amp; 1 &amp; -\sin\frac{2\pi (n-1)}{5} \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\cos\frac{2\pi n}{5} \\
\sin\frac{2\pi n}{5} \\
1
\end{bmatrix}
= v&#39;
$
</br></br>
$
\begin{bmatrix}
0 &amp; -1 &amp; \sin\frac{2\pi (n-1)}{5} + \cos\frac{2\pi (n-1)}{5}  \\
1 &amp; 0 &amp; \sin\frac{2\pi (n-1)}{5} - \cos\frac{2\pi (n-1)}{5} \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\cos\frac{2\pi n}{5} \\
\sin\frac{2\pi n}{5} \\
1
\end{bmatrix}
= v&#39;
$
</center>

<hr>

<p>Before we really dig into the matrix computations, take a look at the final column of that last matrix: it has something that looks like $\sin(x) + \cos(x)$ and $\sin(x) - \cos(x)$. These seem too nice not to have a formula for this sum and difference. So, before we go on, it will be worthwhile to see if we can condense those into nicer formulas. In fact, when you plot these functions, you do get what looks like nice sine waves.</p>
<p>Let&#39;s say we think it is some type of cosine curve.</p>
<center>
$\sin(x) + \cos(x) = A\cos(x + \phi)$
</center>

<p>$A$ is the amplitude of this new curve, and $\phi$ is the phase offset. Now, we fortunately have a well known angle addition formula for cosine.</p>
<center>
$\color{red}{1}\sin(x) + \color{red}{1}\cos(x) = A\cos(x + \phi) = \color{red}{A\cos(\phi)}\cos(x) \color{red}{-A\sin(\phi)}\sin(x)$
</center>

<p>This may seem hard to solve, but all we need to do now is match our coefficients (highlighted in <span style="color:red">red</span>). For the right hand side to equal the left hand side</p>
<center>
$A\cos(\phi) = 1$
<br>
$-A\sin(\phi) = 1$
</center>

<p>That way the $\cos(x)$ and $\sin(x)$ terms will be equal on either side. We can now square both equations and add them together to get</p>
<center>
$
\begin{array}{cccc}
  &amp; (A\cos(\phi))^2 &amp; = &amp; 1^2 \\
+ &amp; (-A\sin(\phi))^2 &amp; = &amp; 1^2 \\ \hline
  &amp; A^2(\cos^2(\phi) + \sin^2(\phi)) &amp; = &amp; 2
\end{array}
$
</center>

<p>Remembering that $\cos^2(\phi) + \sin^2(\phi) = 1$, we get that $A = \sqrt{2}$. Now we can solve for $\phi$ fairly quickly, too. Though, we&#39;ll have to be careful about range restrictions on $\cos^{-1}(x)$ and $\sin^{-1}(x)$, so we should corroborate them to make sure we get a value that satisfies both equations.</p>
<center>
$\begin{align}
A\cos(\phi) = 1 &amp; \rightarrow \phi = \frac{\pi}{4}, \color{red}{-\frac{\pi}{4}} \
\newline
-A\sin(\phi) = 1 &amp; \rightarrow \phi = \color{red}{-\frac{\pi}{4}}, \frac{5\pi}{4}
\end{align}$
</center>

<p>The only (reduced) angle that is satisfies both equations is $\phi = -\frac{\pi}{4}$. Putting it all together now, we can see that</p>
<center>
$\sin(x) + \cos(x) = \sqrt{2} \cos(x - \frac{\pi}{4})$
</center>

<p>In a similar manner,</p>
<center>
$\sin(x) - \cos(x) = \sqrt{2} \cos(x - \frac{3\pi}{4})$
</center>

<p>but we can make this more akin to our previous equation recalling that $\cos(x) = \sin(\frac{\pi}{2} - x)$.</p>
<center>
$\sin(x) - \cos(x) = \sqrt{2} \sin(\frac{\pi}{2} - (x - \frac{3\pi}{4})) = \sqrt{2} \sin(-x + \frac{5\pi}{4}) = \sqrt{2} \sin(x - \frac{\pi}{4})$
</center>

<p>Working with one term instead of the sum of two will make our life easier moving forward.</p>
<hr>

<center>
$
\begin{bmatrix}
0 &amp; -1 &amp; \sqrt{2}\cos(\frac{2\pi (n-1)}{5} - \frac{\pi}{4})  \\
1 &amp; 0 &amp; \sqrt{2}\sin(\frac{2\pi (n-1)}{5} - \frac{\pi}{4}) \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\cos\frac{2\pi n}{5} \\
\sin\frac{2\pi n}{5} \\
1
\end{bmatrix}
= v&#39;
$
</center>

<p>Unfortunately, this transformation matrix alone can&#39;t show us our net tranform is purely a rotation and scaling due to that third column (which indicates a translation). So, we will have to look at the individual components of $v&#39;$.</p>
<center>
$
\begin{bmatrix}
0 &amp; -1 &amp; \sqrt{2}\cos(\frac{2\pi (n-1)}{5} - \frac{\pi}{4})  \\
1 &amp; 0 &amp; \sqrt{2}\sin(\frac{2\pi (n-1)}{5} - \frac{\pi}{4}) \\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\cos\frac{2\pi n}{5} \\
\sin\frac{2\pi n}{5} \\
1
\end{bmatrix}
= v&#39;
$
</br></br>
$
\begin{bmatrix}
-\sin\frac{2\pi n}{5} + \sqrt{2}\cos(\frac{2\pi (n-1)}{5} - \frac{\pi}{4}) \\
\cos\frac{2\pi n}{5} + \sqrt{2}\sin(\frac{2\pi (n-1)}{5} - \frac{\pi}{4}) \\
1
\end{bmatrix}
= v&#39;
$
</center>

<p>If $v&#39;$ truly is just a rotated and scaled version of a vertex of our original pentagon, then it follows that any $v&#39;$ should lie on a circle, just as $v$ does. So, we can use the Pythagorean identity that $(r\cos\theta)^2 + (r\sin\theta)^2 = r^2$ which implies that if we square the $x$ and $y$ components of $v&#39;$ and add them together, we should get a constant. For simplicity in writing, we&#39;ll use $\alpha = \frac{2\pi (n-1)}{5} - \frac{\pi}{4}$.</p>
<center>
$
(-\sin\frac{2\pi n}{5} + \sqrt{2}\cos \alpha)^2 + (\cos\frac{2\pi n}{5} + \sqrt{2}\sin \alpha)^2 =
$
</br>
$
\cos^2 \frac{2\pi n}{5} + \sin^2 \frac{2\pi n}{5} + 2\cos^2 \alpha + 2\sin^2 \alpha + 2\sqrt{2}(\cos\frac{2\pi n}{5}\sin \alpha - \sin\frac{2\pi n}{5}\cos \alpha)
$
</center>

<p>This may look like a pain to work with, but just grouping like terms and trigonometric identities clean this up real fast.</p>
<center>
$\begin{align}
1 + 2 + 2\sqrt{2}\sin(\alpha - \frac{2\pi n}{5}) &amp; = \
\newline
3 + 2\sqrt{2}\sin(-\frac{2\pi}{5} - \frac{\pi}{4}) &amp; = \
\newline
3 - 2\sqrt{2}\sin(\frac{2\pi}{5} + \frac{\pi}{4}) &amp; \approx 0.479852979
\end{align}$
</center>

<p>So it does simplify to a constant! This constant represents the radius$^2$ of the new circle the red pentagon lies on (based on the black pentagon&#39;s unit circle). Meaning, the radius of the circle the red pentagon lies on is $\sqrt{0.479852979} \approx 0.692714211$. To find the angle it is rotated by, we just find how far the first vertex ($n=0$) is rotated:</p>
<center>
$\theta = \tan^{-1}(\frac{y}{x}) = \tan^{-1}(\frac{1 - \sqrt{2}\sin(\frac{2\pi}{5} + \frac{\pi}{4})}{\sqrt{2}\cos(\frac{2\pi}{5} + \frac{\pi}{4})}) + \pi \approx 3.526465492$
</center>

<p>What&#39;s great about our linear algebra approach too is that it quickly generalizes for any regular $p$-gon! The only part of the result impacted by our choice of a pentagon is any appearance of $\frac{2\pi}{5}$. So if you wanted to do it for any regular $p$-gon, all you do is replace $\frac{2\pi}{5}$ with $\frac{2\pi}{p}$.</p>
<div id="skip">


<hr>
<p>To get back to the original point though, we have shown that a vertex $v$ on the unit circle under our specific transformation maps to a vertex $v&#39;$ on a scaled, rotated circle (and because it was all linear transformations, the scalings and rotations are uniform around the origin), which implies that our black pentagon maps to another regular pentagon in red. Since those vertices in red are valid points in the grid since we found them with 90° rotations of other, valid lattice points, we can find yet <em>another</em> set of 5 valid lattice points by doing the same operation again of rotating each vertex 90° around its neighbor.</p>
<p><div id="pentagon_rotate2" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/pentagon_rotate2.js"></script>

<p>With our previous logic, we know that this too is a regular pentagon, which again, allows us to find 5 <em>new</em> lattice points in our grid by doing the same operation of rotating around a neighbor by 90°... And again... And again... For as many new lattice points and pentagons as we want.</p>
<p><div id="pentagon_rotateF" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/pentagon_rotateF.js"></script>
<center style="color: #666;">
<p>Here are 15 nested pentagons; try dragging any of the vertices to zoom in and you can see they are just smaller, rotated regular pentagons.</p>
</center>

Ok, but why do we care? Remember, our grid is made up of a set of discrete points with some distance between each point. But, since we can always find 5 new lattice points that make a pentagon as small as we want by repeating the 90° rotation, that means that we can find a pentagon who's radius/sides are <i>smaller</i> than our grid point distances themselves. How do you draw a pentagon smaller than the space between points itself? It would be like trying to draw between the pixels of the screen you're reading this on, which is obviously impossible. So by contradiction, our initial assumption that a pentagon can exist in the grid must have been false. $\blacksquare$

While that shows it's impossible to have a pentagon in the grid, we still want to show that <i>only</i> the square can exist in the grid. Recall our formula for the radius of the bounding circle of our pentagon (if you skipped ahead originally go back to see where this comes from):

<center>
$r(p) = \sqrt{3 - 2\sqrt{2}\sin(\frac{2\pi}{p} + \frac{\pi}{4})}$
</center>

Since we were working with the example of a pentagon, originally $p=5$ for us. The reason why our pentagons kept shrinking is because $r < 1$ for $p=5$. We need to show all regular polygons except the square results in a shrinking radius. In other words, we need to show that $r<1$ for all $p>4$. First, let's note the value of $p=4$ to start:

<center>
$\begin{align}
r(4) & = \sqrt{3 - 2\sqrt{2}\sin(\frac{2\pi}{4} + \frac{\pi}{4})} \\
<!-- \newline -->
& = \sqrt{3 - 2\sqrt{2}\cdot\frac{\sqrt{2}}{2}} \\
<!-- \newline -->
& = \sqrt{3 - 2} \\
<!-- \newline -->
& = 1
\end{align}$
</center>

This is why the square works out as it never shrinks as a 90° rotation around neighbors just maps one vertex to another already existing one. Now, let's examine the term $\sin(\frac{2\pi}{p} + \frac{\pi}{4})$. As $p$ gets larger than 4, the angle we're taking the $\sin$ of is not only bounded to quadrant 1, but is also getting smaller and closer to $\frac{\pi}{4}$, but never quite equal. This results in a $\sin$ value slightly larger than $\frac{\sqrt{2}}{2}$, which makes the difference $3-2\sqrt{2}\sin(\frac{2\pi}{p} + \frac{\pi}{4}) < 1$. Here's the graph of $r(p)$ as well as the bound of $r=1$.

</br></br>
<img src="/img/grid-polygons/regPolygonVRad2.png">
</br>

Some might look at this graph and see an obvious flaw: what about the case of the equilateral triangle though ($p=3$)? Yes, technically it has an $r>1$ and this does actually result in it expanding out.

<div id="triangle_rotate" style="flex: 2; position: relative;"></div>
<script src="/js/grid-polygons/triangle_rotate.js"></script>

<p>If the points expand out, we can&#39;t really say much about it existing in the grid or not since we only have a minimum bound on the distance between lattice points. But, there was a second property I glossed over regarding grids:</p>
<blockquote>
<p>If you know a line segment defined by 2 lattice points, and you are given a 3rd lattice point, you can find a 4th one by drawing a second line segment from your 3rd point.</p>
</blockquote>
<p>This property allows the equilateral triangle to be turned into the equivalent case of a hexagon, leading it to a case where $p&gt;4$ and hence an $r&lt;1$, indicating that an equilateral triangle, too, is impossible to draw within the grid.</p>
<p>Another neat little fact is the bend at $p=8$; an octagon has the smallest bounding radius for the 90° neighbor rotations (since that makes the $\sin$ term go to 1). But after that, $r(p)$ starts to increase. How can we know it won&#39;t equal or exceed 1? Well, no matter how big $p$ is, $\frac{2\pi}{p} + \frac{\pi}{4}$ will always be greater than $\frac{\pi}{4}$. Just thinking about it though leads to an interesting thought: what about at the limit of $p\to\infty$?</p>
<center>
$\lim\limits_{p\to\infty} \sin(\frac{2\pi}{p} + \frac{\pi}{4}) = \sin(0 + \frac{\pi}{4}) = \frac{\sqrt{2}}{2}$
</center>

<p>Which as we saw, would lead to an $r$ value of 1. So, according to this limit, an infinite sided $p$-gon, better known as the circle, is possible... <em>at the limit</em>. You&#39;ll get better and better approximations of the circle the more sides you add, but this essentially turns our grid into lattice points that are infinitely close together, which ruins the point of the grid in my opinion. So, it&#39;s up to you if you think a circle can exist in a grid, but an interesting thought nonetheless.</p>
<h2 id="other-grids-">Other Grids?</h2>
<p>Earlier I mentioned that we did&#39;t need to worry about triangular or hexagonal grids, but what if we did?</p>
<p><div id="trihex_grid" style="flex: 2; position: relative;"></div></p>
<p><script src="/js/grid-polygons/trihex_grid.js"></script></p>
<center style="color: #666;">
<p>The triangular (left) and hexagonal (right) grids are less obvious for what other regular polygons they can fit.</p>
</center>

<p>Fortunately, this just requires tweaking our matrix equation from before a little bit: instead of rotating by 90°, we now rotate by 60° and 120° for the triangular and hexagonal grids respectively. In general, if we want to rotate by $\theta$ radians (easy conversion from degrees) around a neighboring point for a regular $p$-gon, the vector for $v&#39;$ in terms of $v$ is </p>
<center>
$
\begin{bmatrix}
x \\
y \\
1
\end{bmatrix}
=
\begin{bmatrix}
\cos(\theta + \frac{2\pi n}{p}) + 2\sin(\frac{2\pi (n-1)}{p} + \frac{\theta}{2})\sin(\frac{\theta}{2}) \\
\sin(\theta + \frac{2\pi n}{p}) - 2\cos(\frac{2\pi (n-1)}{p} + \frac{\theta}{2})\sin(\frac{\theta}{2}) \\
1
\end{bmatrix}
= v&#39;
$
</center>

<p>Finding $r=\sqrt{x^2 + y^2}$ again reveals that</p>
<!-- Thanks WolframAlpha: https://www.wolframalpha.com/input/?i=%28cos%28theta+%2B+2pi*n%2Fp%29+%2B+2sin%282pi%28n-1%29%2Fp+%2B+theta%2F2%29sin%28theta%2F2%29%29%5E2+%2B+%28sin%28theta+%2B+2pi*n%2Fp%29+-+2cos%282pi%28n-1%29%2Fp+%2B+theta%2F2%29sin%28theta%2F2%29%29%5E2 -->
<center>
$r_\theta (p) = \sqrt{3+2\cos(\theta + \frac{2\pi}{p}) - 2\cos(\theta) - 2\cos(\frac{2\pi}{p})}$
</center>

<p>...which is in fact a constant. So rotations of <i>any</i> angle around neighboring points output more regular polygons. </p>
<p><div id="pentagon_rotate_angle" style="flex: 2; position: relative;"></div></p>
<p><script src="/js/grid-polygons/pentagon_rotate_angle.js"></script></p>
<center style="color: #666;">
<p>Try rotating one of the red dots to watch the regular pentagon grow and shrink according to the angle you rotate around its neighbor.</p>
</center>

<p>As before, we can plot this function to see what regular polygons have a bounding radius less than one for each grid:</p>
<!-- </br></br> -->
<p><img src="/img/grid-polygons/hexTriCompare2.png">
<!-- </br> --></p>
<p>Even though it would appear that no hexagons can be made in the triangular grid as they have a bounding radius $r_{\frac{\pi}{3}}(6)=0$. However, the point they actually collapse into is valid vertex of the triangular grid. This is because that&#39;s a type of definition of the triangular grid: draw a hexagonal grid and place extra points in the center of each hexagon. So again, the only apparent shapes in that can be contained in the triangular and hexagonal grids unfortunately appear to be none other than just the equilateral triangle and regular hexagon themselves.</p>
<hr>
<p>This post was inspired by a Mathologer video discussing an application of <a href="https://youtu.be/sDfzCIWpS7Q">shrinking polygons</a> and this out-of-the-box thinking that is so cool. Part way through the video, he glosses over the reasoning behind why the shrinking polygons are similar, so this is my own take on that portion of the video.</p>
<h3 id="solution-to-squares-in-a-grid-puzzle">Solution to squares in a grid puzzle</h3>
<p>As I said, drawing it out is your best bet. Let&#39;s start with how many $1 \times 1$ squares there can be in an $n \times n$ grid. Well, it&#39;s just $(n-1)^2$ by definition of the size of the grid (remember, $n$ refers to the number of dots, so there are only $(n-1) \times (n-1)$ squares). How about $2 \times 2$ squares? Well, we have eliminated a possible row and column from which we can place the square, so there are $(n-2)^2$ total $2 \times 2$ squares. You might be tempted to say that there are $\sum_{i=1}^{n-1} (n-i)^2$ total squares (where we are individually counting every $i\times i$ square up to $n-1$), but you can&#39;t forget that there are tilted squares too. The trick here is now that you have all the non-tilted squares, you just need to find how many possible tilted squares can be contained in a non-tilted square. In a $1 \times 1$ square, there is no room to tilt a square in it, so we move on. In a $2 \times 2$ square, there is exactly one extra lattice point to tilt on, so we add a factor of $2$ to our count of $2\times 2$ squares $\rightarrow 2(n-2)^2$. Similarly for a the $3 \times 3$ squares, we have 2 new lattice points we can tilt to, tripling our count $\rightarrow 3(n-3)^2$ squares. So finally, we can write it as a final sum of $\sum_{i=1}^{n-1} i(n-i)^2 = \frac{1}{12}(n^2)(n^2-1)$ total squares for an $n \times n$ grid.</p>
]]></description>
         <link>http://xperimex.github.io/blog/grid-polygons</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/grid-polygons</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Quarantine Quandaries and Variable Vaccines]]></title>
         <description><![CDATA[Modelling the past 17 months in 17 minutes 

 <script src='https://cdnjs.cloudflare.com/ajax/libs/g9/1.0.16/g9.js'></script>
<script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>

<p>COVID-19 is one of those events that will likely not just define the way people will interact with each other, but likely entire socieities. I wouldn&#39;t even be surprised to see this pop up in an AP US History textbook in a decade just for how long the pandemic has been drawn out for. So it should be no surprise that from the first month of the pandemic, a vaccine was the only thing on people&#39;s minds. I mean, just look at this graph depicting the number of total coronavirus cases in the U.S. <em>alone</em>.</p>
<p><img src="/img/quarantine-quandaries/us-state-trends.png"></p>
<center style="color: #666;">
<p>Data as reported by the <a href="https://covid.cdc.gov/covid-data-tracker/#trends_dailytrendscases">CDC</a> (updated as of July 15th)</p>
</center>

<p>It took around 2 months to hit a million cases in the U.S., and another 3 months to reach 5 million cases. That&#39;s the issue with pandemics: they explode at a rate faster than we can realize. So, today, I want to talk a little bit about different types of disease models, and how these can educate ourselves on the right preventative courses of action.</p>
<h2 id="the-sir-model-2-ways">The SIR Model 2 Ways</h2>
<p>The <strong>S</strong>usceptible <strong>I</strong>nfected <strong>R</strong>ecovered Model of disease spread groups individuals into 3 boxes and relates them to show how each box grows or diminishes over time: susceptible means that you are currently healthy but are vulnerable to the infection; infected means just that and indicates a current illness; and while recovered doesn&#39;t necessarily mean you overcame the disease, it means you are unable to spread the disease anymore (sobeit proper recovery and developed immunity, but also the unfortunate case if you die since both are no longer disease vectors). This sounds like the perfect use for a Markov chain (here&#39;s a <a href="http://xperimex.com/blog/metropolis-hastings/#markov-chains">refresher if you need one</a>)! Our Markov chain will have 3 states being the aforementioned susceptible, infected, and recovered, and will follow a transition model as such:</p>
<p><img src="/img/quarantine-quandaries/markovSIR2.png"></p>
<center style="color: #666;">
<p>The SIR Markov chain model</p>
</center>

<p>Let&#39;s say everyone starts out as susceptible; we can write our initial population as $N$, and the initial distribution of those $N$ people as $P = \begin{bmatrix} N &amp; 0 &amp; 0 \end{bmatrix}$ for $N$ susceptible, 0 infected, and 0 recovered.</p>
<p>With that out of the way, let&#39;s think about the above Markov chain. If you are currently susceptible, each day there&#39;s a chance you might become infected. Let&#39;s call this probability $\beta$ as the average chance of getting infected. At the same time though, if you are smart and act carefully, you might not become infected, and this will be $1-\beta$. Similarly if you&#39;re infected, there&#39;s a chance you might (positively or otherwise) overcome the disease! We&#39;ll call this probability $\gamma$, and the chance of not recovering $1-\gamma$ (you can think of $\gamma$ by taking its inverse: $\frac{1}{\gamma}$ is the average number of days for a recovery to occur). Finally, if you&#39;re recovered, that&#39;s the end of your journey, as once recovered you&#39;re always recovered. This can be condensed into the simple transition matrix below.</p>
<center>
$
M = 
\begin{bmatrix}
1-\beta &amp; \beta &amp; 0 \\
0 &amp; 1-\gamma &amp; \gamma \\
0 &amp; 0 &amp; 1
\end{bmatrix}
$
</center>

<p>With that, let&#39;s run a trial with infectivity $\beta=.4$ and $\gamma=\frac{1}{5}$ (we expect an infection to take 5 days to recover). So on Day 0, everyone is healthy and (ironically) susceptible to our disease. The following Day 1, people are interacting and enjoying themselves, unbeknown to them that they are spreading a new contagion. Day 1 results in $PM = \begin{bmatrix} 800 &amp; 200 &amp; 0 \end{bmatrix}$, which makes sense as we expected 20% to become infected. We can track each state of S, I, and R and plot them accordingly across the span of a month.</p>
<p><img src="/img/quarantine-quandaries/SIRMarkov.png"></p>
<center style="color: #666;">
<p>Evolution of the SIR Markov chain as percent of the population</p>
</center>

<p>For such a simple model, it&#39;s not bad, but there are some obvious flaws. For starters, the infected population doesn&#39;t really infect others; all infections stem from random appearances in the susceptible population. This is why by the end of the 30 days, we have 0 susceptible and only recovered, since infections don&#39;t require infected to be present which is kind of odd (notice how our initial population was <em>only</em> susceptible and yet infected pop up). We can do better.</p>
<p>While Markov chains were appealing due to the nature of having 3 states, what we really want to focus on is the relationships between the 3 states: if there are lots of infected people, that should increase the rate at which others get infected. Since we&#39;re looking at how the value of one box (infected people) affect the rate at which the other boxes change (how fast susceptible and recovery decrease/increase), perhaps we should try a system of differential equations. Instead of states, we&#39;ll now have 3 different functions: $S(t)$, $I(t)$, and $R(t)$, which returns the number of susceptible, infected, and recovered at a time $t$. If you&#39;re not familiar with differential equations, don&#39;t worry, this section will be brief. The idea behind differential equations is that sometimes it&#39;s hard to exactly quantify a function or value, but we know how the function <em>changes</em> relative to another value. See the first few minutes of this <a href="https://youtu.be/p_di4Zn4wz4">video</a> if this idea intrigues you and for some nice opening examples. Besides, you already know more or less what the equations look like we know what the function should look like.</p>
<center>
$
\begin{align}
\frac{dS}{dt} &amp; = -\textrm{Number of new infections} \
\newline
\frac{dI}{dt} &amp; = \textrm{Number of new infections} - \textrm{Number of new recovered} \
\newline
\frac{dR}{dt} &amp; = \textrm{Number of new recovered}
\end{align}
$
</center>

<p>That&#39;s really all there is to them. The specific math behind it looks more complicated than it is, but keeping the above in mind will make it much clearer.</p>
<center>
$
\begin{align}
\frac{dS}{dt} &amp; = -\frac{\beta S}{N} I \
\newline
\frac{dI}{dt} &amp; = \frac{\beta S}{N} I - \gamma I\
\newline
\frac{dR}{dt} &amp; = \gamma I
\end{align}
$
</center>

<p>I like to think of it that of that the fraction of the vulnerable people $\frac{S}{N}$ have a $\beta$ chance of being infected, which is scaled up by the number of infected people $I$. That makes sense for number of new infected people. Similarly, if the average chance of recovery is $\gamma$, then you should expected a proportion of $\gamma$ infected people to recover ($\gamma I$). Last important fact to note is what happens when we add these equations together:</p>
<center>
$\frac{dS}{dt}+\frac{dI}{dt}+\frac{dR}{dt}=0$
</center>

<p>No matter how the 3 different categories of people evolve over time, the net change between all of them will be 0, meaning our total population remains the same over time (which is good since we don&#39;t want people appearing and disappearing out of nowhere). Let&#39;s watch the scenario unfold once more with $N=1000$ with a distribution of $P = \begin{bmatrix} 999 &amp; 1 &amp; 0 \end{bmatrix}$ (<i>someone</i> has to start the pandemic), $\beta=.4$, and $\gamma=\frac{1}{5}$.</p>
<p><img src="/img/quarantine-quandaries/SIRDifferential.png"></p>
<center style="color: #666;">
<p>Evolution of the SIR differential equations as percent of the population</p>
</center>

<p>That&#39;s more like that famous curve. It may not be as drastic as the 10 day everyone-is-infected model as the Markov chain we tried earlier, but it&#39;s definitely much more realistic. A single person was able to infect about 800 people across only a couple of months, which is still scary fast. </p>
<h2 id="-r-and-disease-containment">$R$ and Disease Containment</h2>
<p>Just as famous as a curve this may be, you likely have heard of the idea of $R$ and $R_0$ too. $R$ is the <strong>reproduction number</strong> of a disease/virus that tells you on average, how many people an infected person will spread the disease to. If $R&gt;1$, then you get the epidemic issue, where the disease is spreading exponentially as each person is giving more people than just themselves the disease. When $R=1$, you have an <em>endemic</em> where the disease is neither spreading nor being contained. When $R&lt;1$, then you have a contained virus that is decaying throughout a community. $R_0$ is just the $R$ value at the start of the outbreak, and can be found with the formula $R = \frac{\beta}{\gamma}$. In our simulation, $R_0 = \frac{.4}{.2} = 2$. So if we wanted to contain this disease, we want to find how many infections we need to contain for $R&lt;1$. Since $R_0 \cdot .5 = 1$, we only need to contain 50% of infections to contain the outbreak!</p>
<p><img src="/img/quarantine-quandaries/SIRDifferentialHerd.png"></p>
<p>You can see as soon as there is less than 50% of the population left to infect, infections start to decline—not end, but decline. You can also reduce infectivity by wearing preventative measures (i.e. masks) or getting the appropriate immunization against the disease (i.e. vaccines). If you want to read more about this model and more of its intricacies, Nicky Case wrote a very nice <a href="https://ncase.me/covid-19/">interactive article</a> about it.</p>
<h2 id="small-scale-vaccinations-and-graph-theory">Small Scale Vaccinations and Graph Theory</h2>
<p>While we did find a nice model to represent disease spread, the SIR model only is really nice for analyzing very <em>big</em> communities. With the SIR model, we assume everyone interacts with enough people so that infected people can always target a susceptible person if they need to in this very dense network of people. </p>
<p>Most people, though, only regularly interact and really care about those immediately in their social circles. In this small scale, such as say, a neighborhood or even a friend group, people do <em>not</em> interact with others equally. Some are more introverted and interact with only a few people, and some are extroverted beacons that interact with most of the group. This changes the dynamics of disease spread a lot as obviously those who are more outgoing and meet more people will be more at risk of being infected than someone who only talks to a few people. As such, we&#39;ll need a different approach than the SIR model.</p>
<p>In order to model connections between people we&#39;ll use a <strong>graph</strong>. A graph in this case is not the standard parabola of $f(x) = x^2$, but rather it is a visual tool consisting of two parts: there are <strong>nodes</strong> which are dots (to represent people here), and <strong>edges</strong> that are lines that connect nodes (to represent interactions or friendships).</p>
<p><img src="/img/quarantine-quandaries/exampleGraph (2).png"></p>
<center style="color: #666;">
<p>Example of a graph that may represent the individual friendships in a clique</p>
</center>

<p>As in most groups, we have a couple of people at the center connected to quite a few people, and some on the edge of the circle regularly interacting with as few as 2 people. This is a really helpful representation as now not only can we watch <em>where</em> the virus spreads, but we also have a direct way to implement small scale prevention tactics as we can see specifically who is infected. Ideally, we would vaccinate everyone in this group and make sure (consequential) disease spread can occur, but that might not happen. So, <strong>if we could only vaccinate, say, 25% of this group, who would you vaccinate to minimize a disease vector?</strong> There are some obvious candidates such as the nodes with the most connections, but what is the <em>best</em> way Let&#39;s leave our <span style="color:green">susceptible</span> people in green and <span style="color:red">infected</span> in red, but we&#39;ll add a new purple node to indicate <span style="color:purple">vaccinated</span>.</p>
<p><img src="/img/quarantine-quandaries/exampleVax.png"></p>
<center style="color: #666;">
<p>Randomly vaccinating 5 of the 20 people in the network. Can we do better?</p>
</center>

<p>Before we talk strategies, let&#39;s be clear about some of the assumptions made for simplicity sake.</p>
<ul>
<li>Vaccinations are 100% effective both ways, completely negating the possibility of infection of and transmission from the vaccinated person as if fully immune.</li>
<li>Edge lengths do not matter; if someone is connected to another person, we assume that that edge will act the exact same way as all other interactions and edges. This ensures a contant $\beta$.</li>
<li>Dying and recovering from the disease will be again treated the same under an overarching &quot;Recovered&quot; state, in which the affected person becomes fully immune. </li>
<li>An infected person &quot;recovers&quot; after only a single day ($\gamma = 1$) since a) it will ensure our simulation can spit out some numbers at the end as it&#39;s hard to <em>completely</em> protect an entire network of people, and b) our program wasn&#39;t written the most efficiently. </li>
</ul>
<p>As before, we want to find strategies ways to reduce $R_0$. But, what is $R_0$ in this case? Well, remember $R_0$ is just the average number of transmissions a single infected person will instigate. So, we can approximate this with the average number of edges an infected node has, multiplied by the infectivity. Since we can&#39;t change the infectivity rate ($\beta$), the only way we can lower it is by removing possible edges for infected people to transmit across. So, let&#39;s look at different strategies that are both really good and really bad at removing edges from our graph.</p>
<ol>
<li><span style="color:blue"><strong>Random</strong></span>: Realistically, vaccinating people randomly seems like a bad idea. In a simulation, though, it&#39;s never a bad starting point.</li>
<li><span style="color:orange"><strong>Random then neighbors</strong></span>: Here, we start with a single random person to vaccinate, then only vaccinate people connected to an already vaccinated person. If your friend got vaccinated, why shouldn&#39;t you?</li>
<li><span style="color:teal"><strong>Most connected</strong></span>: This is the obvious solution. If we want to reduce edges efficiently, why don&#39;t we vaccinate the nodes with the most edges connected to the most people?</li>
<li><span style="color:black"><strong>Most connected non-neighbors</strong></span>: This is a spin on the last one. We want to vaccinate the most connected people, but why not spread them out a bit? We pick the highest connected node to vaccinate, and then proceed to vaccinate the next highest node that is not connected to a vaccinated person.</li>
<li><span style="color:pink"><strong>Least connected</strong></span>: This one is more of a why not scenario. It&#39;s like the previous two strategies but reversed: find the loners of the group and vaccinate them.</li>
</ol>
<p>Again, we&#39;ll randomly vaccinate $\approx$25% of our population (50/100, 100/200, 200/400, and 400/800 people/total connections) according to our strategies above. We&#39;ll also infect 10% of our population with the contagion of your choosing with the same infectivity at $\beta = .4$ as before. We&#39;ll do 10 trials per population size, and average them to get a rough estimate at how each strategy faired.</p>
<p><img src="/img/quarantine-quandaries/results (1).png"></p>
<p>Unsurprisingly, vacciating the most connected nodes without restriction faired the best; closing off as many routes of infection as fast as possible led to only about 10% of non-vaccinated people getting infected. Following close behind is most connected non-neighbors strategy. Even though we tried spreading out vaccinations since the edge between two vaccinated people doesn&#39;t require two does of the same vaccine, by nature of being a popular node, it is likely connected to other popular nodes too. So in reality, we are removing fewer edges than we could be just vaccinating the most popular nodes. It&#39;s for this reason why our orange strategy of randomly vaccinating one person then its neighbors was such a bad strategy: not only do we not know if we&#39;re vaccinating a well connected person, but we&#39;re wasting vaccines but doubly protecting edges between neighbors. Since reducing the edge count is our only form of reducing $R_0$, this is a very bad strategy. What is surprising though, is that vaccinating the least connected people was almost as good as random. Since unpopular people can only be connected to so many people, they tend to be pretty spread out removing a fair number of edges between all the vaccinated people.</p>
<h2 id="what-next-">What next?</h2>
<p>Honestly, our graph model isn&#39;t all that bad considering how simple it is, but let&#39;s look at some nice upgrades we can hand over to it.</p>
<h3 id="graph-generation">Graph Generation</h3>
<p>This was originally made as a school project, so we generated our graph by taking some number of edges and placing them randomly between nodes for simplicity in presentation. However, these obviously aren&#39;t the only types of networks. A prominent one for modelling interactions between people is the <strong>Erdös-Rényi</strong> graph. For $n$ nodes, there are $n \choose 2$ possible pairings of nodes for edges. In an ER graph, we flip a weighted coin to accept an individual edge, and the final result is just the collection of edges we added. If our acceptance probability is $p$, then we would expect the graph to have a total of ${n \choose 2}p$ edges, each node to have on average $p(n-1)$ connections. In this network, people are approximately as popular as others (since our coin flip method leads to a binomial distribution with few super popular or super unpopular people).</p>
<p><img src="/img/quarantine-quandaries/exampleER (1).png"></p>
<center style="color: #666;">
<p>An Erdös-Rényi graph with an average connection of 4.8. Look how nice and even this graph is.</p>
</center>

<p>Another type of graph is the <strong>Barabási-Albert</strong> type graph. The idea with this network is that people tend to be connected to a distinct, central &quot;hub&quot; of a few people that make up most of a network. The idea is that you start with a small network of $m$ people/nodes to begin with. At each step, you add a new node and connect it to another person $i$ with probability $p_i = \frac{E(i)}{\sum_jE(j)}$ where $E(x)$ is the number of edges for node $x$ and $j$ represents all other nodes. The idea is that if $E(i)$ is really big (i.e. a super popular person), then you&#39;ll have a much bigger probability to connect to that person over someone who only has a few connections. Wouldn&#39;t you want to hang out with the cool kids too? You can give $i$ as many connections as you want, so long as it&#39;s less than $m$ (think about the first new node: how can someone have 10 different friends in a group of 5?).</p>
<p><img src="/img/quarantine-quandaries/exampleBA (1).png"></p>
<center style="color: #666;">
<p>A Barabási-Albert graph where each new node gets 2 connections to the existing network. Can you see the clusters of the graph?</p>
</center>

<p>If you want to explore this more, the <a href="https://www.complexity-explorables.org/explorables/facebooked-flu-shots/">inspiring article</a> that led to this project analyzes these 2 exact graphs in the exact problem we discussed above, going a bit more in depth with the idea of the counterintuitive <a href="https://en.wikipedia.org/wiki/Friendship_paradox">friendship paradox</a>.</p>
<h3 id="new-vaccination-schemes">New Vaccination Schemes</h3>
<p>We looked at a very specific set of vaccination parameters, namely relying on all edges are treated equally and that the number of edges a node has is constant. In reality, people don&#39;t interact with each other equally, so instead of having a generic edge, we could implement an edge <strong>weighting</strong>. This quality would add a number between 0 and 1 to each edge to represent how &quot;friendly&quot; two people are with each other. We could then simulate the difference between best friends and mere colleagues interacting that may have more or less of a chance to spread a virus. The other aspect to consider was updating edge counts. Ideally we would only want to count a vaccine&#39;s candidate&#39;s number of edges to <em>vulnerable</em> people, not vaccinated onr infected people too, with counts updating after every vaccination. Then we could focus on protecting people specifically.</p>
<p>The final problem I wanted to talk about what the goal of vaccines are in a network. As we said, it&#39;s about removing edges efficiently, but some edges are definitely worth more than others. Imagine you have two friend circles, with exactly one mutual person between them. Even if that mutual friend has only two edges, vaccinating him would close that bridge between the two friend circles, isolating the virus into only one of them.</p>
<p><img src="/img/quarantine-quandaries/barbell.png"></p>
<center style="color: #666;">
<p>Vaccinating the literal middle-man isolates the two groups</p>
</center>

<p>This searching for a way to split our graph in two parts with the fewest number of edges removed is called the <strong>sparsest cut problem</strong>. If we can find the (usually approximate) sparsest cut, we can divide our graph in two and attempt to isolate the virus in only a singular bubble. Before, we were looking to remove something known as <a href="https://en.wikipedia.org/wiki/Hamiltonian_path"><strong>Hamiltonian paths</strong></a>, where you can&#39;t connect any one node to another. Here, we are trying to isolate the virus into a smaller bubble.</p>
<p><img src="/img/quarantine-quandaries/sparsestCut (1).png"></p>
<center style="color: #666;">
<p>Sparsest cut of a random ER graph that approximately cuts the graph in half</p>
</center>

<p>So here we would want to vaccinate everyone on the border of the yellow-purple divide to make the sparsest cut a reality. Of course, this only works if you have enough vaccines AND if your sparsest cut splits the graph in half evenly. This strategy can be used recursively on the two sub-graphs, so the more vaccines you have, the better this strategy works.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I hope this brought some light to the epidemic math that goes on behind the scenes of so many news articles, but more importantly showed you the power of modelling situations not just in different ways, but creative ones as well. Graph theory in particular has such widespread applications, often just thinking of something simply with connections can allow you to borrow from its variety of tools and techniques.</p>
]]></description>
         <link>http://xperimex.github.io/blog/quarantine-quandaries</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/quarantine-quandaries</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Treeline Riddles and Triangular Rends]]></title>
         <description><![CDATA[A puzzle to test in the forest 

 <p><strong>If you break a stick at 2 uniformly random points into 3 segments, what&#39;s the probability you can form a triangle out of those 3 segments?</strong></p>
<p>As with all puzzles, drawing something always helps.</p>
<p><img src="/img/triangle-puzzle/stickSetup.png"></p>
<center style="color: #666;">
<p>Label the ends of the stick to be 0 and 1, and we&#39;ll make the first break at point $x$.</p>
</center>

<p>The key to this puzzle is to use the <strong>triangle inequality</strong>: no side of a triangle can be longer than the sum of the other two.</p>
<p><img src="/img/triangle-puzzle/triangleIEQ.png"></p>
<center style="color: #666;">
<p>The triangle inequality visualized.</p>
</center>

<p>So, that means that no segment can be longer than half the length of our stick. Now, we can start solving the puzzle. Without loss of generality, make the first break at point $x$ between 0 and .5 to ensure our first break is on the left side (if it&#39;s not within this range, it&#39;ll be some symmetric case on the right half of the stick). Our left half of the stick is already less than .5, so that&#39;s good, but that means our second break <em>must</em> be on the right half, as otherwise that will be a leg that will be greater than .5, and that&#39;s no good. The probability our second break will be on the right half of the leg is equal to the length of that segment over the total line (since it&#39;s uniformly random): $\frac{1-x}{1}$. Let&#39;s analyze that longer leg now.</p>
<p><img src="/img/triangle-puzzle/longLegFeasible.png"></p>
<center style="color: #666;">
<p>The feasibility region in red shows the location of a valid cut to ensure it does not make a segment longer than .5 units.</p>
</center>

<p>We can&#39;t make a cut at or further than the .5 mark on the segment for the obvious reason: it would make a leg longer than .5, breaking the triangle inequality. For a similar reason, we can&#39;t make a cut at $1-x-.5$ or earlier, as that will make a leg on the right side longer than .5 too. We need a cut in between those two boundaries. Just like we found the probability for making a cut on this longer leg to begin with, if we can find the length of that feasibile region and divide that by the length of the leg, that will give us the probability for making a good cut here. The length of the red feasible region is $|.5-(1-x-.5)| = |1-1+x| = x$, and the total length is just $1-x$. So the probability our second cut is valid is $\frac{x}{1-x}$.</p>
<p>Putting it all together, we get the probability that our second cut is valid given a first cut at $x$ is $\frac{1-x}{1} \cdot \frac{x}{1-x} = x$. Kind of neat that the probability is exactly proportional to the length of the first break. But of course, $x$ isn&#39;t constant. It too is a random variable, so we can average it to get an expected probability across a large number of trials.</p>
<center>
$\frac{1}{\frac{1}{2} - 0} \int_0^{\frac{1}{2}} x \,dx = 2 \cdot \frac{x^2}{2} \Big]_0^{\frac{1}{2}} = (\frac{1}{2})^2 = \frac{1}{4}$
</center>

<p>As a gut check, this should make sense as .25 is exactly the midpoint between 0 and .5, the boundaries we set at the start of the solution. </p>
<hr>
<p>So, if you break a stick at 2 uniformly random points into 3 segments, the probability those 3 segments can form a triangle is exactly $\frac{1}{4}$.</p>
]]></description>
         <link>http://xperimex.github.io/blog/triangle-puzzle</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/triangle-puzzle</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Linear Programming and Laudable Polytopes]]></title>
         <description><![CDATA[Monopolize the world with mx+b 

 <p>You&#39;re a business tycoon. You have ideas in mind but no products on hand. You need to make a quick buck now and all you have is some needlework on your belt to carry you. If you wanted to maximize profit between making hats and shirts, what combination of the two should you make? Well, let&#39;s look at what our goal is. If I make \$15 per shirt, and \$10 per hat, we can have a simple goal of</p>
<center>
$\max(15s + 10h)$
</center>

<p>Obviously, we can&#39;t just make infinite of each wearable. We have some constraints between available cloth, printing, and effort. If you have 20 sheets of cloth, and each shirt requires $\frac{1}{2}$ of one and the hats only require $\frac{1}{5}$ of one. For printing, maybe you only have enough ink for 100 prints total. Finally, hats are hard to make, so you cap yourself at only making 70 and no more. We have a list of constraints which can be nicely added as a set of inequalities:</p>
<center>
$\max(15s + 10h)$ </br>
$\begin{align}
\frac{1}{2}s + \frac{1}{5}h &amp; \leq 35 \
\newline
s + h &amp; \leq 100 \
\newline
h &amp; \leq 70
\end{align}$
</center>

<p>This isn&#39;t an easy system to solve as, well, we&#39;re not solving anything in the traditional sense by plugging in equations to one another, nor is it a standard maximization problem where we can take some form of a gradient since every equation here is a line, so we would only get constants that give us no new information. </p>
<p>This type of problem where we want to maximize a linear equation that is also bound by a set of linear restraints is called a <strong>linear program</strong>. These types of problems are called specifically programs as you&#39;ll see that we have analytic ways to find solutions, but to find the <em>best</em> solution requires some well-crafted algorithms to make solving them faster and more efficient. Before we can understand the 2, and later the general $n$, variable set up, let&#39;s try an easier case.</p>
<h2 id="1d-linear-program">1D Linear Program</h2>
<p>As with all problems, let&#39;s try and cut back on degrees of freedom so we can really focus on what&#39;s going on here. Instead of maximizing a function of 2 variables, let&#39;s do a function of 1 variable.</p>
<center>
$\max(3x)$</br>
$\begin{align}
5x &amp; \leq 50 \
\newline
x &amp; \geq 6
\end{align}$
</center>

<p>This isn&#39;t all that interesting, as I&#39;m sure the answer is popping out almost immediately: $\max(3x)=30$ from since we can only have at most 10 of variable $x$ from the first constraint. What will become an important concept later is how we visualize these solutions to linear programs, so let&#39;s graph our inequalities on a number line to represent the quantity of variable $x$.</p>
<p><img src="/img/linear-program/1d-lp.png"></p>
<center style="color: #666;">
<p>Feasiblity region graphed for our 1-variable linear program.</p>
</center>

<p>In <span style="color:blue">blue</span>, we have our first constraint of showing all values of $x$ that satisfy $5x \leq 50$, and in <span style="color:red">red</span> we have our second constraint showing all $x$ that satisfy $x \geq 6$. Where those two regions overlap in the purple-ish area is the <strong>feasibility region</strong>, as well, it&#39;s the area where all of our constraints are satisfied and where <em>feasible</em> values of $x$ lie. The feasibility region defines a <em>polytope</em>, a generalization of the 2D polygon and 3D polyhedron. The key takeaway is that our solution of $x=10$ is an <em>edge case</em>: it lies on the furthest possible boundary of our feasibility region. </p>
<p>This makes sense for two reasons. 1) We want to always be looking to maximize or minimize our <strong>objective function</strong> ($3x$, in this case) so if we can add more or less of $x$ to our solution, we want to do that depending on our goal. This is a more intuitive way to show reason 2) our function is linear, so as long as we go in one direction, it will always be increasing or decreasing. Let&#39;s add the $y$-axis into this graph and let $y=3x$ to see the value of the function we&#39;re maximizing at different values of $x$.</p>
<p><img src="/img/linear-program/1d-lp-z.png"></p>
<center style="color: #666;">
<p>Objective function $y=3x$ plotted with an extra dimension.</p>
</center>

<p>Since our objective function is linear, it is directly proportional to $x$, so as $x$ increases or decreases, $y$ also has to only increase or decrease with no chance of weird curves or bends in its function. So if we want to maximize our function, we just want to walk in the direction of $x$ that does so until we hit the edge of our feasiblity region. Similarly, if we wanted to minimize it, we&#39;d walk the other way along $x$ that decreases $y$.</p>
<p>With this in mind, we can now go back to our original 2 variable case.</p>
<h2 id="2d-linear-program">2D Linear Program</h2>
<p>Recalling what our original setup was</p>
<center>
$\max(15s + 10h)$ </br>
$\begin{align}
\frac{1}{2}s + \frac{1}{5}h &amp; \leq 35 \
\newline
s + h &amp; \leq 100 \
\newline
h &amp; \leq 70
\end{align}$
</center>

<p>Let&#39;s plot our feasibility region like we did before. Only now, it&#39;ll be a 2-dimensional region instead of just the number line. We&#39;ll put $s$ for shirts on the $x$-axis and $h$ for hats on the $y$-axis.</p>
<p><img src="/img/linear-program/2d-lp.png"></p>
<center style="color: #666;">
<p>5 vertices map out our 2D linear program&#39;s feasibile region, meaning there are 5 possible points that can be our optimal solution.</p>
</center>

<p>Just as in the 1-variable case, our solution for maximizing our objective function should lie at the edge of our feasible region. I&#39;ve marked the feasible region&#39;s defining vertices in purple. It&#39;s worth pointing out that I have added an additional vertex not defined by our original constraints, and that&#39;s the vertex $(0,0)$. This is aptly called the non-negativity constraints as it, well, constrains our variables to be non-negative (shocking, right). These tend to be a requirement for some minimization cases just so that we don&#39;t end up with problem of running into a pair of negaively infinite numbers as our solution, which obviously doesn&#39;t make sense.</p>
<p>Although what I said about our solution being on the edge of the region isn&#39;t true, I can tell you more about our maximum solution: it will (usually) be one of the vertices of our feasible region. If you want a more math-based explanation, check <a href="https://cs.stackexchange.com/questions/84343/simplex-algorithm-why-must-the-optimal-value-of-the-lp-lie-on-the-face-or-verte">this</a> out, but there&#39;s a very intuitive way to view think of this, especially with a 2-variable linear program. </p>
<p>Remember how in the 1D case, our objective function $y=3x$ could be represent as a line? We can do a similar idea and add a third $z$-axis to our 2D problem and get $z=15s+10h$. This equation gives us a 3-dimensional plane as we encode the number of shirts, hats, and the amount of money they profit. Our constraints are also planes, acting as curtain-like walls extending forever vertically in the $z$-axis (as all values of $z$ will satisfy whatever values of $s$ and $h$ that lie on the line). Now, imagine our objective function plane of $z=15s+10h$ to be like a tilted table, and we place a ball on it to roll, what does the ball do? Well, the ball will just roll down the incline to the lowest point gravity will push it down. Normally, the ball will roll down forever and ever as our table extends infinitely in all directions, but we have our constraining walls to stop the ball. As soon as the ball hits a wall, it&#39;ll continue to slide down that wall as long as the ground tilts downward. It&#39;ll only stop if another wall pushes it into a corner, which is where our constraints form a vertex. Isn&#39;t that neat? The only times this won&#39;t be true is if one of our constraints form a wall that is exactly perpendicular to the direction the ball is rolling, in which case you will have a line segment worth of solutions (which includes two vertices at the end of it). This specific logic applies to finding minimums of our objective function, but you can also think of the reverse for maximums with a tilted ceiling and a balloon instead of a ball. It&#39;s basically a streamlined version of gradient descent since the gradient of the plane is always constant.</p>
<p>So if you manually check all 5 vertices, you&#39;ll find that a combination of $(50 \textrm{ shirts}, 50 \textrm{ hats})$ gives the optimal combination of $1250 profit. Not bad.</p>
<h2 id="the-simplex-algorithm">The Simplex Algorithm</h2>
<p>Not to dismiss the wonders of guess-and-check, but it only worked well for us due to the small number of variables and constraints we had. As we tackle more complex and intricate problems, we want to be able to solve linear programs much quicker and more efficiently. There are many algorithms that have been developed for LP optimization with varying motives, but the first one was George Dantzig&#39;s <strong>simplex algorithm</strong>.</p>
<p>The simplex algorithm is essentially a systematic way for us to narrow our guess-and-check quickly. We start at some vertex, and then travel edges of the feasbile region between vertices until it lands on the optimal solution. The idea is by turning our constraints into a matrix, we can use Gaussian elimination to move between possible candidate solutions until no improvement to our objective function can be made. Let&#39;s use our original 2-variable problem to try it out.</p>
<center>
$\max(15x + 10y)$ </br>
$\begin{align}
\frac{1}{2}x + \frac{1}{5}y &amp; \leq 35 \
\newline
x + y &amp; \leq 100 \
\newline
y &amp; \leq 70
\end{align}$
</center>

<p>To start, we&#39;re going to turn these inequalities into equations by adding <strong>slack variables</strong>. To avoid confusing variable names later, I have replaced $s$ with $x$ and $h$ with $y$. The idea is that if our inequalities are anything less than the right-hand side, we should be able to cover that excess by adding an extra variable to make it equal. Rewriting all of our inequalities (including the objective function with a new objective variable $z$) into equations, we get</p>
<center>
$\begin{align}
-15x - 10y + z &amp; = 0 \
\newline
\frac{1}{2}x + \frac{1}{5}y + s_1 &amp; = 35 \
\newline
x + y + s_2 &amp; = 100 \
\newline
y + s_3 &amp; = 70
\end{align}$
</center>

<p>This is a system of linear equations we can encode as an augmented matrix!</p>
<center>
$
\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
\frac{1}{2} &amp; \frac{1}{5} &amp; 1   &amp; 0   &amp; 0 &amp; 0   &amp; 35 \\
1 &amp; 1 &amp; 0   &amp; 1   &amp; 0 &amp; 0   &amp; 100 \\
0 &amp; 1 &amp; 0   &amp; 0   &amp; 1 &amp; 0   &amp; 70 \\ \hline
-15 &amp; -10   &amp; 0   &amp; 0 &amp; 0   &amp; 1 &amp; 0 \\
\end{array}
$
</center>

<p>Here are some things to identify in our <strong>simplex tableau</strong> above. The first row is more a convenience than anything, keeping track of which column corresponds to each variable. The second, third, and fourth rows all correspond to some constraint we have rewritten as equations with slack. The fifth and final row is our objective function which we are trying to maximize. So, by default, we assume we start at the point $(0,0)$ in our feasibility region. Yes, it is a vertex and therefore a candidate solution, but obviously it&#39;s not the maximum solution we want, giving us a whopping $z=0$. How do we find the next candidate point? Well we first want to identify which of our variables would increase $z$ the quickest. Well, notice that $x$ has a coefficient of $-15$ in the objective function final row, while $y$ has only a value of $-10$ (we call these numbers <strong>indicators</strong>). This means for every unit of $x$, we gain an additional \$15 contrasting an additional \$10 from a singular unit of $y$. Since $x$ increases $z$ faster than $y$ does, let&#39;s focus on column 1.</p>
<p>If we&#39;re going to increase $x$ to increase $z$, how do we know how much to increase it by? We can use our handy constraints to tell us exactly that. What we do is we take each value in the $x$ column and divide its associated row&#39;s constraint by that value. So, for the $x$ variable we have</p>
<center>
$\begin{align}
35 \div \frac{1}{2} &amp; = 70 \
\newline
100 \div 1 &amp; = 100 \
\newline
70 \div 0 &amp; = \textrm{undefined}
\end{align}$
</center>

<p>Now why is this helpful? These divisions tell us the maximum amount of $x$ we can have according to each constraint (as we assume $y$ can be 0). So, if $\frac{1}{2}x + \frac{1}{5}y \leq 35$, then $x$ can be at most 70 without breaking that constraint. Similarly, $x$ can be at most 100 for the second constraint, and there&#39;s no limit for $x$ on the third constraint since it doesn&#39;t impact that inequality. So, this tells us we should use the first row as our guiding row! This is because if we used the second row with a maximum of 100, we would be violating our first constraint that $x \leq 70$. So, we call $\frac{1}{2}$ our <strong>pivot</strong> as we use that value to shift our focus from one vertex solution to another. We use our pivot to do Gaussian elimination, and create 0s in that column&#39;s other rows to land us at a new vertex.</p>
<center>
$
\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
\color{red}{\frac{1}{2}} &amp; \frac{1}{5} &amp; 1   &amp; 0   &amp; 0 &amp; 0   &amp; 35 \\
1 &amp; 1 &amp; 0   &amp; 1   &amp; 0 &amp; 0   &amp; 100 \\
0 &amp; 1 &amp; 0   &amp; 0   &amp; 1 &amp; 0   &amp; 70 \\ \hline
-15 &amp; -10   &amp; 0   &amp; 0 &amp; 0   &amp; 1 &amp; 0 \\
\end{array}
$
<br />
$\downarrow$
<br />
$R_2 - 2R_1$
<br />
$R_3 - 0R_1$
<br />
$R_4 + 30R_1$
<br />
$\downarrow$
<br />
$
\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
\frac{1}{2} &amp; \frac{1}{5} &amp; 1   &amp; 0   &amp; 0 &amp; 0   &amp; 35 \\
0 &amp; \frac{3}{5} &amp; -2   &amp; 1   &amp; 0 &amp; 0   &amp; 30 \\
0 &amp; 1 &amp; 0   &amp; 0   &amp; 1 &amp; 0   &amp; 70 \\ \hline
0 &amp; -4   &amp; 30   &amp; 0 &amp; 0   &amp; 1 &amp; 1050 \\
\end{array}
$
</center>

<p>This new vertex we have arrived at is exactly the solution you get only focusing on achieving a maximum $x$ at the point $(70,0)$, which is in fact, the solution with the most units of $x$.</p>
<p><img src="/img/linear-program/2d-lp-simplex1.png"></p>
<center style="color: #666;">
<p>The first step in our simplex algorithm visualized as we walk the edge between $(0,0)$ to $(70,0)$. This first step is definitely a better solution than before, but how can we tell if it is the <i>best</i> one?</p>
</center>

<p>\$1050 is definitely much better than netting \$0, but how do we know if we can make more? Going back to our objective function in the last row of our tableau, there&#39;s a $-4$ in the $y$ column, and as before, should mean there&#39;s a potential to increase profit by adding some $y$ component to our solution. Before we do that though, notice how some of our constraints have changed. $R_2$ used to denote $x+y+s_2=100$, but now it shows $\frac{3}{5}y - 2s_1 + s_2 = 30$, or as an inequality, $\frac{3}{5}y \leq 30$. What caused our constraint to change? It has to do with the fact we added rows together. Let&#39;s analyze the two original constraints in question of $R_1$ and $R_2$.</p>
<center>
$\begin{align}
\frac{1}{2}x + \frac{1}{5}y &amp; \leq 35 \
\newline
x + y &amp; \leq 100 \
\end{align}$
</center>

<p>We can then treat these as a system of equations like we did with Guassian elimination, and perform the same operation as we did before with $R_2 - 2R_1$.</p>
<center>
$\color{blue}{x + y} - (\color{red}{x + \frac{2}{5}y}) \leq 100 - 70$
</center>

<p>The important part to notice is that we&#39;re subtracting <em>from</em> the blue region $\color{blue}{R_2}$ and expecting a <em>positive</em> result (since both $x$ and $y$ must be greater than 0). This can only happen for our feasible region where the blue area $\color{blue}{R_2}$ is strictly greater than the red area $\color{red}{R_1}$. This appears only when $\color{red}{R_1}$ is <em>contained</em> within $\color{blue}{R_2}$. The $y$-value we solved for of $\frac{3}{5}y \leq 30$ is that maximum $y$ value of which that holds true. Anything above $(50,50)$ and suddenly the blue region is contained by the red, but anything below is fair game. </p>
<p>Our constraints haven&#39;t actually changed, they actually narrowed in given new information of which boundaries we are at with our current candidate solutions. </p>
<p>With that justified, we can now move on to repeating our pivoting process like before. In our new tableau, the $y$ column has a value of $-4$ in the indicators, meaning we have a possibility to increase $z$ by changing increasing $y$. Going through our process all over again to find and use the pivot:</p>
<center>
$\begin{align}
35 \div \frac{1}{5} &amp; = 175 \
\newline
\color{red}{30 \div \frac{3}{5}} &amp; \color{red}{= 50} \
\newline
70 \div 1 &amp; = 70
\end{align}$
</center>

<p>With a new pivot found...</p>
<center>
$\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
\frac{1}{2} &amp; \frac{1}{5} &amp; 1   &amp; 0   &amp; 0 &amp; 0   &amp; 35 \\
0 &amp; \color{red}{\frac{3}{5}} &amp; -2   &amp; 1   &amp; 0 &amp; 0   &amp; 30 \\
0 &amp; 1 &amp; 0   &amp; 0   &amp; 1 &amp; 0   &amp; 70 \\ \hline
0 &amp; -4   &amp; 30   &amp; 0 &amp; 0   &amp; 1 &amp; 1050 \\
\end{array}
$
<br />
$\downarrow$
<br />
$3R_1 - R_2$
<br />
$3R_3 - 5R_2$
<br />
$3R_4 + 20R_2$
<br />
$\downarrow$
<br />
$
\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
\frac{3}{2} &amp; 0 &amp; 5   &amp; -1   &amp; 0 &amp; 0   &amp; 75 \\
0 &amp; \frac{3}{5} &amp; -2   &amp; 1   &amp; 0 &amp; 0   &amp; 30 \\
0 &amp; 0 &amp; 10   &amp; -5   &amp; 3 &amp; 0   &amp; 60 \\ \hline
0 &amp; 0   &amp; 50   &amp; 20 &amp; 0   &amp; 3 &amp; 3750 \\
\end{array}
$
</center>

<p>There are no more negative numbers in the objective function row&#39;s indicators, so this should be our optimal solution! This is because of the actual equation that row represents:</p>
<center>
$50s_1 + 20s_2 + 3z = 3750$
<br />
$3z = 3750 - 50s_1 - 20s_2$
</center>

<p>Since every variable, including our slack variables $s_1$ and $s_2$, is non-negative, the maximum our objective function can be is $3z=3750$ with both $s_1$ and $s_2$ equal to 0. So, while we may be done doing computing our solution, we should simplify our tableau to make it more readable. Let&#39;s make $x$, $y$, $z$, and $s_3$—our non-zero variables—have coefficients of 1 so we can easily find their values.</p>
<center>
$
\begin{array}{cccccc|c}
{\bf x} &amp; {\bf y} &amp; {\bf s_1} &amp; {\bf s_2} &amp; {\bf s_3} &amp; {\bf z} &amp; \textbf{constraints} \\ \hline
1 &amp; 0 &amp; \frac{10}{3}   &amp; \frac{-2}{3}   &amp; 0 &amp; 0   &amp; 50 \\
0 &amp; 1 &amp; \frac{-10}{3}   &amp; \frac{5}{3}   &amp; 0 &amp; 0   &amp; 50 \\
0 &amp; 0 &amp; \frac{10}{3}   &amp; \frac{-5}{3}   &amp; 1 &amp; 0   &amp; 20 \\ \hline
0 &amp; 0   &amp; \frac{50}{3}   &amp; \frac{20}{3} &amp; 0 &amp; 1   &amp; 1250 \\
\end{array}
$
</center>

<p>Our second step in the simplex algorithm brought us to our optimal solution of $x=50$, $y=50$, $s_1=0$, $s_2=0$, $s_3=20$, and $z=1250$.</p>
<p><img src="/img/linear-program/2d-lp-simplex2.png"></p>
<center style="color: #666;">
<p>The second and final step in the simplex algorithm takes us from our last candidate solution $(70,0)$ to the optimal vertex of $(50,50)$.</p>
</center>

<p>Here&#39;s a summary of the simplex algorithm to solve linear programs:</p>
<ol>
<li>Rewrite the objective function and constraints into equations with slack variables.</li>
<li>Create the initial simplex tableau using the newly written equations.</li>
<li>Identify the most negative indicator to find the pivot variable.</li>
<li>Calculate quotients to find upper bounds on the pivot variable, and select the smallest quotient; this is the pivot for this iteration.</li>
<li>Using Gaussian elimination and row operations to turn all other values in the column to 0 using the pivot.</li>
<li>If any negative indicators remain after all row operations, repeat steps 3–5.</li>
<li>If no negative indicators remain, we are done and at the optimal solution$^*$!</li>
</ol>
<p>While we only looked at 1- and 2-dimensional linear programs, remember that this can work for as many variables as you&#39;d like, which is nice since I don&#39;t want to deal with imagining a ball rolling down a 12-dimensional tabletop to find my function minimum. There is a small asterisk though, since sometimes the simplex algorithm can &quot;stall&quot; or &quot;cycle&quot;, resulting in no net improvements of the objective function. Fortunately <a href="https://en.wikipedia.org/wiki/Linear_programming#Algorithms">other algorithms</a> based on other concepts have been built to not just be quicker, but avoid degenerate cases stalling and cycling.</p>
<h2 id="sensitivity-and-slack-analysis">Sensitivity and Slack Analysis</h2>
<p>What the values of $x$, $y$, and $z$ should be clear as those correspond to the point on the feasible region and maximum of the function, but what do the values of $s_1$, $s_2$, and $s_3$ mean? Recall that these are our <strong>slack variables</strong> as these are the variables that turned our constraining inequalities into equations by accounting for any <em>slack</em> in the constraints themselves. So, if we have 0 slack for one of our constraints, it means that we are using up as much of that constraint as we can; there is no slack to account for, and the corresponding slack variable is 0. If there is slack, it means we are not using up a constraint to its fullest potential. Recall our third constraint was </p>
<center>
$y \leq 70 \rightarrow y + s_3 = 70$
</center>

<p>Also remember that our optimal solution included that $y=50$. We set a cap of $y=70$, but we are only using 50 of those possible 70 units. $s_3$ tells us that in the third constraint, we have an excess of 20 unused constraining units. In that same sense, $s_1$ and $s_2$ tell us we have 0 wasted resources for the first and second constraints. This also tells us that we are precisely at the vertex of where the first and second constraints graphically meet, since our solution is on the edge of both inequalities.</p>
<p>That&#39;s not the only information our slack variables tell us, though. You can also find how sensitive our result is in the final row of our tableau. The $\frac{50}{3}$ and $\frac{20}{3}$ tells us for every additional unit we add to constraints of $R_1$ or $R_2$, we will make an additional \$ $\frac{50}{3}$ or \$ $\frac{20}{3}$ respectively since $\frac{50}{3}(s_1 + 1) = \frac{50}{3}s_1 + \frac{50}{3}$. These are called <strong>shadow prices</strong> of our objective function. If you want to read more about shadow prices and other marginal analysis such as <strong>reduced costs</strong>, <a href="http://web.mit.edu/15.053/www/AMP-Chapter-03.pdf">MIT OpenCourseWare</a> has you covered, but for now there are a few cool extensions of linear programming I want to cover.</p>
<h2 id="duality-and-dual-problems">Duality and Dual Problems</h2>
<p>Even though we have a systematic way to find our ideal solution to a linear program, we could have quickly found some facts about our solution before we started. Again, here is our previous, 2-variable linear program.</p>
<center>
$\max(15x + 10y)$ </br>
$\begin{align}
\frac{1}{2}x + \frac{1}{5}y &amp; \leq 35 \
\newline
x + y &amp; \leq 100 \
\newline
y &amp; \leq 70
\end{align}$
</center>

<p>In our 1st constraint, we could have equivalently rewritten it as</p>
<center>
$30x + 12y \leq 2100$
</center>

<p>by multiplying both sides by 60. Furthermore, since both $x$ and $y$ are greater than 0, we can also compare it to our objective function.</p>
<center>
$15x + 10y \leq 30x + 12y \leq 2100$
</center>

<p>So we now have an upper bound on our objective function: we know for sure it has to be less than 2100. We can be even smarter about this and do a similar process with our second constraint. By multiplying both sides of the second constraint by 15, we can say</p>
<center>
$15x + 10y \leq 15x + 15y \leq 1500$
</center>

<p>which gives us an even tighter upper bound on our optimal solution. This is the heart of <strong>duality</strong>: instead of trying to directly solve our maximization problem, we can turn it into an equivalent minimization problem to find the lowest upper bound of our objective function, indirectly solving it.</p>
<p>We can generalize this by multiplying all of our constraints by a scalar $a_i$ for each constraint and adding them all together.</p>
<center>
$\begin{align}
\frac{1}{2}a_{1}x + \frac{1}{5}a_{1}y &amp; \leq 35a_1 \
\newline
a_{2}x + a_{2}y &amp; \leq 100a_2 \
\newline
a_{3}y &amp; \leq 70a_3
\end{align}$
</center>

<p>Adding these all together, we get a unifying inequality of</p>
<center>
$\color{red}{15x + 10y} \leq (\frac{1}{2}a_{1} + a_{2})x + (\frac{1}{5}a_{1} + a_{2} + a_{3})y \leq 35a_1 + 100a_2 + 70a_3$
</center>

<p>Lastly, remember this is supposed to be an upper bound on our objective function, so we set this all greater than our objective function which I&#39;ve highlighted in <span style="color:red">red</span>. In our first few tries to bound the problem, we had $(a_1, a_2, a_3)$ equal $(60,0,0)$ and $(0,15,0)$ respectively. We can summarize our goal of minimizing the right-hand side while maintaining all these inequalities as true as</p>
<center>
$\min(35a_1 + 100a_2 + 70a_3)$ </br>
$\begin{align}
\frac{1}{2}a_1 + a_{2} &amp; \geq 15 \
\newline
\frac{1}{5}a_1 + a_2 + a_3 &amp; \geq 10 \
\end{align}$
</center>

<p>This looks like another linear program! We originally started with a <strong>primal</strong> problem with 2 variables and 3 constraints and used it to formulate its <strong>dual</strong> problem with 3 variables and 2 constraints!</p>
<p>But, what even is the purpose of this dual formulation? We already have a way to solve for an optimal solution, why needlessly copmlicate it with an extra intermediary step? The dual problem is useful as it allows us to readily access a lot of the sensitivity analysis. Each variable $a_i$ we&#39;re solving in the dual problem corresponds to the optimal <em>shadow price</em> (marginal utility of a resource) of the $i^\textrm{th}$ constraint in the primal problem.</p>
<p>Let&#39;s take a quick look back at our primal problem&#39;s solution. Recall that it had shadow prices of \$ $\frac{50}{3}$ for the first constraint of $\frac{1}{2}x + \frac{1}{5}y \leq \color{blue}{35}$, a shadow price of \$ $\frac{20}{3}$ for the second constraint of $x + y \leq \color{blue}{100}$, and a final shadow price of $0$ for the third constraint of $y \leq \color{blue}{70}$. If we value our total resources (highlighted in <span style="color:blue">blue</span>) at their marginal costs, we get that</p>
<center>
$\color{blue}{35} \cdot \frac{50}{3} + \color{blue}{100} \cdot \frac{20}{3} + \color{blue}{70} \cdot 0 = 1250$
</center>

<p>which is precisely the optimal profit we got originally from the primal problem. The leading principle of a dual problem is that if we can solve for the optimal marginal profits of each resource, then we know implicitly how much of that item we should buy given the total selling price of each primal variable.</p>
<center>
$\begin{array}{c|c}
\min(35a_1 + 100a_2 + 70a_3) &amp; \textrm{Minimize total cost of resources} \\
\newline
\frac{1}{2}a_1 + a_{2} \geq 15 &amp; \textrm{Marginal profit for variable $x$ must be at least 15} \\
\newline
\frac{1}{5}a_1 + a_2 + a_3 \geq 10 &amp; \textrm{Marginal profit for variable $y$ must be at least 10} \\
\end{array}$
</center>

<p>We try to minimize the cost of our primal constraints, while trying to ensure our dual constraints satisfy the coefficients of the primal objective function. In the case of shirt and hat selling, we want our marginal profits to at least equal the price we want to sell our products at. Even more interestingly, just like how our dual variables are equal to the primal shadow prices, the dual shadow prices are equal to the primal variables! Everything has been switched around!</p>
<p>Curiosities aside, we still haven&#39;t talked about many of the reasons <em>why</em> analyzing dual problems is useful. Here&#39;s a rundown of some of the benefits of duality:</p>
<ol>
<li><strong>Sometimes it&#39;s just easier:</strong> As you just saw, we turned a problem of 2 variables and 3 constraints into one of 3 variables and 2 constraints, and turned it from a question of maximization to one of minimization. For problems with few variables and lots of constraints, it&#39;s usually much easier to turn it into a problem with lots of variables and fewer constraints as every constraint in the problem will add some number of extra vertices for algorithms like the simplex to check, making it less efficient to check every case. </li>
<li><strong>Feasibility and boundedness:</strong> Sometimes a linear program will have no solutions whatsoever to check (imagine constraints like $x \geq 0$ and $x \leq 0$; can&#39;t be both at the same time). If the primal is unbounded (think no non-negativity constraints), then the dual is infeasible, and vice versa. </li>
<li><strong>Specialized algorithms and theorems:</strong> Beyond optimizing business plans, duality has found its way into <a href="https://brilliant.org/wiki/hungarian-matching/">combinatorics</a>, <a href="https://en.wikipedia.org/wiki/Max-flow_min-cut_theorem">graph theory</a>, and even into the fame of game theory as a means to prove the <a href="https://theory.stanford.edu/~tim/w16/l/l10.pdf">minimax theorem for zero-sum games</a>. Many more results like these tend to stem out of the <a href="https://sites.math.washington.edu/~burke/crs/407/notes/section4.pdf">Weak and Strong Duality Theorems</a> (Weak Duality talks about how a dual problem can set an upper bound to a primal soultion, and Strong Duality says it can <em>find</em> the optimal primal solution).</li>
</ol>
<hr>
<p>Duality is a powerful concept not just in linear programming, but frequently pops up in <a href="https://mathworld.wolfram.com/DualGraph.html">other areas of math</a> and recognizing when you can represent one problem with another is a great tool to have in your back pocket.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Linear programming is only one small niche of optimization study, but the depth and applicability in its simple premises is wildly effective. Starting out in the 40s with Dantzig&#39;s original simplex algorith, it has grown to affect much of computer science and math to systematically solve otherwise impossibly long computations. Even now, variations of the original linear programming formulation is still being researched with new methods to not only solve them, but also adding new fundamental restrictions to the problem. If you were a car manufacturer that wanted to know the optimal distribution of models to produce, you can&#39;t just make 41237.7963 cars; you would only care about integer solutions, and thus <strong>integer linear programming (ILP)</strong> was born. Linear programming&#39;s innate utility in optimization has lent itself kindly to modern applications, but from ILP, to the even crazier <strong>mixed-integer linear programming</strong> with a combination of integer and non-integer variables, as well as duality, LP has found itself touching every corner of math from combinatorics to graph theory as a simple multidimensional geometric encoding of a constraint function.</p>
]]></description>
         <link>http://xperimex.github.io/blog/linear-programming</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/linear-programming</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Billiard Balls and Secure Squares]]></title>
         <description><![CDATA[The ultimate secret to win at pool and laser tag 

 <script src="//cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/g9/1.0.16/g9.js'></script>

<p>Today&#39;s post is one that&#39;s been months in the making. It originally started as one that only covers a single problem, but quickly branched off as I delved deep into dozens of papers and videos, just with more and more questions coming up. We&#39;re going to be discussing one of the oldest mixed studies of algebra and geometry: <em>dynamical systems</em>. Today&#39;s post is going to be a long one, but should have a fair number of fun visuals to keep it worth the scroll. This is really two, maybe three posts in one, so I recommend reading this with breaks at each header as to make it less overwhelming. </p>
<p>To begin, let&#39;s look at a type of problem you might have <em>experienced</em> before, rather than have read formally: <strong>billiard problems</strong>.</p>
<!-- [INSERT TABLE OF CONTENTS LATER WHEN DONE: 1) MATH >> SPLIT DYNAMICAL SYSTEMS WITH ALHAZEN'S AND ILLUMINATION PROBLEMS AND OTHERS THEN SECURE POLYGON 2) GRAPHICS >> TALK ABOUT HOW USEFUL VECTORS ARE, SHOW WHY CURRENT INTERSECTION ALGORITHM CHEATS AND INTRO TO RAYTRACING]

look into if hexagon/triangle/other polygons that can or can't tile the plane are secure polygons like the square -->
<p><span style="color: #666;"><i>For the best experience, avoid reading this in Safari; most other browsers should work and load the visuals correctly, but Safari breaks rendering a few of them.</i></span></p>
<h2 id="ricochets-and-rebounds">Ricochets and Rebounds</h2>
<p>If you have ever played pool, or even laser tag, you might already be familiar with <em>billiard problems</em>. If you have a billiard ball you want to land in a pocket, but there are other balls in your way, where on the side of the pool table do you want to bounce your ball to land in the pocket? Alternatively, if you have a laser gun and an opponent by a mirror, where do you want to aim your laser to hit your opponent? To reduce this problem further (and for future reference), if you have a <span style="color:red">laser</span>, a <span style="color:green">target</span>, and a wall, where do you want to aim the laser to hit the target?</p>
<center>
<div id="billiardIntro"></div>
</center>
<center style="color: #666;">
<p>Can you make the <span style="color:red">light</span> hit the <span style="color:green">target</span>? The light automatically follows your cursor, but you can press the <i>1</i> key on your keyboard to lock the angle. Try dragging the points for different problem setups.</p>
</center>

<p>We covered how to solve this exact problem in a <a href="https://xperimex.com/blog/retroreflectors/#fermat-s-principle">previous post</a>, which also shows how light reflects and bounces (which is what we&#39;ll be using today). To recap that post:</p>
<ul>
<li>Our laser/billiards bounces must follow the <strong>Law of Reflection</strong>: the angle the laser strikes the mirror is the same angle it reflects.</li>
<li>To solve for where to bounce the light off the wall, we create a &quot;mirror world&quot; to find the reflection point.</li>
</ul>
<p>The idea is to reflect our target over the wall, draw a straight line from our laser to the reflected target, and the intersection point is the point of reflection. This seems arbitrary, but there&#39;s a good reason for it: the angle that our straight line creates in the &quot;mirror world&quot; is equal to the incident angle, and therefore ensures the angle the light bounces off at in the normal world is equal. I recommend following through with the previous post for a more on this, but the following demonstration should suffice.</p>
<center>
<div id="billiardSolved"></div>
</center>
<center style="color: #666;">
<p>We reflect our <span style="color:green">target</span> over the wall, and draw a line between the <span style="color:red">light</span> and that reflection. Can you see why this finds us our desired reflection point?</p>
</center>

<p>Simple enough, but this reflection technique is an invaluable tool for solving these types of problems, so put a pin in that for later. But now, let&#39;s look at a problem that throws that very easy technique out of the window.</p>
<h2 id="alhazen-s-circular-mirror">Alhazen&#39;s Circular Mirror</h2>
<p>Dynamical systems have been studied since forever at this point. One of the oldest (hard) billiard problems comes from Ptolemy 150 AD:</p>
<p><strong>If you have a candle and a circular mirror, where on the wall do you have to aim to hit a target?</strong></p>
<p>This problem plagued the Greeks for centuries, primarily since they tried to solve this with their typical ruler-and-compass constructions. Dr. Peter Neumann <a href="https://www.tandfonline.com/doi/abs/10.1080/00029890.1998.12004920">proved that this is an impossible task</a>, but other solutions and proofs have arisen over the years by some of the most famous mathematicians including Huygens and l&#39;Hôpital. The problem was named after Abu Ali al Hassan ibn al Hassan ibn Alhaitham, later retroactively given the mononym Alhazen, who discussed this in book <em>Optics</em> around the 10th century.</p>
<center>
<div id="alhazenIntro"></div>
</center>
<center style="color: #666;">
<p>Now, with the same <span style="color:red">light</span> and <span style="color:green">target</span>, can you hit the target? Drag and drop points for different problem setups; if you want to lock the light&#39;s direction, hit the <i>2</i> key.</p>
</center>

<p>First, let&#39;s clear some details up.</p>
<ul>
<li>To make sense of a curved mirror, the reflection acts according to the <em>tangent</em> line at the point of reflection. So, you can think of the curved mirror as made up of infinite, infinitesimal straight-walled mirrors.</li>
<li>The <span style="color:red">light</span> is a pure <strong>ray</strong> like a laser. No point source or beams to get cheap answers like, &quot;If I stand <em>about</em> here, some of the light will reflect on the target.&quot; This is a laser beam that can only blind us if it directly hits us.</li>
<li>In a similar manner to the <span style="color:red">light</span> assumption, the <span style="color:green">target</span> has been reduced a to 0-dimensional <strong>point</strong>. The <span style="color:red">light</span> must hit the <span style="color:green">target</span> <em>exactly</em> in our solution.</li>
<li>And, importantly, we assume a solution exists. If the light and target are on opposite sides of the circle, clearly no reflection will make it. So, to simplify, we&#39;ll just assume that they are in positions with a possible reflection point.</li>
</ul>
<p>Before I show you my solution to the problem, I suggest you try this problem for yourself. This is one of the few, very simple-to-state problems that has caused me a lot of trouble deciphering a clean solution for it. Mathematicians have developed quite the dictionary to solve this one problem <!-- talk about circle inversion, algebraic, and ellipse solutions --> which we&#39;ll discuss a bit at the end, but only one way has appeared the most elegant (in the most stretched definition) to me.</p>
<h3 id="clutch-complex-contours">Clutch Complex Contours</h3>
<p>The way I solved this problem was with the magnificence of complex numbers. Let&#39;s center our circular mirror as the unit circle $Ø$ at the origin $O$, and let&#39;s call the light and target $\color{red}{a}$ and $\color{green}{b}$ (if your circular mirror is not of radius 1, just scale all coordinates appropriately to make it so). We want to solve for the point $\color{purple}{z}$ on the mirror such that $\angle azO = \angle Ozb$. </p>
<p>The path our light takes can be modelled in two segments: from the candle $a$ to the mirror $z$ as $a-z$, and then from the mirror to the target as $b-z$ (you&#39;ll see why we pick these directions later). To make our lives easier, let&#39;s rotate our whole setup so that the mirror reflection point occurs at $z=1+0i$ by dividing our whole setup by $z$. So right now, we have two vectors representing our reflected ray of light as $\frac{a-z}{z}$ and $\frac{b-z}{z}$ (if you&#39;re not completely familiar with the geometry of complex numbers and why this division tactic works, here&#39;s a good <a href="https://www.youtube.com/watch?v=5PcpBw5Hbwo">introductory video</a>). </p>
<p><img src="/img/secure-squares/alhazenDivide.png"></p>
<center style="color: #666;">
<p>Here we have the <span style="color:red">light</span> at $\color{red}{a}$ and the <span style="color:green">target</span> at $\color{green}{b}$ at some arbitrary spots, with a theoretical <span style="color:purple">solution</span> at $\color{purple}{z}$. Since we don&#39;t want to work with some random tilted axis, we divide everything by $\color{purple}{z}$ to so that our set up is centered around the real axis with $\color{purple}{z} = 1$. </p>
</center>

<p>Since our vectors are now symmetrical about the real axis, we know that $\arg(\frac{a-z}{z}) = -\arg(\frac{b-z}{z})$ as the angle of reflection must be equal angle to the angle of incidence (see this <a href="http://xperimex.com/blog/retroreflectors/">previous post</a> for a proof).</p>
<p>Ok, so why is any of this helpful? Just as we divided by two complex numbers to subtract the angles of their vectors, we can multiply them to add them together. If we multiply $(\frac{a-z}{z})(\frac{b-z}{z})$, we get that their angles sum to 0 since their arguments are opposite! If the argument of the product is 0, that means that it lies on the real axis, and therefore is a real number! We can then extract that</p>
<center>
$\large{(\frac{a-z}{z})(\frac{b-z}{z}) \in \mathbb{R} \rightarrow \operatorname{Im}((\frac{a-z}{z})(\frac{b-z}{z})) = 0}$
</center>

<p>where $\operatorname{Im}(c)$ denotes the imaginary part of a complex number $c$. Noting that $\color{purple}{z} \cdot \overline{\color{purple}{z}} = 1$ we can further simplify this equation.</p>
<center>
$\begin{align}
\operatorname{Im}((\frac{a-z}{z})(\frac{b-z}{z})) &amp; = 0 \
\newline
\operatorname{Im}(\frac{ab - (a+b)z + z^2}{z^2} \cdot \frac{\overline{z}^2}{\overline{z}^2}) &amp; = 0 \
\newline
\operatorname{Im}((ab)\overline{z}^2 - (a+b)\overline{z} + 1) &amp; = 0 \
\newline
\operatorname{Im}((ab)\overline{z}^2) - \operatorname{Im}((a+b)\overline{z}) + \operatorname{Im}(1) &amp; = 0
\end{align}$

<br>
<br>

$\large{\operatorname{Im}((ab)\overline{z}^2) = \operatorname{Im}((a+b)\overline{z})}$
</center>

<p>This might not seem like much, this describes all possible points $\color{purple}{z}$ our reflection point can lie on! Let $\color{purple}{z} = x + yi$, $\color{red}{a} \color{green}{b} = p + qi$, and $\color{red}{a} + \color{green}{b} = r + si$, and we can rewrite our equation in terms of cartesian coordinates $(x,y)$.</p>
<center>
$\begin{align}
\operatorname{Im}((ab)\overline{z}^2) &amp; = \operatorname{Im}((a+b)\overline{z}) \
\newline
\operatorname{Im}((p+qi)(x-yi)^2) &amp; = \operatorname{Im}((r+si)(x-yi)) \
\newline
\operatorname{Im}(px^2 \color{red}{-2pxyi}-py^2 + \color{red}{qx^2i} + 2qxy \color{red}{- qy^2i}) &amp; = \operatorname{Im}(rx \color{red}{-ryi} + \color{red}{sxi} + sy) \
\end{align}$

<br>
<br>

$\large{q(x^2 - y^2) - 2pxy = sx - ry}$
</center>

<p>This is an equation for a hyperbola! And since we want $\color{purple}{z}$ to lie on the circumference of our spherical mirror, the point $(x,y)$ must also be a solution to $x^2+y^2 = 1$ to lie on the unit circle as well. To find where our desired $\color{purple}{z}$ is, we just need to find the intersection between this hyperbola and the unit circle.</p>
<p><img src="/img/secure-squares/alhazenHyperbola.png"></p>
<center style="color: #666;">
<p>Given our previous <span style="color:red">light</span> and <span style="color:green">target</span> positions, we get this specific <span style="color:purple">hyperbola</span> which intersects our mirror in 4 locations, giving 4 possible reflection points. How can we compute their coordinates, and find the correct point?</p>
</center>

<center>
$
\begin{cases} 
q(x^2 - y^2) - 2pxy = sx - ry \ 
\newline
x^2 + y^2 = 1 
\end{cases}
$
</center>

<p>It&#39;s no coincidence that this problem involves finding the intersection between a circle and a hyperbola. While yes, all of our complex number algebra does the job, there&#39;s a <a href="https://forumgeom.fau.edu/FG2012volume12/FG201216.pdf">purely geometrical</a> way of coming to the same conclusion involving isogonal conjugates. I wasn&#39;t very familiar with them, so I decided to present the complex number approach instead.</p>
<p>You could try and solve this system of equations, but the nature of the conic sections make it a pretty tedious and gross task. Fortunately, we can actually reduce this sytem of 2 simultaneous equations to a single polynomial! Going back to one of our previous equations:</p>
<center>
$\operatorname{Im}((ab)\overline{z}^2 - (a+b)\overline{z} + 1) = \operatorname{Im}((ab)\overline{z}^2 - (a+b)\overline{z})  = 0$
</center>

<p>The important thing to note is that we have a complex number whose imaginary component is equal to 0. This means that this expression is equal to its conjugate, since there is no imaginary component to flip the sign of: $x + 0i = x - 0i = x$.</p>
<center>
$\begin{align}
(ab)\overline{z}^2 - (a+b)\overline{z} &amp; = \overline{(ab)\overline{z}^2 - (a+b)\overline{z}} \
\newline
(ab)\overline{z}^2 - (a+b)\overline{z} &amp; = (\overline{ab})z^2 - (\overline{a+b})z 
\end{align}$
</center>

<p>Again noting that $\color{purple}{z} \cdot \overline{\color{purple}{z}} = 1$, we can multiply both sides by $\color{purple}{z}^2$ to get that</p>
<center>
$\large{(\overline{ab})z^4 - (\overline{a+b})z^3 + (a+b)z - ab = 0}$
</center>

<p>All we need are the complex solutions $\color{purple}{z}$, and since this a quartic equation, we <em>technically</em> have a <a href="https://en.wikipedia.org/wiki/Quartic_function#General_formula_for_roots">closed form solution</a>. Once we have the coordinates of our reflection points, all we do is graph $(\operatorname{Re}(\color{purple}{z}), \operatorname{Im}(\color{purple}{z}))$, and we are done.</p>
<p><img src="/img/secure-squares/alhazenPoly.png"></p>
<center style="color: #666;">
<p>Our complex quartic generates 4 possible solutions for $\color{purple}{z}$, all on the unit circle.</p>
</center>

<p>If these points look familiar, they should: they are precisely the points our hyperbola predicted before!</p>
<p><img src="/img/secure-squares/alhazenPolyHyper.png"></p>
<center style="color: #666;">
<p>While not ideal to compute, our hyperbola did in fact find the same potential solutions.</p>
</center>

<p>Also, notice how we only used information about where the supposed <span style="color:purple">solution</span> $\color{purple}{z}$ to find our quartic; we never specified any conditions for where the <span style="color:red">light</span> $\color{red}{a}$ or <span style="color:green">target</span> $\color{green}{b}$ had to be! This means we can have our <span style="color:red">light</span> and <span style="color:green">target</span> on the <em>inside</em> of our circular mirror and find points that satisfy the Law of Reflection.</p>
<p><img src="/img/secure-squares/alhazenInside2.png"></p>
<center style="color: #666;">
<p>A valid bounce inside a circular mirror.</p>
</center>

<p>The best part is, all 4 of the possible solutions our quartic and hyperbola find are valid! No need to worry about the laser clipping through the mirror randomly; it all works out. </p>
<hr>
<p>While we solved the problem, there are a few details to address that are not completely obvious about this approach using complex numbers.</p>
<h3 id="the-core-4">The Core 4</h3>
<p>Why are there 4 &quot;<span style="color:purple">solutions</span>&quot; according to our polynomial? Being a quartic equation, 4 complex solutions isn&#39;t unexpected, but they don&#39;t seem to have any physical significance for our bouncing laser. Obviously, only one looks like it can reflect our points correctly; how can <em>this</em> be considered a viable spot to aim your laser?</p>
<p><img src="/img/secure-squares/alhazenWrong.png"></p>
<center style="color: #666;">
<p>A supposed &quot;solution&quot; our quartic generates, despite the fact the laser has to phase through the mirror on its way to the target.</p>
</center>

<p>No mirror bounces like that, let alone allow the laser to move straight through it. Moreover, our Law of Reflection looks completely broken, too. What&#39;s happening here? </p>
<p>It lies in the direction of our vectors. Watch what happens as I extend the line segment from the <span style="color:green">target</span> to the &quot;<span style="color:purple">solution</span>&quot;.</p>
<p><img src="/img/secure-squares/alhazenWrongExt.png"></p>
<center style="color: #666;">
<p>If we extend the ray from the  <span style="color:green">target</span> to the &quot;<span style="color:purple">solution</span>&quot;, we can get a <span style="color: rgb(0,50,0)">&quot;mirrored target&quot;</span>, kind of like what we did for the straight wall case.</p>
</center>

<p>If we extend the ray, then it&#39;s clear that the Law of Reflection is satisfied, and this is true for the 3 other supposed &quot;<span style="color:purple">solutions</span>&quot;: every &quot;bad&quot; reflection point is correct if the rays are extended far enough. So the 4 &quot;<span style="color:purple">solutions</span>&quot; correspond with how are vectors are lined up, since if we change the direction of our light bouncing we can get different points where the Law of Reflection is satisfied.</p>
<p>That doesn&#39;t answer, though, how we know which point to pick as the &quot;correct&quot; reflection point? If you read the previous post on <a href="http://xperimex.com/blog/retroreflectors/">retroreflectors</a>, then you know light takes the fastest and (<a href="https://en.wikipedia.org/wiki/Brachistochrone_curve">only in this case</a>) shortest path. So, we just pick the point where the total distance of the light&#39;s path is minimized: $\min(|\color{purple}{z} - \color{red}{a}| + |\color{purple}{z} - \color{green}{b}|)$</p>
<h3 id="to-be-on-the-circle-or-not-to-be-on-the-circle-">To be (on the circle), or not to be (on the circle)</h3>
<p>Some of you might be wondering why this should produce <em>any</em> solutions on the unit circle—let alone 4 at that. That is in part by the property we have mentioned a few times: $\color{purple}{z} \cdot \overline{\color{purple}{z}} = 1$. If the geometry of this isn&#39;t obvious to you with the rotations and scalings, we can turn this into Cartesian coordinates by setting $\color{purple}{z}=x+yi$, we get that</p>
<center>
$\begin{align}
z \cdot \overline{z} &amp; = 1 \
\newline
(x+yi) \cdot (x-yi) &amp; = 1 \
\newline
x^2 - xyi + xyi + y^2 &amp; = 1 \
\end{align}$

<br>
<br>

$\large{x^2 + y^2 = 1}$
</center>

<p>Which is precisely the equation for the unit circle. The property that $\color{purple}{z} \cdot \overline{\color{purple}{z}} = 1$ forces $z$ to be on the unit circle.</p>
<p>…for the most part. The proof I&#39;ve highlighted is adapted from <a href="https://link.springer.com/article/10.1007/s40315-018-0257-z">this paper</a>. As it shows, if you have the  <span style="color:red">light</span> at $\color{red}{a}=.5+.5i$ and a <span style="color:green">target</span> at $\color{green}{b}=.5+0i$, two of the supposed solutions for $\color{purple}{z}$ are completely off the unit circle. </p>
<p><img src="/img/secure-squares/alhazenBreak.png"></p>
<center style="color: #666;">
<p>When $\color{red}{a}=.5+.5i$ and $\color{green}{b}=.5+0i$, one supposed reflection point is on the inside of the circle, and the other is so far outside of the circle its offscreen.</p>
</center>

<p>I&#39;m not totally sure why this happens, but the previously linked <a href="https://link.springer.com/article/10.1007/s40315-018-0257-z">paper</a> proves that at least two of the generated <span style="color:purple">solutions</span> must be on the unit circle.</p>
<hr>
<p>If you want to look at this problem more, there is also an <a href="https://www.jstor.org/stable/27968003">algebraic solution</a>, here there are ideas involving <a href="https://www.youtube.com/watch?v=4KHCuXN2F3I">tangent ellipses</a> in this <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.48.4794&amp;rep=rep1&amp;type=pdf">paper</a>, and there&#39;s even an approach discussed in Dorrie&#39;s <a href="http://mylibrary.website/books/100_Great_Problems_of_Elementary_Mathematics_Heinrich_Dorrie_Dover_2_Math.pdf"><em>100 Great Problems of Elementary Mathematics</em></a>. These would be my recommended starting points. For even more depth, this is a solution involving <a href="http://www.math.sjsu.edu/~alperin/Alhazen.pdf">origami</a> (yes, the paper folding) and here&#39;s the <a href="https://www.semanticscholar.org/paper/Alhazen%E2%80%99s-hyperbolic-billiard-problem-Poirier-Mcdaniel/e03af90f6ed37f42d0ed4edc836dd1173e69e5eb">same problem in hyperbolic space</a>.</p>
<!-- **INSERT SOMEWHERE INTERACTIVE JAVASCRIPT ALHAZEN SOLVER** -->
<hr>
<p>Now that we&#39;ve seen where billiard problems started, let&#39;s see how far they&#39;ve come with the main focus of today&#39;s post.</p>
<h2 id="get-down-mr-president-">Get Down Mr. President!</h2>
<p>You and an assassin are trapped in a square room. With a single bullet, the assassin wants to do everything he can to take you out without wasting his shot. You, however, came prepared and hired a bodyguard to prevent direct line of sight between you and the assassin. But remember, you&#39;re trapped in a room. Without hesitation, the assassin flicks a shot to the side and ricochets off the wall and grazes your arm, avoiding the bodyguard completely. You might have been lucky this time, but who knows what happens next.</p>
<p><strong>If you (<span style="color:green">target</span>) and an <span style="color:red">assassin</span> are placed in a square room, can you hire a finite number of <span style="color:blue">bodyguards</span> to prevent any shot from hitting you (including ricochets)?</strong></p>
<p>At first glance, this might seem absurd. There are an infinite number of ways for the assassin to line up and bounce his shot, so how can anything less than an infinite number of bodyguards suffice? As one might anticipate, this wouldn&#39;t be a blog post if it didn&#39;t have an incredible answer. </p>
<center>
<div id="secureSquareIntro"></div>
</center>
<center style="color: #666;">
<p>Can you hit the <span style="color:green">target</span> with the <span style="color:red">assassin</span>&#39;s shot despite the <span style="color:blue">bodyguards</span>? Drag the <span style="color:red">assassin</span> and <span style="color:green">target</span> points to move them, and press the <i>3</i> key to lock the angle.</p>
</center>

<p>It&#39;s no coincidence I placed the <span style="color:blue">bodyguards</span> where I did in the above widget; not only does a finite number of bodyguards make do, you can prove you only need to hire <strong>16</strong> to ensure 100% protection!</p>
<p>I first found this problem through <a href="https://youtu.be/a7gp9c2p0UQ">Tai-Danae Bradley&#39;s video</a> and <a href="https://www.math3ma.com/blog/is-the-square-a-secure-polygon">post</a>, where she writes up the proof very well on her own. It was this problem that inspired me to look for other problems to extend this post, and moreover it was a fun <a href="">programming challenge</a>. Here, I want to outline the proof with the key insights Bradley utilizes, as well as pose a few other questions of my own.</p>
<p>Just as we did before, let&#39;s clarify some problem details:</p>
<ul>
<li>Just like before, the <span style="color:red">assassin</span>&#39;s bullet is a pure <strong>ray</strong>, and the <span style="color:green">target</span> has been reduced a to 0-dimensional <strong>point</strong>.</li>
<li>Now, though, we have <span style="color:blue">bodyguards</span>, which are 0-dimensional points as well; if they are going to protect the <span style="color:green">target</span>, they have to fully take the hit.</li>
<li>Lastly, just to make it clear, this is a perfectly square room and the bullet ricochets at exact angles off the walls, so the <span style="color:red">assassin</span>&#39;s shot can bounce forever if needed to hit its mark.</li>
</ul>
<h3 id="the-tiling-torus">The Tiling Torus</h3>
<p>Let&#39;s look at an easy case: what if the assassin can only reflect off the left wall? Since this is a square room with straight walls, we can use our reflection trick from before. Now, though, we have to analyze the <span style="color:green">target</span>&#39;s position in space <em>relative</em> to the room. </p>
<center>
<div id="roomOneWall"></div>
</center>
<center style="color: #666;">
<p>By reflecting the room, we create a &quot;mirrored world&quot; to track our reflection.</p>
</center>

<p>I&#39;ve color-coded the left, right, top, and bottom walls to be <span style="color:rgb(255,200,0)">yellow</span>, <span style="color:gray">gray</span>, <span style="color:magenta">magenta</span>, and <span style="color:cyan">cyan</span> respectively. The reason if we want to track the <span style="color:green">target</span>&#39;s location within the room even after the reflection, we have to reflect the room itself too, creating an actual &quot;mirror world&quot; that I referred to earlier.</p>
<p>Ok, so that isn&#39;t too different than what we&#39;ve already been doing, so what&#39;s the point? The magic lies in modelling <em>multiple</em> bounces. Remember, we reflected over the <span style="color:rgb(255,200,0)">yellow</span> wall to say we wanted our bounce to be off that wall, but we can chain these reflections to give multiple instructions to our bounces. If we first reflect over the <span style="color:rgb(255,200,0)">yellow</span> wall and <em>then</em> the <span style="color:magenta">magenta</span> wall, we create a doubly mirrored world with our straight line showing the path of what 2 bounces looks like. </p>
<center>
<div id="roomTwoWall"></div>
</center>
<center style="color: #666;">
<p>Reflecting over a second wall gives us another straight-line intersection to find our first and therefore second reflection point too.</p>
</center>

<p>If you want to convince yourself this trick works for multiple bounces, I recommend finding the congruent angles within the mirrored world&#39;s straight line and the actual bounces within the room in question.</p>
<p>An important part of finding this mirrored world&#39;s straight line though is the fact that it intersects the colored walls in the order the <span style="color:red">assassin</span>&#39;s bullet bounces. In the initial setup provided, the straight line hits the <span style="color:rgb(255,200,0)">yellow</span> wall first before intersecting the <span style="color:magenta">magenta</span> wall, just as the beam&#39;s bounce path reflects off the <span style="color:rgb(255,200,0)">yellow</span> then <span style="color:magenta">magenta</span> walls <em>in that order</em>. If you move the <span style="color:red">assassin</span> and <span style="color:green">target</span>, you can see this idea holds for a <span style="color:magenta">magenta</span> then <span style="color:rgb(255,200,0)">yellow</span> wall bounce too.</p>
<p>So, if we wanted to model the <span style="color:red">assassin</span>&#39;s hitting the <span style="color:green">target</span> in more bounces, we just reflect our room more times and draw the straight line between the <span style="color:red">assassin</span> and <span style="color: rgb(0,50,0)">mirrored target</span>.</p>
<center>
<div id="roomSevenWall"></div>
</center>
<center style="color: #666;">
<p>Even with many more reflections of the room, our bullet still bounces off the colored walls in the order our straight line intersects them. Try dragging both the <span style="color:red">assassin</span>, <span style="color:green">target</span>, and <span style="color: rgb(0,50,0)">mirrored target</span> to see how the paths change. Note these are only paths that result in the <span style="color:red">assassin</span> successfully hitting the <span style="color:green">target</span>.</p>
</center>

<p>Moreover, since squares can tile the plane maintain the same &quot;silhouette&quot; under reflection, we can infinitely tile the plane with reflected copies of our room. Since a line through this plane can represent any bounce shot from the assassin in the original room, we have successfully simplified our problem setup. Why? With straight lines, we can now use coordinate geometry to place our bodyguards and not worry about annoying reflectedl light patterns within our square.</p>
<p>In more math-y terms, we have turned our original room into what is known as a <strong>flat torus</strong> (yes, the thing that&#39;s equal to a coffee cup). Essentially, all this means is that our problem sort of exists in a world similar to the game of <em>Asteroids</em>: as you exit the top or left of one flat torus, you enter through the bottom or right of another one (and vice versa). This fact is what allows us to tile the plane consistently with our problem setup. If you look back at the 2-by-2 grid setup from before modelling the 2-bounce paths, you&#39;ll see that our top/bottom edges are both <span style="color:cyan">cyan</span> and our left/right edges are both <span style="color:gray">gray</span>, showing that exact relationship we&#39;d expect in a flat torus.</p>
<p><img src="/img/secure-squares/squareToTorus.gif"></p>
<center style="color: #666;">
<p>Connecting opposite edges of a square turns it into the equivalent of a torus.</p>
</center>

<p>This is the first key insight to solving this problem: turning our bouncing shots into straight lines in an infinitely tiled plane. Working with straight lines makes life so much easier than bent ones. With that, we can move on to the second epiphany to prove our result.</p>
<h3 id="the-different-core-4">The (Different) Core 4</h3>
<p>Even though we tile the plane infinitely, there aren&#39;t an infinite type of rooms. Just looking at our 2-by-2 grid that makes our flat torus shows us everything we need to know: there are exactly 4 types of rooms that build our tiling: the original one, the one reflected over the <span style="color:rgb(255,200,0)">yellow</span> wall, the one reflected over the <span style="color:magenta">magenta</span> wall, and the one reflected over <span style="color:rgb(255,200,0)">both</span> <span style="color:magenta">walls</span>. This regularity is clear visually: watch what happens if I reflect the <span style="color:green">target</span> into every mirrored room.</p>
<center>
<div id="secureLattice"></div>
</center>
<center style="color: #666;">
<p>Having 4 &quot;unique&quot; rooms generates 4 unique lattices of mirrored targets.</p>
</center>

<p>Each one of the reflected rooms generates a lattice of that reflected target! I&#39;ve colored the 4 different lattices in <span style="color:rgb(0,50,0)">green</span>, <span style="color:rgb(255,200,0)">yellow</span>, <span style="color:magenta">magenta</span>, and <span style="color:cyan">cyan</span>. Now, since each dot represents a way of hitting our <span style="color:green">target</span>, we just need to block every line from the <span style="color:red">assassin</span> to any one of these colored dots.</p>
<p>This is the second critical idea to finish out this proof: every reflected target falls into 1 of 4 possible lattices (each represented by a color). Dividing the mirrored targets into lattices is nice since it places all dots in a given lattice to be the same distance away from each other. </p>
<p>At this point, you have everything you need to finish this proof using the flat torus tiling and the 4 lattices. If you want to try and finish it through, I recommend doing so as it has some pretty satisfying reasoning throughout it. If you just want to keep reading, I&#39;d recommend visiting <a href="https://www.math3ma.com/blog/is-the-square-a-secure-polygon">Bradley&#39;s post</a> where she completes the proof there.</p>
<p>Once you reach the end of the proof, you&#39;ll find that you need exactly 4 bodyguards to protect any given lattice, and since there are 4 lattices, we need $4 \cdot 4 = 16$ bodyguards total to completely protect the <span style="color:green">target</span>.</p>
<center>
<div id="secureSquare"></div>
</center>
<center style="color: #666;">
<p>No matter where the <span style="color:red">assassin</span> shoots, the <span style="color:green">target</span> remains safe and sound. Try moving either of them around, and watch the bodyguards adapt and reduce the <span style="color:red">assassin</span>&#39;s efforts to nil.</p>
</center>

<p>Since it is possible to protect the <span style="color:green">target</span> from the <span style="color:red">assassin</span> with a finite number of <span style="color:blue">bodyguards</span>, we can say that the square is a <strong>secure polygon</strong>.</p>
<h2 id="what-next-">What Next?</h2>
<p>This is one of the most surprising facts I&#39;ve come across in a long time. But, there&#39;s more places to take these billiard problems and dynamical systems. One of the first extensions I thought of upon seeing this was other grids. <a href="http://xperimex.com/blog/grid-polygons/">As we know</a>, there are also hexagonal and triangular grids in addition to the square one we analyzed today.</p>
<p><div id="trihex_grid" style="flex: 2; position: relative;"></div></p>
<script src="/js/grid-polygons/trihex_grid.js"></script>
<center style="color: #666;">
<p>Examples of triangular (left) and hexagonal (right). Are they secure polygons?</p>
</center>

The regular triangle and hexagon seemed like the natural progression since they play nicely with reflections and tiling the plane, so they seemed like good candidates to explore next. But for anyone who's dabbled in linear algebra and transformations knows that reflections are only commutative if the axes are perpendicular. That's why squares worked well for tiling the plane since no matter what the order of the walls you reflected the <span style="color:green">target</span> over was, you'll get exactly one, unique "<span style="color:rgb(0,50,0)">mirrored target</span>" per reflected room. For triangles and hexagons, though, you <i>don't</i>, and that's an issue (superficially, at least; if anything, annoying). 

<br><br>

Not to mention, every other regular polygon doesn't tile the plane, so modelling their bouncing paths will be even more difficult. What about non-regular polygons? Or concave ones? This is definitely something I'll revisit in the future and try to find the conditions for a polygon to be secure, but until then, we have just scraped the surface of billiard problems and dynamical systems.

<hr>

A few other, related problems to consider. While we only looked at rays for light sources, others have considered other types of light sources. In an <a href="https://en.wikipedia.org/wiki/Illumination_problem">Illumination Problem</a>, we consider point sources (i.e. light source that produces light in every direction instead of one). Actually, we've already looked at one type of Illumination Problem: the secure square! It can be rephrased as the the following: if a light bulb is placed in a mirror room, is it possible to place a finite number of pillars such that a given spot is never illuminated? It's idential to our secure polygon question. One of my favorite Illumination Problems is the <a href="https://en.wikipedia.org/wiki/Art_gallery_problem">Art Gallery Problem</a>, which is not only a readily applicable problem, but also has a wonderfully elegant proof that Steve Fisk conjured (it speaks volumes how nice this proof is for it to be in Martin Aigner's <a href="https://www.amazon.com/Proofs-BOOK-Martin-Aigner-dp-3662572648/dp/3662572648/ref=mt_other?_encoding=UTF8&me=&qid="><i>Proofs from THE BOOK</i></a>). Here's a great, <a href="https://math.mit.edu/~apost/courses/18.204_2018/Nicole_Chesnokov_paper.pdf">in-depth paper</a> I found discussing this famous problem along with some proofs and extensions as well.

<br><br>

Even outside of classic billiard problems, even just knowing of the simple reflection technique to model bounces is invaluable. Grant Sanderson of 3blue1brown fame used bouncing light as an analogy to solve a <a href="https://www.youtube.com/watch?v=brU5yLm9DZM">kinematics problem</a> and bring in circles almost magically. I've said it before, and I'll say it again: duality and different perspectives are some of the most powerful problem solving tools you can have. This small reflection technique, or the complex number algebra with Alhazen's problem, might not mean much to you now, but it's another tool to stow away in your back pocket. Despite only seeing this ability to turn dynamics into geometry, I've seen them enough to know that these techniques and ideas are more than just an intriguing fact. You'll never know when you might be able to use such a tool, but when you do, who knows the new worlds that a new paradigm can unlock for you.

<hr>

If you're interested in learning a bit behind today's graphics and widgets, see the <a href="">follow up</a> I wrote up detailing some seemingly innocuous math with some high-budget applications and cool patterns.


<script src="/js/secure-squares/billiardIntroInstance.js"></script>
<!-- <script src="/js/secure-squares/billiardSolved.js"></script> -->
<script src="/js/secure-squares/billiardSolvedInstance.js"></script>


<!-- <script src="/js/secure-squares/alhazenIntroInstance.js"></script> -->
<script src="/js/secure-squares/alhazenIntro.js"></script>


<script src="/js/secure-squares/roomOneWall.js"></script>
<script src="/js/secure-squares/roomTwoWall.js"></script>
<script src="/js/secure-squares/roomSevenWall.js"></script>

<script src="/js/secure-squares/secureLattice.js"></script>



<script src="/js/secure-squares/secureSquareIntro.js"></script>
<script src="/js/secure-squares/secureSquare.js"></script>
]]></description>
         <link>http://xperimex.github.io/blog/secure-squares</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/secure-squares</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Circle Computations and Raytracing Remedies]]></title>
         <description><![CDATA[Basically, Pixar should hire me 

 <script src="//cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/g9/1.0.16/g9.js'></script>
<script src="https://www.desmos.com/api/v1.5/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>


<p>Last post, we looked at different types of <a href="http://xperimex.com/blog/secure-squares/">billiard problems</a>, a class of math problems analyzing how light bounces with different setups of mirrors. Notably, we saw how straight lines make for very simple, easy to compute mirrors, while others like <a href="https://en.wikipedia.org/wiki/Alhazen%27s_problem">circular ones</a>, can be incredibly frustrating. </p>
<p>A large portion of last post&#39;s content, though, was made up of interactive graphics. While I went over much of the math that goes into <em>solving</em> these types of problems, we skipped over a large part of the math that goes into <em>simulating</em> them. Math is very nice in that many problems can be solved with nothing more than a pen, paper, and your mind, but oftentimes, that&#39;s only helpful if you are confident in how to approach the problem. What computer&#39;s can do is help build our intuition to solve a problem by calculating, drawing, and modelling scenarios with precision and speed we can only wish to achieve.</p>
<p>So, today, we&#39;ll look at some of the clever math that goes into computer graphics (that we&#39;ll later extend), and to introduce such a topic, we&#39;ll look at a simple, fundamental problem in graphics: how do you find the intersection between a line and a circle?</p>
<h2 id="languishing-lines-and-confounding-circles">Languishing Lines and Confounding Circles</h2>
<p>Before we can even attempt this problem, we&#39;re going to have to start from scratch, since we have one <em>slight</em> issue: a computer has no idea what a line or a circle is! So before we can do anything, let&#39;s teach our computer how to draw a line.</p>
<h3 id="perfect-parameterizations">Perfect Parameterizations</h3>
<p>At its core, computer graphics is displaying a set of pixels with certain colors. If we want to visualize anything on a computer screen, we just need to find all the relevant pixels (coordinates) to light up and color. Because we want to compute these individual coordinates of, say, a line or circle very quickly and easily, almost always we will use <strong>vectors</strong>. These can be typical column or row vectors you see in linear algebra, or it can even take the form of complex numbers. The reason why these tend to be helpful is that they give very easy ways to compute coordinates for lines, circles, and other shapes.</p>
<p>If we want to draw a line with slope, say 2, we need to ensure that it is constructed by a vector of slope 2. An easy one to find is the vector $v=\small{\begin{bmatrix} 1 \\ 2 \end{bmatrix}}$ since we know that will pass through the point $(1,2)$. So, to get other points beyond this vector, we can scale $v$ by a factor of $t$ to get other vectors (i.e. points) with the same slope. If $t=2$, we get the point $(2,4)$. If $t=1.5$, we get the point $(1.5,3)$. If $t=239470$, we get the point $(239470,478940)$. Whatever you choose $t$ to be, our vector $v$ will give us a point on the line $y=2x$.</p>
<p>However, this isn&#39;t super helpful, since we are still only restricted to lines that go through the origin at $(0,0)$. So, we can add a starting point $\color{red}{p}$ to our vector equation to offset the line by $\color{red}{p}$, guaranteeing our line goes through the point $\color{red}{p}$ (since that&#39;s the coordinate generated by $t=0$).</p>
<center>
$\large{l = \color{red}{p} + tv}$
</center>

<p>Now we just plot every point for $t \in (-\infty, \infty)$, and we get a line with $v$ dictating the slope of our line (negative $t$ values gives us coordinates <em>behind</em> $\color{red}{p}$)!</p>
<center>
<div id="line"></div>
</center>
<center style="color: #666;">
<p>Our parametric line $l$ going through point $\color{red}{p}$. Drag the point to adjust it&#39;s position.</p>
</center>

<p>We can do a similar process for a circle. To parameterize a circle, we&#39;ll have to pull from trigonometry. We know that a circle is defined by $x^2 + y^2 = r^2$. The Pythagorean identity tells us that $\cos^2(\theta) + \sin^2(\theta) = 1$, so we can quickly make the connection that $x=r\cos(\theta)$ and $y=r\sin(\theta)$ (which the geometry justifies). This precisely defines $x$ and $y$ in terms of the parameter $\theta$! Again, though, this is centered at the origin, so we can center the circle around a point $\color{blue}{q}$ by adding it to our parameterization.</p>
<center>
$\large{c = \color{blue}{q} + r\begin{bmatrix} \cos(\theta) \\ \sin(\theta) \end{bmatrix}}$
</center>

<p>where $r$ is some real number for the radius of the circle, and $\theta \in [0, 2\pi)$. We can now easily draw both lines and circles!</p>
<center>
<div id="circle"></div>
</center>
<center style="color: #666;">
<p>Now we also have a circle centered at $\color{blue}{q}$ too. Drag the center point to change its position, and the radial point its radius.</p>
</center>


<h2 id="collisions-and-intersections">Collisions and Intersections</h2>
<p>Now that we have defined our line and circle for our computer to interpret, we can start thinking about how to detect collisions between a line and a circle. </p>
<h3 id="discerning-distances">Discerning Distances</h3>
<p>A good place to start is by looking at how far away the line $l$ is from the center of the circle $\color{blue}{q}$. For reference, the distance from a point to a line is the shortest (i.e. perpendicular) distance from the point to the line. If $l$ is more than a distance of $r$ away from $\color{blue}{q}$, then we know that it&#39;s outside the circle and doesn&#39;t intersect, and if $l$ is less than a distance $r$ away from $\color{blue}{q}$, then we know it&#39;s inside the circle and does intersect.</p>
<p><img src="/img/circle-computations/circleIntersectExample.png"></p>
<center style="color: #666;">
<p>$l_1$ is a distance less than $r$ away from the center, and clearly intersects the circle. $l_2$ is a distance greater than $r$ away, and clearly does not intersect the circle. $l_3$ is exactly a distance $r$ away, making it tangent to the circle (1 intersection point instead of 2).</p>
</center>

<p>Let&#39;s look at an individual line and see if we can draw any useful conclusions about this distance.</p>
<p><img src="/img/circle-computations/circleIntersectDist.png"></p>
<p>From a given point $\color{red}{p}$ on our line $l$, we can find a new vector between $\color{red}{p}$ and the circle&#39;s center $\color{blue}{q}$ as $\overrightarrow{\color{blue}{q} - \color{red}{p}}$. This will form some angle $\theta$ with $l$, more specifically its vector $v$. Recalling that $\color{green}{d}$ is the perpendicular distance between $\color{blue}{q}$ and $l$, we have a right triangle that gives us that $\color{green}{d} = |\overrightarrow{\color{blue}{q} - \color{red}{p}}| \sin \theta$.</p>
<p>If you&#39;re familiar with your linear algebra, this almost looks like the formula for the magnitude of the cross product: $|v \times u| = |v||u|\sin \theta$. So, writing our two relevant vectors and rearranging we can see that…</p>
<center>
$|\overrightarrow{\color{blue}{q} - \color{red}{p}}||v| \sin \theta = |\overrightarrow{\color{blue}{q} - \color{red}{p}} \times v|$
<br />
$|\overrightarrow{\color{blue}{q} - \color{red}{p}}| \sin \theta = |\overrightarrow{\color{blue}{q} - \color{red}{p}} \times \frac{v}{|v|}|$
</center>

<p>So all we need to do to see if our line intersects our circle is if that cross product is less than or equal to the radius of our circle (if you&#39;re concerned about the dimensionality of our vectors—cross products only exist in dimensions 3 and 7—we can treat them as 3D vectors with z-component 0, which makes the calculation easier and equivalent to the determinant). </p>
<p>If this isn&#39;t totally apparent why this is true, it has to do with the <a href="https://en.wikipedia.org/wiki/Cross_product#Geometric_meaning">geometrical interpretation</a> for the cross product: we&#39;re finding the area of the parallelogram that the two vectors span, and since the area of a parallelogram is $A=\textrm{base}\cdot\textrm{height}$, we&#39;re essentially finding the height of that parallelogram by dividing by its base.</p>
<center>
<div id="crossProduct"></div>
</center>
<center style="color: #666;">
<p>Using the closest distance between the circle and line, we can successfully identify when the line intersects our circle.</p>
</center>

<p>We have a working condition! Using the cross product, we can identify point-circle intersections with a single line of computation. However, this simple solution does have its limitations. Mainly, this is only a <strong>boolean</strong> condition; this method only tells us whether or not an intersection occurs, but nothing else. We don&#39;t know where on the line it intersects, nor how many times. Sometimes, this doesn&#39;t really matter like when you want to approximate lines intersecting points (since then you can treat points as small circles). But for more complex tasks and graphics like raytracing, this won&#39;t cut it.</p>
<h3 id="fancy-vector-operations">Fancy Vector Operations</h3>
<p>If we have a point $x$ on our circle, then the distance between $x$ and the center of the circle $\color{blue}{q}$ should be equal to the radius $r$. As an equation, the magnitude of the vector from $x$ to $\color{blue}{q}$ equals $r$.</p>
<center>
$|x - \color{blue}{q}| = r$
</center>

<p>Moreover, we want this point $x$ on our circle to also be on our line $l$. So, $x = \color{red}{p} + tv$ for some value of $t$. With this in mind, we can substitute $x$ in our previous equation.</p>
<center>
$|\color{red}{p} + tv - \color{blue}{q}| = r$
</center>

<p>Now, let&#39;s square both sides.</p>
<center>
$|\color{red}{p} + tv - \color{blue}{q}|^2 = r^2$
</center>

<p>This may seem pointless, but it helps us rewrite that left side of the equation. Generally, working with the magnitude of a vector as an operator isn&#39;t super helpful, but we can quickly rewrite the <em>square</em> of the magnitude in terms of the dot product, since for any vector $v \cdot v = |v|^2$. </p>
<center>
$(\color{red}{p} + tv - \color{blue}{q}) \cdot (\color{red}{p} + tv - \color{blue}{q}) = r^2$
</center>

<p>Expanding this out and collecting like terms gives us…</p>
<center>
$(\color{red}{p} + tv - \color{blue}{q}) \cdot (\color{red}{p} + tv - \color{blue}{q}) = r^2$
<br>
$t^2(v \cdot v) + 2t(v \cdot (\color{red}{p} - \color{blue}{q})) + (\color{red}{p} - \color{blue}{q}) \cdot (\color{red}{p} - \color{blue}{q}) - r^2 = 0$
</center>

<p>Which is just a quadratic equation in $t$! With coefficients…</p>
<center>
$\begin{align}
a &amp; = v \cdot v \
\newline
b &amp; = 2(v \cdot (\color{red}{p} - \color{blue}{q})) \
\newline
c &amp; = (\color{red}{p} - \color{blue}{q}) \cdot (\color{red}{p} - \color{blue}{q}) - r^2
\end{align}$
</center>

<p>…we can solve for $t$ using our trusted quadratic formula (note that $a$, $b$, and $c$ are all outputs of dot products, ensuring they are valid scalars to plug in).</p>
<center>
$\large{t = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}}$
</center>

<p>Remember, $t$ is the scalar that tells us where on our line we are, so if there are real solutions to $t$, then we will have the exact intersection points for our line and the circle!</p>
<center>
<div id="basicRaytrace"></div>
</center>
<center style="color: #666;">
<p>Our quadratic formula now not only tells us when the line intersects the circle, but also <em>where</em> they intersect.</p>
</center>

<p>We can analyze this quadratic like any other to give us insight into our intersection points. Specifically, using the discriminant. When $b^2 - 4ac &gt; 0$, then we get two solutions/intersection points. If $b^2 - 4ac &lt; 0$, then we get no real solutions and therefore no intersection points. Finally, if $b^2 - 4ac = 0$, then we have exactly one intersection point, and can conclude our line is tangent to the circle.</p>
<p>Also, this quadratic can straight up replace our closest-distance method from before, since the point at which our line is closest to the circle corresponds to the vertex of the parabola at $t=\frac{-b}{2a}$.</p>
<p>Not to mention, notice how everything we did here was independent of the fact our line and circle exist in two dimensions; we can easily use this for 3D graphics, and even higher dimensions as well to find the intersections between lines and hyperspheres! Below is a raytraced scene I drew of 3 balls using this exact quadratic to compute lighting with shadows and reflections (a.k.a. my formal application to Pixar).</p>
<p><img src="/img/circle-computations/rayTracedEx.png"></p>
<center style="color: #666;">
<p>This raytraced scene is just thousands of uses of the quadratic formula.</p>
</center>

<p>And to think that we&#39;d never use the quadratic formula in real life. </p>
<h2 id="i-don-t-know-where-else-to-put-this">I Don&#39;t Know Where Else to Put This</h2>
<p>Before I end off this post, I want to include some other interesting circle facts since I don&#39;t know where else to put them.</p>
<h3 id="squaring-the-circle-bounces-">Squaring the Circle (Bounces)</h3>
<p><strong>If you have a ray of light start from the circumference of the circle, after a total of $n$ reflections within the circle, the sum of all the angles of reflection will be $n^2$ times the initial angle.</strong></p>
<p>Between this and the <a href="https://en.wikipedia.org/wiki/Basel_problem">Basel problem</a>, circles and squares are just weirdly intertwined. The reason this particular statement is true is because of how much the angle with the horizontal increases after a single bounce. If your light starts at an angle $\alpha$, we can show that every additional bounce will add $2\alpha$ to the angle with respect to the horizontal.</p>
<p><img src="/img/circle-computations/oddBounce.png"></p>
<p>With the help of some auxiliary lines, I hope the above picture makes this clear. Then by symmetry, of the circle, we can see that each subsequent bounce will also add $2\alpha$ to the angle. Moreover, since our initial angle itself is $\alpha$, every bounce will just be the odd multiples of $\alpha$ (since odd numbers can be thought of as a multiple of 2 plus 1, which is precisely what our angle bounces mimic)! So, for a series of $n$ bounces, the sum of the angles of each reflection is equal to </p>
<center>
$\begin{align}
\alpha + 3\alpha + 5\alpha + 7\alpha + … + (2n-1)\alpha &amp; = \
\newline
\alpha(1+3+5+7+…+2n-1)&amp; = \
\newline
\alpha(n\cdot 1 + 2(0+1+2+3+…+n-1)&amp; = \
\newline
\alpha(n + 2\cdot\frac{(n-1)(n)}{2}) &amp; = \
\newline
\alpha(n + n^2 - n) &amp; = \alpha n^2
\end{align}$
</center>

<p>(Yes I am aware there is a formula for an arithmetic sequence with with any initial term but this is how I remember to solve them okay) I didn&#39;t know how to fit it in last post with the mention of circular mirrors there, but here seems like a good spot to mention it.</p>
<h3 id="perpendicular-parabolas">Perpendicular Parabolas</h3>
<p><strong>The set of intersection points between two orthogonal parabolas lie on a common circle.</strong></p>
<center>
  <div id="intro" style="width: 660px; height: 570px;"></div>

  <script src="/js/circle-computations/orthogonalParabolas.js"></script>
</center>

<p>To show this is true, we just need to crank out the algebra. To find our intersection points, we need to solve the system of equations</p>
<center>
$\begin{cases}
(x - \color{red}{x_1})^2 = y - \color{red}{y_1} \
\newline
(y - \color{blue}{y_2})^2 = x - \color{blue}{x_2}
\end{cases}$
</center>

<p>If these individual equations are true for our intersection points, then so is their sum.</p>
<center>
$(x - \color{red}{x_1})^2 + (y - \color{blue}{y_2})^2 = y - \color{red}{y_1} + x - \color{blue}{x_2}$
<br>
$x^2 - x(2\color{red}{x_1}) + \color{red}{x_1}^2 + y^2 - y(2\color{blue}{y_2}) + \color{blue}{y_2}^2 = y - \color{red}{y_1} + x - \color{blue}{x_2}$
<br>
$x^2 - x(2\color{red}{x_1} + 1) + y^2 - y(2\color{blue}{y_2} + 1) = -\color{red}{y_1} - \color{red}{x_1}^2 - \color{blue}{x_2} - \color{blue}{y_2}^2$
<br>
$(x - (\color{red}{x_1} + \frac{1}{2}))^2 - (\color{red}{x_1} + \frac{1}{2})^2 + (y - (\color{blue}{y_2} + \frac{1}{2}))^2 - (\color{blue}{y_2} + \frac{1}{2})^2 = -\color{red}{y_1} - \color{red}{x_1}^2 - \color{blue}{x_2} - \color{blue}{y_2}^2$
<br>
$(x - (\color{red}{x_1} + \frac{1}{2}))^2 + (y - (\color{blue}{y_2} + \frac{1}{2}))^2 = (\color{red}{x_1} + \frac{1}{2})^2 + (\color{blue}{y_2} + \frac{1}{2})^2  -\color{red}{y_1} - \color{red}{x_1}^2 - \color{blue}{x_2} - \color{blue}{y_2}^2$
</center>

<p>While that last line may seem a bit unruly, note that $\color{red}{x_1}$, $\color{red}{y_1}$, $\color{blue}{x_2}$, and $\color{blue}{y_2}$ are all constants, so the right-hand side of that last equation can be summarized as one big constant.</p>
<center>
$(x - (\color{red}{x_1} + \frac{1}{2}))^2 + (y - (\color{blue}{y_2} + \frac{1}{2}))^2 = C$
</center>

<p>That&#39;s precisely the equation of a circle with a center at $(\color{red}{x_1} + \frac{1}{2}, \color{blue}{y_2} + \frac{1}{2})$ and radius $\sqrt{C}$, and that&#39;s exactly what is plotted above.</p>
<hr>
<p>I have a few more circle tidbits to share, but they have more to expand on in their own posts for another day. </p>
<p>Until then, hopefully you found this slight detour into the world of graphics interesting. There are (as you could imagine) a lot more to graphics I want to share. From image homography, to video textures, to even a more in-depth look into raytracing and rasterization, but we&#39;ll save those for later.</p>
<script src="/js/circle-computations/line.js"></script>
<script src="/js/circle-computations/circle.js"></script>
<script src="/js/circle-computations/crossProduct.js"></script>
<script src="/js/circle-computations/basicRaytrace.js"></script>
]]></description>
         <link>http://xperimex.github.io/blog/circle-computations</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/circle-computations</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Incredible Integrals and Tactful Techniques]]></title>
         <description><![CDATA[Flexible? Maybe. Flex-able. Definitely 

 <p>This will be a slightly more theoretical, conceptual post than the others, but these tricks have that mathematical and problem-solving elegance that is too good not to share. We&#39;ll go over a shortcut for some certain integration by parts problems, and one that allows us to make educated guesses of antiderivatives to find an answer.</p>
<!-- Talk about IBP + C, ansatz, and maybe Feynmann's trick -->
<p>First, let&#39;s take a loot at the integration by parts shortcut.</p>
<h2 id="ibp-but-you-forgot-c">IBP, but You Forgot +C</h2>
<p>This is by far my new favorite trick to pull out of my back pocket whenever I can. It leverages the fact of the innate products built into integration by parts, and the nature of antiderivatives. Though, I&#39;m sure some of us could use a refresher on integration by parts.</p>
<h3 id="to-undo-the-product-rule">To Undo the Product Rule</h3>
<p>When given the product of two functions $f(x)g(x)$, the standard formula to compute its derivative is </p>
<center>
$\frac{\mathrm{d}}{\mathrm{d}x} \ f(x)g(x) = f&#39;(x)g(x) + f(x)g&#39;(x)$
</center>

<p>Now if you integrate both sides and rearrange a little bit we can conclude that</p>
<center>
$\int \frac{\mathrm{d}}{\mathrm{d}x} \ f(x)g(x) = \int f&#39;(x)g(x) \ dx + \int f(x)g&#39;(x) \ dx$
<br>
$\int f(x)g&#39;(x) \ dx = f(x)g(x) - \int f&#39;(x)g(x) \ dx$
</center>

<p>Let $u = f(x)$ and $v = g(x)$ to get that</p>
<center>
$\boxed{ \int u \ dv = uv - \int v \ du \hspace{.2cm} }$
</center>

<p>…which is precisely the integration by parts formula we&#39;ve come to know. It really just is the opposite of the product rule. The main reason why it&#39;s such a useful technique is because if you have a function that&#39;s really hard or you don&#39;t know how to integrate, you can use it as your function $u$ and express its integral purely in terms of its derivative. Let&#39;s try this with an example:</p>
<center>
$\int \ln x \ dx$
</center>

<p>This doesn&#39;t seem like a particularly product-y integral that can leverage integration by parts, but it really is!</p>
<center>
$\int \ln x \ dx = \int 1 \cdot \ln x \ dx$
</center>

<p>Since we don&#39;t want to deal with integrating $\ln x$ (besides, that&#39;s what we&#39;re trying to find anyway), we can set $u = \ln x$ and $dv = 1 \ dx$. Then working it through we get that</p>
<center>
$\int 1 \cdot \ln x \ dx = x \ln x - \int x \cdot \frac{1}{x} \ dx = x \ln x - x + C$
</center>

<p>That&#39;s pretty neat! We were able to reduce a relatively hard integral into one that was much simpler by thinking of it in terms of what product of functions when differentiated would include our original integral. </p>
<p>However, this doesn&#39;t always work by itself, and this is where our integral trick comes into play.</p>
<h2 id="now-remember-your-c">Now, Remember Your +C</h2>
<p>Let&#39;s try a very similar integral from before: </p>
<center>
$\int \ln(x+1) \ dx$
</center>

<p>This doesn&#39;t look too bad, right? It&#39;s basically the same as before. Let&#39;s try the same choice of $u = \ln(x+1)$ and $dv = 1 \ dx$ again and see where it takes us.</p>
<center>
$\int 1 \cdot \ln(x+1) \ dx = x \ln(x+1) - \int x \cdot \frac{1}{x+1} \ dx$
</center>

<p>Aaand there&#39;s our problem. Our supposed simplified integral of $\int v \ du$ ended up with something also annoying: $\int x \cdot \frac{1}{x+1} \ dx$. This isn&#39;t too bad if you&#39;re okay with polynomial division (with this one being relatively easy, too), but it isn&#39;t necessarily trivial. Since we want to avoid doing more work, we can do much better by realizing an overlooked aspect of integration by parts.</p>
<p>We rewrote our original integral in the form of $\int u \ dv$, and later found an antiderivative $v$ from that differential. In our case, we let $dv = 1 \ dx$ and deduced that $v = x$ by undoing the power rule of differentiation. This isn&#39;t <em>wrong</em>, per se, but it is incomplete. The antiderivative of $1\ dx$ isn&#39;t $x$, but $x \ \mathbf{+ \ C}$. Since, remember, the derivative of any constant goes to 0, we can add whatever constant we want to the end of our antiderivative and it&#39;ll still remain valid.</p>
<p>So how can this help us? Well, let&#39;s do the same integral with the same choice of $u$ and $dv$, but instead of letting $v = x$, let&#39;s make $v = x+1$.</p>
<center>
$\int 1 \cdot \ln(x+1) \ dx = (x+1) \ln(x+1) - \int (x+1) \cdot \frac{1}{x+1} \ dx$
</center>

<p>Look at that! That last, previously annoying integral, has become much simpler! Instead of getting two polynomials dividing each other, our new choice of $v$ reduces it to $\int (x+1) \cdot \frac{1}{x+1} \ dx = \int 1 \ dx = x + C$. So, finally, we can conclude that</p>
<center>
$\int \ln(x+1) \ dx = (x+1) \ln(x+1) - x + C$
</center>

<p>In fact, for any choice of a constant $\alpha$, we can see that</p>
<center>
$\int \ln(x+\alpha) \ dx = (x+\alpha) \ln(x+\alpha) - x + C$
</center>

<p>It&#39;s such a simple trick, but an important reminder to remember the basics and fundamentals when attempting a problem. Besides, $+C$ being more than a formality is at least a little bit satisfying.</p>
<h2 id="polynomial-predictions">Polynomial Predictions</h2>
<p>The last integral trick is a bit niche—it relies on that second integral when doing IBP to give a quotient two polynomials of matching degrees. This next shortcut, though, uses this idea of polynomial degree a bit more cleverly, but does not always work. When it does, though, it&#39;s certainly satisfying.</p>
<p>Let&#39;s find the following antiderivative:</p>
<center>
$\int \large{\frac{x^3 + 2x^2 + 3}{\sqrt{x^2 + 3}}}$ $dx$
</center>

<p>This doesn&#39;t look particularly friendly, but we can make some observations about this function. The numerator of our function is a cubic, or a polynomial of degree 3. Similarly, our denominator is the square root of a quadratic, or polynomial degree 2. In the very loose sense of &quot;degree&quot; we can say that asymptotically, the denominator is closer to a degree 1 or linear polynomial (yes, I know that that $\sqrt{x^2} = |x| \neq x$, but just play along for now). So, if we were to carry out all of the polynomial long division, we&#39;d expect our original function to behave like a degree $3 - \frac{2}{2} = 2$ polynomial.</p>
<p>Ok, so what? With basic integration, antidifferentiating a polynomial increases its degree by one. This is just the power rule.</p>
<center>
$\int x^{\color{red}{n}} \ dx = \frac{1}{n+1}x^{\color{red}{n+1}}$
</center>

<p>This fact implies that if our polynomial is loosely of &quot;degree&quot; 2, then integrating it should give us a function of degree $2+1=3$. So, let&#39;s make a guess at what our integral might look like.</p>
<center>
$\int \large{\frac{x^3 + 2x^2 + 3}{\sqrt{x^2 + 3}}}$ $dx = (ax^2 + bx + c)\sqrt{x^2+3}$
</center>

<p>This guess should look somewhat reasonable, since we have a quadratic multiplied by square root of another quadratic, which we loosely said was degree 1. And a polynomial of degree 2 multiplied by a polynomial of degree 1 gives us a polynomial of degree 3, which we wanted. However, you might wonder why we even wrote this as a product; why not just write this out as a pure cubic of $ax^3 + bx^2 + cx + d$? The main reason is expecting the chain rule of some kind to occur. When composing functions, the derivative—and therefore the integral—tend to include the structure of these compositions, so it&#39;s not unreasonable to make a guess with the denominator in the result.</p>
<p>Now here&#39;s the trick: let&#39;s differentiate both sides.</p>
<center>
$\large{\frac{x^3 + 2x^2 + 3}{\sqrt{x^2 + 3}}}$ $= (2ax + b)\sqrt{x^2+3} + (ax^2 + bx + c) \cdot \large{\frac{x}{\sqrt{x^2 + 3}}}$
</center>

<p>If we simplify this expression and expand the right side…</p>
<center>
$\large{\frac{x^3 + 2x^2 + 3}{\sqrt{x^2 + 3}}}$ $= (2ax + b)\sqrt{x^2+3} + (ax^2 + bx + c) \cdot \large{\frac{x}{\sqrt{x^2 + 3}}}$
<br>
$x^3 + 2x^2 + 3 = (2ax + b)(x^2+3) + (ax^2 + bx + c) \cdot x$
<br>
$x^3 + 2x^2 + 3 = 3ax^3 + 2bx^2 + (6a + c)x + 3b$
</center>

<p>For this last equation to hold, we need the coefficients to match.</p>
<center>
$\color{red}{x^3} + \color{blue}{2x^2} + \color{green}{0x} + \color{purple}{3} = \color{red}{3ax^3} + \color{blue}{2bx^2} + \color{green}{(6a + c)x} + \color{purple}{3b}$
</center>

<p>Therefore,</p>
<center>
$\begin{align}
a &amp; = \frac{1}{3} \
\newline
b &amp; = 1 \
\newline
c &amp; = -2
\end{align}$
</center>

<p>Putting it all together, we can go back to our original guess of the antiderivative and find that</p>
<center>
$\int \large{\frac{x^3 + 2x^2 + 3}{\sqrt{x^2 + 3}}}$ $dx = \boxed{\ (\frac{1}{3}x^2 + x - 2)\sqrt{x^2+3} + C \ }$
</center>

<p>There we go! A succcessful antiderivative found.</p>
<p>This is trick is a great first attempt at integrating rational functions, but it is also extremely sensitive to minute changes in the integrand. For example, if we change our integral to</p>
<center>
$\int \large{\frac{x^3 + 2x^2 + \color{red}{3}}{\sqrt{x^2 + 3}}}$ $dx \rightarrow \int \large{\frac{x^3 + 2x^2 + \color{red}{2}}{\sqrt{x^2 + 3}}}$ $dx$
</center>

<p>our algorithm breaks. It&#39;s the cost associated with what makes this algorithm so convenient: we don&#39;t touch the numerator of the integrand at all. Our antiderivative guess only depended on the denominator, and as a result, the coefficients we tried to match at the end had no intrinsic tie to the numerator and thus polynomial we were matching. </p>
<p>This integral shortcut&#39;s convenience is definitely a double-edged sword, but the method behind making these educated guesses is a useful idea in its own right to take away. For more on this type of integration, I recommend reading up on the <a href="https://en.wikipedia.org/wiki/Risch_algorithm">Risch algorithm</a>, a standard in computing indefinite integrals. Here&#39;s also <a href="https://blog.wolfram.com/2021/08/18/new-methods-for-computing-algebraic-integrals/">a very thorough synopsis</a> on evaluating integrals on the Wolfram Blog.</p>
<h2 id="feynman-s-at-it-again">Feynman&#39;s At It Again</h2>
<p>This last integration stratagem comes from none other than the celebrated Richard Feynman of physics fame, and thus has been aptly coined as Feynman&#39;s Intregral Trick.</p>
<p>…as it has been popularized. What I&#39;m about to show has historically been known as the <a href="https://en.wikipedia.org/wiki/Leibniz_integral_rule">Leibniz Integral Rule</a>, or differentiation under the integral sign. Not quite the same ring to it, but nonetheless good to know for accuracy.</p>
<p>Let&#39;s try the following integral:</p>
<center>
$\int_{0}^{1} \large{\frac{x^2 - 1}{\ln x}}$ $dx$
</center>

<p>What we&#39;re about to do might seem insane, but it will be immensely helpful in a second. What we&#39;re going to do is <em>generalize</em> this integral. Let</p>
<center>
$f(\color{red}{t}) = \int_{0}^{1} \large{\frac{x^\color{red}{t} - 1}{\ln x}}$ $dx$
</center>

<p>We&#39;ve replaced the exponent of 2 with a $t$. So, in our new, generalized problem, we want to find $f(2)$. A useful fact also to note is that we know some values of $f(t)$. For example, we know that $f(0)=0$. How does this help? Well, now we can what the name of this trick alludes to—moreso outright says: we&#39;ll differentiate under the integral sign. Let&#39;s take the derivative of $f(t)$ with respect to $t$. </p>
<center>
$\large{\frac{\partial f}{\partial t}}$ $= \large{\frac{\partial}{\partial t}}$ $\int_{0}^{1} \large{\frac{x^{t} - 1}{\ln x}}$ $dx = \int_{0}^{1} \large{\frac{\partial}{\partial t} \frac{x^{t} - 1}{\ln x}}$ $dx = \int_{0}^{1} x^t \ dx$
</center>

<p>That last integral is super easy, only reversing the power rule to calculate.</p>
<center>
$\large{\frac{\partial f}{\partial t}}$ $= \int_{0}^{1} x^t \ dx = \large{\frac{x^{t+1}}{t+1}}$ $|_{0}^{1} = \large{\frac{1}{t+1}}$
</center>

<p>Now that we know the derivative of $f(t)$, we can now integrate this simpler function in terms of known values and use the Fundamental Theorem of Calculus to find $f(2)$. </p>
<center>
$\int_{0}^{2} \partial f = f(2) - f(0) = f(2) = \int_{0}^{2} \large{\frac{1}{t+1}}$ $\partial t = \ln3 - \ln 1 = \boxed{\ln 3 }$
</center>

<p>Note how I used the Fundamental Theorem of Calculus with clever bounds for our integral. You could instead solve the differential equation generally, but the FTC skips shortcuts a few steps. So, after all of that, we can conclude </p>
<center>
$\int_{0}^{1} \large{\frac{x^2 - 1}{\ln x}}$ $dx = \ln 3$
</center>

<p>As counterintuitive as it may seem, solving a general problem can sometimes actually be easier to solve than its individual cases. The best part about this technique, though, is that we haven&#39;t just solved one integral, but a whole <em>family</em> of integrals. For any exponent $\alpha$, we can conclude that</p>
<center>
$\int_{0}^{1} \large{\frac{x^\alpha - 1}{\ln x}}$ $dx = \ln (\alpha + 1)$
</center>

<p>You might have noticed something different with this integral compared to our previous approaches: this applies to <em>definite</em> integrals as opposed to <em>indefinite</em> integrals (or antiderivatives). Namely, because of the fact we have to integrate not once but twice in this method. So, at the following step,</p>
<center>
$\large{\frac{\partial f}{\partial t}}$ $= \int_{0}^{1} x^t \ dx = \large{\frac{x^{t+1}}{t+1}}$ $|_{0}^{1} = \large{\frac{1}{t+1}}$
</center>

<p>if this was not a definite integral, we would end up with a $+C$ attached to the end of it that we would not be able to solve for. </p>
<p>Here&#39;s another application of Feynman&#39;s trick:</p>
<center>
$\int_{0}^{1} \large{\frac{\ln (x+1)}{x^2 + 1}}$ $dx$
</center>

<p>Knowing Feynman&#39;s trick wins you the battle, but knowing <em>how</em> to use it wins you the war. Many times, you have to be creative in your choice of parameter when wanting to differentiate under the integral sign, so don&#39;t be discouraged if it doesn&#39;t work the first time. For this particular integral, we&#39;ll want to consider</p>
<center>
$f(t) = \int_{0}^{1} \large{\frac{\ln (tx+1)}{x^2 + 1}}$ $dx$
</center>

<p>Now, we want to find $f(1)$, and we know that $f(0)=0$. Now let&#39;s differentiate both sides with respect to $t$.</p>
<center>
$\large{\frac{\partial f}{\partial t}}$ $= \int_{0}^{1} \large{\frac{\partial}{\partial t} \frac{\ln (tx+1)}{x^2 + 1}}$ $dx = \int_{0}^{1} \large{\frac{x}{(tx+1)(x^2 + 1)}}$ $dx$
</center>

<p>Decomposing that last integral into its partial fractions yields</p>
<center>
$\large{\frac{\partial f}{\partial t}}$ $= \int_{0}^{1} \large{\frac{x}{(tx+1)(x^2 + 1)}}$ $dx = \large{\frac{1}{t^2 + 1}}$ $\int_{0}^{1} \large{\frac{-t}{tx+1}}$ $+ \large{\frac{x}{x^2+1}}$ $+ \large{\frac{t}{x^2 + 1}}$ $dx$
</center>

<p>Now, with more elementary calculus, we can evaluate that integral.</p>
<center>
$\int_{0}^{1} \large{\frac{-t}{tx+1}}$ $+ \large{\frac{x}{x^2+1}}$ $+ \large{\frac{t}{x^2 + 1}}$ $dx = -\ln(tx+1) + \frac{1}{2}\ln(x^2+1) + t\tan^{-1}(x) |_{0}^{1}$
<br><br>
$\large{\frac{\partial f}{\partial t}}$ $=\large{\frac{-4\ln(t+1) + 2\ln(2) + t\pi}{4(t^2 + 1)}}$
</center>

<p>Now, we want $f(1)$, and know that $f(0)=0$, so let&#39;s integrate this function of $t$ from 0 to 1.</p>
<center>
$f(1) = \int_{0}^{1} \large{\frac{-4\ln(t+1) + 2\ln(2) + t\pi}{4(t^2 + 1)}}$ $\partial t = \int_{0}^{1} \large{\frac{2\ln(2) + t\pi}{4(t^2 + 1)}}$ $\partial t + \int_{0}^{1} \large{\frac{-4\ln(t+1)}{4(t^2 + 1)}}$ $\partial t$
<br><br>
$f(1) = \int_{0}^{1} \large{\frac{2\ln(2) + t\pi}{4(t^2 + 1)}}$ $\partial t - \int_{0}^{1} \large{\frac{\ln(t+1)}{t^2 + 1}}$ $\partial t = \int_{0}^{1} \large{\frac{2\ln(2) + t\pi}{4(t^2 + 1)}}$ $\partial t - f(1)$
<br><br>
$f(1) = \large{\frac{1}{2}}$ $\int_{0}^{1} \large{\frac{2\ln(2) + t\pi}{4(t^2 + 1)}}$ $\partial t = \large{\frac{\pi \ln 2}{8}}$
</center>

<p>Again, almost magically, by generalizing a hard integral, it became a much easier one to tackle.</p>
<center>
$\int_{0}^{1} \large{\frac{\ln (x+1)}{x^2 + 1}}$ $dx = \large{\frac{\pi \ln 2}{8}}$
</center>

<p>To give you an idea how powerful this technique is, the above integral comes from the <a href="https://kskedlaya.org/putnam-archive/2005.pdf">2005 Putnam Exam</a>. Not only does it come from one of the most difficult math tests, it&#39;s also the 5th problem of the first set of problems (with problem 1 being the &quot;easiest&quot; and 6 being near impossible). And, in only a few lines, Feynman and Leibniz had it beat.</p>
<h2 id="conclusion">Conclusion</h2>
<p>These are the three most recent integration techniques I have picked up and tucked away in my problem solving toolbox, but if you&#39;re interested in more advanced integral shortcuts and tricks, take a look at this <a href="https://math.stackexchange.com/questions/942263/really-advanced-techniques-of-integration-definite-or-indefinite/943212">MathStackExchange post</a> I came across while doing this write-up. There are some genuinely mesmerizing ideas showcased there that just are out of the scope of my ability to explain, so do browse the forum if you&#39;re interested.</p>
]]></description>
         <link>http://xperimex.github.io/blog/incredible-integrals</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/incredible-integrals</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[The Calculus of Variations]]></title>
         <description><![CDATA[The end of an era 

 <p>It&#39;s a been a little while since I&#39;ve last posted. As part of my calculus class, we end the year with an exploration into a calculus related topic that we present to the rest of the class. I and my partner chose to explore the origins behind the <em>brachistochrone</em>: the curve of fastest descent for a rolling ball. Below is the related write-up I did as part of this project, and thought it might make for a good posting. It helped refine my LaTeX skills and I think is a good introduction into the field and motivations of the <em>calculus of variations</em>. Now that summer is right around the corner, hopefully I&#39;ll be able to write more in the coming months. For now, I hope this will do. </p>
<object data="/img/The_Brachistochrone_and_the_Calculus_of_Variations.pdf" type="application/pdf" width=100% height="895px">
    <iframe src="https://docs.google.com/viewer?url=https://mittal.ai/docs/resume.pdf&embedded=true" width="100%" height="2000px"></iframe>
</object>
]]></description>
         <link>http://xperimex.github.io/blog/variational-calculus</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/variational-calculus</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[<i>Quake III</i>'s Smartest Quasi-Square Root]]></title>
         <description><![CDATA[See? Video games ARE useful 

 <p>A couple months back, <a href="http://xperimex.com/blog/circle-computations/">we covered a little bit about some random circle computations and facts</a> I had collected over the months leading into that post. In it, we highlighted and rederived the basic raytracing equation for circles and spheres. In a few words, we used properties of vectors to be able to reduce the problem of where a line intersects a sphere into a quadratic equation. And with all quadratics, we were then able to use the quadratic formula to quickly find those points of intersection. In that post, I go on to say that I was able to generate this <em>incredible</em> raytraced scene in a mere matter of tens of minutes in even as simple a programming language as Python:</p>
<p><img src="/img/circle-computations/rayTracedEx.png"></p>
<center style="color: #666;">
<p>This raytraced scene is just millions of uses of the quadratic formula.</p>
</center>

<p>But I have to admit, I sort of lied to you. While, yes, that image <em>does</em> use the quadratic formula millions of times, it doesn&#39;t <em>only</em> do that. To render shadows and reflections, the scene also had to compute lighting and the physics you&#39;d expect with mirror-like objects. Without any of this, our scene would just look like, well, uh, this:</p>
<p><img src="/img/fast-sqrt/badRaytrace.png"></p>
<center style="color: #666;">
<p>Now <i>this</i> is a peak graphical performance. In a word: art.</p>
</center>

<p>Whichever one you think is better looking is up to the eye of the beholder, but what can&#39;t be argued, is that the second image is much cheaper to render; I&#39;m sure you could guess, no shadows and reflections causes the scene to be rendered in a fifth of the time. <em>A fifth</em>.</p>
<h2 id="quizzing-quotients">Quizzing Quotients</h2>
<p>Intuitively, more stuff to compute should take a computer a longer amount of time to go through, but can we pinpoint this bottleneck? Let&#39;s quickly look at what it takes to compute some of these reflections. When light bounces off, say, a mirror, these calculations become much easier when we use the mirror or surface&#39;s <em>normal vector</em>: the vector perpendicular to the surface (or the point at the surface) in question.</p>
<p><img src="/img/fast-sqrt/reflectRay.png"></p>
<center style="color: #666;">
<p>How to reflect a ray over a normal vector.</p>
</center>

<p>The above formula for reflecting a ray works in general for reflecting any ray $\vec{R}$ over another vector $\vec{N}$ (even if they&#39;re not normal)… Under a small assumption: the vector $\vec{N}$ is <em>normalized</em> (yes, the naming scheme isn&#39;t ideal), or of unit length (denoted by a little hat $\hat{N}$). We can do this by just scaling the vector down by its own length:</p>
<center>
$$\hat{N} = \large{ \frac{\vec{N}}{\lVert N \rVert} }$$
</center>

<p>Recalling that the length of a vector 3D $\lVert N \rVert = \lVert &lt;x,y,z&gt; \rVert = \sqrt{x^2 + y^2 + z^2}$, we end up with </p>
<center>
$$\hat{N} = \large{ \frac{\vec{N}}{\sqrt{x^2 + y^2 + z^2}} }$$
</center>

<p>And here lies our bottleneck. While we, as humans, treat division not too differently from multiplication in theory, computers can&#39;t work with &quot;just in theory&quot;; computers have to actually compute this arithmetic somehow. It turns out, while multiplication is a bit more complicated than addition, we&#39;ve been able to make <a href="https://en.wikipedia.org/wiki/Karatsuba_algorithm">algorithms</a> for <em>decades</em> to accelerate the computation. Division, on the other hand, has been such a difficult endeavor to match other operations speed, major companies like Intel have lots of <a href="https://www.cl.cam.ac.uk/~jrh13/papers/hol00.pdf">research dedicated to this alone</a>.</p>
<p>So, what do we do?</p>
<h2 id="the-fast-inverse-square-root">The Fast Inverse Square Root</h2>
<p>Under pressure, people can do some amazing things. You can imagine if someone was making a game or anything that required lots of lighting calculations, say, in a video game, calculating $\frac{1}{\sqrt{x}}$ millions of times, therefore also computing millions of divisions won&#39;t really cut it. </p>
<p>The developers of the video game <em>Quaker III</em>, an incredibly fast-paced shooter that definitely needed these optimizations, used a now infamous algorithm aptly called the <em>fast inverse square root</em>, because, well, it computes the inverse square root $\frac{1}{\sqrt{x}}$, fast and avoids dreaded division. The history of the algorithm has been found to predate the game that made it so infamous, but pop culture assigns value to whatever it latches onto first. Without further ado, the original source code (along with all the original comments and annotations) for <em>Quake III</em> was released in 2005, and the program is right there for us to learn from:</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 12px"><pre style="margin: 0; line-height: 125%"><span style="color: #B00040">float</span> <span style="color: #0000FF">Q_rsqrt</span>( <span style="color: #B00040">float</span> number )
{
      <span style="color: #B00040">long</span> i;
      <span style="color: #B00040">float</span> x2, y;
      <span style="color: #008000; font-weight: bold">const</span> <span style="color: #B00040">float</span> threehalfs <span style="color: #666666">=</span> <span style="color: #666666">1.5F</span>;

      x2 <span style="color: #666666">=</span> number <span style="color: #666666">*</span> <span style="color: #666666">0.5F</span>;
      y  <span style="color: #666666">=</span> number;
      i  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">long</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>y;                     <span style="color: #408080; font-style: italic">// evil floating point bit level hacking</span>
      i  <span style="color: #666666">=</span> <span style="color: #666666">0x5f3759df</span> <span style="color: #666666">-</span> ( i <span style="color: #666666">&gt;&gt;</span> <span style="color: #666666">1</span> );             <span style="color: #408080; font-style: italic">// what the fuck? </span>
      y  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">float</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>i;
      y  <span style="color: #666666">=</span> y <span style="color: #666666">*</span> ( threehalfs <span style="color: #666666">-</span> ( x2 <span style="color: #666666">*</span> y <span style="color: #666666">*</span> y ) ); <span style="color: #408080; font-style: italic">// 1st iteration</span>
<span style="color: #408080; font-style: italic">//    y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed</span>

      <span style="color: #008000; font-weight: bold">return</span> y;
}
</pre></div>


<p>It&#39;s not a long algorithm by any means, but I think the comments themselves explain just how crazy this is; even the developers who USED it are impressed, but let&#39;s break it down line by line.</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">      <span style="color: #B00040">long</span> i;
      <span style="color: #B00040">float</span> x2, y;
      <span style="color: #008000; font-weight: bold">const</span> <span style="color: #B00040">float</span> threehalfs <span style="color: #666666">=</span> <span style="color: #666666">1.5F</span>;
</pre></div>

<p>Here we define four different numbers: <code>i</code>, <code>x2</code>, <code>y</code>, and <code>threehalfs</code>. But not all of these numbers are treated the same.</p>
<h3 id="binary-and-floating-point">Binary and Floating Point</h3>
<p>In our day-to-day routine, we (at least, most of us) use base 10, decimal, to represent our numbers. What this means is that each digit in a number corresponds to some power of 10 we add together. For example, the number 1409, can be grouped as</p>
<center>
$
\begin{array}{c|c|c|c}
1 &amp; 4 &amp; 0 &amp; 9 \\ \hline
10^3 &amp; 10^2 &amp; 10^1 &amp; 10^0  \\
\end{array}
$
</center>

<p>with 1 thousands, 4 hundred, 0 tens, and 9 ones. You add these all together to get $1(10^3) + 4(10^2) + 0(10^1) + 9(10^0) = 1409$. This may seem obvious, but this is a really important idea in how we write numbers. Each digit represents a condensed shorthand for how many of a specific power of 10 is in our number. Computers do it similarly, but instead of base 10, they use base 2, or binary. If we wanted to represent 1409 in binary, we&#39;d have</p>
<center>
$
\begin{array}{c|c|c|c|c|c|c|c|c|c|c}
1 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ \hline
2^{10} &amp; 2^9 &amp; 2^8 &amp; 2^7 &amp; 2^6 &amp; 2^5 &amp; 2^4 &amp; 2^3 &amp; 2^2 &amp; 2^1 &amp; 2^0  \\
\end{array}
$
</center>

<p>Now if you went and added these together you could verify that $2^{10} + 2^{8} + 2^{7} + 2^{0} = 1409$. Now each digit—or decimal-igit—represents a power of 2. We call these binary-igits bits. That first line of code that defines a <code>long i</code> means we define a number with 32 bits that looks like</p>
<center>
<code>00000000 00000000 00000000 00000000</code>
</center>

<p>With 32 bits, we can write any number from 0 to $2^{32} - 1 = 4294967295$. Let&#39;s notice some nice properties with this format. In decimal, if we wanted to add a 0 to the end of our number like $1409 \rightarrow 14090$, this is the same as multiplying our number by 10, because now every digit has moved up into one bucket higher than before.</p>
<center>
$
\begin{array}{c|c|c|c|c}
1 &amp; 4 &amp; 0 &amp; 9 &amp; 0\\ \hline
10^4 &amp; 10^3 &amp; 10^2 &amp; 10^1 &amp; 10^0  \\
\end{array}
$
</center>

<p>In the same way, we can remove zeroes on the right $14090 \rightarrow 1409$ by dividing by 10 since every digit will be shifted into one power lower. Binary works the same. If we want to add a 0 to the right end of our number, we now multiply our number by 2, but if we wanted to remove a 0, we divide by 2. This is known as <strong>bit shifting</strong>, and serves as one of the nice workarounds of division: if you want to divide specifically by a power of 2, just bit shift the number in binary by however many zeroes you need.</p>
<p>But that leads to an issue: only even numbers can be wholly divided by 2, so what do we do if we want to divide an odd number? How would we write a decimal like .5? How would we write any rational number? We currently can only represent 32-bit <em>integers</em>, since we have no way of writing fractional parts. If we wanted to add decimals, why don&#39;t we just throw in a decimal point then?</p>
<center>
<code>00000000 00000000 . 00000000 00000000</code>
</center>

<p>(Remember this decimal point is just for our convenience; the computer doesn&#39;t actually see anything here but the 32 bits) If we use the left 16 bits for the integer part, and the right 16 bits for the decimal, we can now in fact write rational numbers, but all of a sudden the range of numbers we can represent has shrunk immensely, only to just under 65535.9999847, but the upside is now we can do much more precise, rational numbers. This is okay, but we can do better. </p>
<p>If you have ever taken a chemistry or physics class, you&#39;re probably all too familiar with <em>scientific notation</em>. We can write really big numbers and really small numbers in a much more condensed way by turning everything into a product of a power of ten:</p>
<center>
$\begin{align}
4230987 &amp; \rightarrow 4.230987 \cdot 10^6 \
\newline
0.000154 &amp; \rightarrow 1.54 \cdot 10^{-4}
\end{align}$
</center>

<p>This is how our calculators can do arithmetic beyond just the digits shown on the screen. By slapping on a power of 10, we can now represent a much wider range of values using the same number of digits previously. Similarly, binary works just the same except with powers of 2.</p>
<center>
$\begin{align}
11010111 &amp; \rightarrow 1.1010111 \cdot 2^7 \
\newline
0.00101 &amp; \rightarrow 1.01 \cdot 2^{-3}
\end{align}$
</center>


<p>So, let&#39;s do just that. Let&#39;s allocate 8 bits of our previous 32 to representing the <span style="color:green">exponent</span>, and another 23 to our <span style="color:blue">actual number</span>.</p>
<center>
<span style="color:green"><code>00000000</code></span> <span style="color:blue"><code>0.0000000000000000000000</code></span>
</center>

<p>With 8 bits for the <span style="color:green">exponent</span>, we can represent anything from 0 to 255, but we also want negative exponents, so we just subtract 127 to get the new range of exponents from -127 to 128. With our <span style="color:blue">fractional number</span> and its 1 whole bit and 22 decimal bits, we can represent numbers from 0 to 1.999999761581. We call this part of the number the <span style="color:blue">mantissa</span>. However, this is actually not the full extent of the potential precision we can get. In all of our examples of scientific notation, there was always a non-zero number before the decimal point, since if there was a leading 0, that&#39;s another power of our exponent we could factor out. In binary, there&#39;s only two values: 0 and 1. If we know the first digit is non-zero, then we know it has to be a 1! So we can actually shift our decimal point over and gain an extra bit.</p>
<center>
<span style="color:green"><code>00000000</code></span> <span style="color:blue"><code>.00000000000000000000000</code></span>
</center>

<p>Now all we have to do is affix a leading 1 and we&#39;re good to go. So, the number</p>
<center>
<span style="color:green"><code>11001010</code></span> <span style="color:blue"><code>.01110100000000000000000</code></span>
</center>

<p>would represent $1\color{blue}{.453125} \cdot \color{green}{2^{202-127}}$. In general, if we&#39;re given a 23 bit number representing the <span style="color:blue">mantissa</span> and an 8 bit number representing the <span style="color:green">exponent</span>, we can write our number we&#39;re expressing as:</p>
<center>
$\large{(1 + \color{blue}{\frac{M}{2^{23}}}) \cdot \color{green}{2^{E-127}}}$
</center>

<p>We divide our <span style="color:blue">mantissa</span> by $2^{23}$ so that it is only the fractional part of our number like we want. However, doesn&#39;t part of this just <em>feel</em> wrong? Like, when we were defining an integer as a 32 bit <code>long</code>, we used every bit to denote a new power of 2. Here, we really are writing two <em>different</em> binary numbers side-by-side. If we wrote our number as </p>
<center>
<span style="color:blue"><code>.01110100000000000000000</code></span> <span style="color:green"><code>11001010</code></span>
</center>

<p>would it really make a difference? So, just for the sake of consistency, we&#39;ll put the <span style="color:green">exponent</span> first, and we can then represent our number&#39;s bit representation as a sum:</p>
<center>
$\begin{align}
\color{green}{00000000} 00000000000000000000000 &amp; \
\newline
\color{blue}{00000000000000000000000} &amp; \ 
\newline
\hline
\color{green}{00000000}\color{blue}{00000000000000000000000}
\end{align}$
</center>

<p>We just added 23 filler zeroes to our exponent to make sure it landed where we wanted to in the final bit representation. That sounds like a bit shift! We can thus multiply our <span style="color:green">exponent</span> by $2^{23}$ to give us our 23 extra zeroes So, this final sum—our <span style="color:green">exponent</span> and <span style="color: blue">mantissa</span> together—can be written as</p>
<center>
$\large{ \color{green}{E}\cdot 2^{23} + \color{blue}{M} }$
</center>

<p>Now, there are some flaws that do need to be addressed. If we assume our leading bit is non-zero, how _do_ we represent 0? That actually doesn&#39;t matter in the grand scheme of our intended use in lighting (i.e. we only call the fast inverse square root when we <em>have</em> to use it), and when we&#39;re not, this is a single edge case that can be put in later. Yeah, I&#39;ll admit, it&#39;s not ideal, but it gives us more precision where we need it. The other issue is we haven&#39;t used all of our 32 bits! $8+23=31$, so where did our last bit go? In our set-up, we have it such that we can only represent <em>positive</em> numbers. We can attach an additional <em>sign bit</em> at the front, where if it&#39;s a 0, we say the number is positive, and if it&#39;s a 1, the number is negative. </p>
<center>
<span style="color:red"><code>0</code></span> <span style="color:green"><code>11001010</code></span> <span style="color:blue"><code>.01110100000000000000000</code></span>
</center>

<p>However, we want to know how to find <em>positive</em> square roots, not enter the complex world, so we always just assume it&#39;s positive. So if we don&#39;t use the bit, why don&#39;t we repurpose it? Conventions. The standard for binary fractional-part representation and arithmetic is known as <strong>IEEE 754</strong>, and for that reason we just have to abide by it.</p>
<p>I&#39;ve been calling this with terms like &quot;decimal points&quot; and &quot;fractional-parts&quot;, but a decimal point seems wrong when we&#39;re doing it in binary. The type of number we&#39;ve just formatted is called a <em>floating point</em> or a <code>float</code> as we see in lines 2 and 3. While <code>float</code>s give us nice ways to represent a lot of numbers, they are a bit annoying compared to <code>long</code>s in the sense that <strong>we can&#39;t bit shift or manipulate a <code>float</code></strong> since the bits in a <code>float</code> represent multiple, different parts of the number in question, namely the <span style="color:green">exponent</span> and the <span style="color:blue">mantissa</span>.</p>
<!-- ---------- -->
<h3 id="bit-approximations-with-themselves-">Bit Approximations… With Themselves?</h3>
<p>This may seem like a gross, unnecessary dive into how computers understand numbers, but understanding what binary, bits, and floats are will help us greatly in understanding the ingenuity behind the fast inverse square root. To recap, we&#39;ve found that we can represent a binary number as a <code>float</code> with two parts, an <span style="color:green">exponent</span> and a <span style="color:blue">mantissa</span>, as if we were using scientific notation. To find the actual number our <code>float</code> represents, we use the formula</p>
<center>
$\large{(1 + \color{blue}{\frac{M}{2^{23}}}) \cdot \color{green}{2^{E-127}}}$
</center>

<p>Since we&#39;re working with two different binary numbers together, we combine them into one sequence of bits that to as a shorthand to represent our <code>float</code> with the formula</p>
<center>
$\large{ \color{green}{E}\cdot 2^{23} + \color{blue}{M} }$
</center>

<p>We can now perform some mathematical magic. Let&#39;s take the logarithm of the actual number of our <code>float</code> (note by $\log(x)$, we assume it to be $\log_2(x)$ since we&#39;re working in binary).</p>
<center>
$\large{ \log((1 + \color{blue}{\frac{M}{2^{23}}}) \cdot \color{green}{2^{E-127}}) =  \log(1 + \color{blue}{\frac{M}{2^{23}}})} + \color{green}{E-127}$
</center>

<p>This may not seem that useful, but there&#39;s an important detail here: we&#39;re looking to <em>optimize</em> a program, not get exact results. So, a useful fact to note is that for $x$ between 0 and 1, $\log_2(1+x)\approx x$.</p>
<p><img src="/img/fast-sqrt/logx.png"></p>
<center style="color: #666;">
<p>We can simplify $\log_2(1+x)$ by approximating it as $x$.</p>
</center>

<p>We can get an <em>even better</em> approximation by slightly offseting our estimate; $\log_2(1+x)\approx x + \delta$ is a better approximation than $\log_2(1+x)\approx x$</p>
<p><img src="/img/fast-sqrt/betterlogx.png"></p>
<center style="color: #666;">
<p>We can approximate $\log_2(1+x)$ better with small shift.</p>
</center>

<p>It turns out the best value for $\delta = 0.0430357$ (as in minimizing the average error). By definition, our <span sytle="color:blue">mantissa</span> is between 0 and 1, so we can use this approximation ourselves.</p>
<center>
$\large{ \log(1 + \color{blue}{\frac{M}{2^{23}}}) + \color{green}{E-127} \approx  \color{blue}{\frac{M}{2^{23}}} + \delta + \color{green}{E-127}}$
</center>

<p>If we rearrange this a bit,</p>
<center>
$\large{\color{blue}{\frac{M}{2^{23}}} + \delta + \color{green}{E-127} = \color{blue}{\frac{1}{2^{23}}}(\color{green}{E} \cdot 2^{23} + \color{blue}{M}) + \delta \color{green}{- 127} }$
</center>

<p>Okay, why did we do any of this? This definitely is kinda random to not only take the $\log$ of our <code>float</code>, but also do all these approximations to then get rid of that $\log$ too? Why?</p>
<p>Look inside the parantheses in the above equation.</p>
<center>
$\large{\color{blue}{\frac{1}{2^{23}}}(\boxed{ \color{green}{E} \cdot 2^{23} + \color{blue}{M} }) + \delta \color{green}{- 127} }$
</center>

<!-- find better way to box/highlight^^^ -->
<p>That&#39;s precisely the bit representation of our <code>float</code>! So, in a way, the $\log$ of our number is equal to the bit representation of our <code>float</code>, up to some scaling and shifting.</p>
<center>
$\large{\log(\textrm{number}) \approx C(\texttt{bits}) + K}$
</center>

<p>With this under our belt, we can finally start looking at the steps of the fast inverse square root algorithm.</p>
<h2 id="evil-floating-point-bit-level-hacking">Evil Floating Point Bit Level Hacking</h2>
<p>First, we assign our number we want to find the inverse square root of into a <code>float</code> (a.k.a. scientific notation-type decimal number).</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">      y  <span style="color: #666666">=</span> number;
</pre></div>

<p>Now, recall that a <code>float</code> isn&#39;t that compatible with bit shifting or that many operations, so here&#39;s the first clever part of the algorithm.</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em"><pre style="margin: 0; line-height: 125%">      i  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">long</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>y;<br></pre></div>

<p>What this does is we take the exact bits of our number as a <code>float</code> and copies it into a <code>long</code>. That&#39;s it. Under the hood, it takes the number at the memory address of <code>y</code> and exactly transfers the bits over to <code>i</code>. This will make our life easier here in the next step. </p>
<p>Since we have now put our number that we&#39;re trying to find the inverse square root to, <code>y</code>, as its bit representation, we have effectively stored approximately $\log({y})$ into <code>i</code>.</p>
<h2 id="what-the-f-k-">What the F#@k?</h2>
<p>The fabled step that makes this algorithm so smart.</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">      i  <span style="color: #666666">=</span> <span style="color: #666666">0x5f3759df</span> <span style="color: #666666">-</span> ( i <span style="color: #666666">&gt;&gt;</span> <span style="color: #666666">1</span> );<br></pre></div>

<p>Remember, at the end of all of this, we want to find a number, $\alpha = \frac{1}{\sqrt{{y}}}$, but we have been working almost exclusively in logarithms. So, let&#39;s take the $\log$ of both sides.</p>
<center>
$\large{ \log(\alpha) = \log(\frac{1}{\sqrt{{y}}}) = \log({y}^{-\frac{1}{2}}) = -\frac{1}{2}\log({y}) \approx -\frac{1}{2}\texttt{i}}$
</center>

<p>Wait, but we have a division in there! On quite the contrary, it&#39;s a division by 2, and since <code>i</code> is a <code>long</code>, we can just bit shift to the right 1 to divide by 2! That&#39;s precisely what <code>i &gt;&gt; 1</code> does: it bit shifts <code>i</code> once to the right.</p>
<p>But what is the deal with that <code>0x5f3759df</code>? Well, remember that <code>i</code> is only an approximation for the $\log(y)$ up to some constants. So, we have to account for those constants <em>somehow</em>. Let&#39;s go back to $\alpha$. We know that</p>
<center>
$\large{ \log(\alpha) = -\frac{1}{2}\log({y})}$
</center>

<p>In terms of <code>float</code>s…</p>
<center>
$\large{ \log({(1 + \frac{\color{red}{M_{\alpha}}}{2^{23}}) \cdot 2^{\color{red}{E_{\alpha}}-127}}) = -\frac{1}{2}\log({(1 + \frac{\color{blue}{M_{y}}}{2^{23}}) \cdot 2^{\color{blue}{E_{y}}-127}})}$
</center>

<p>Fortunately we already know how to expand this from before.</p>
<center>
$\frac{1}{2^{23}}(\color{red}{E_\alpha \cdot 2^{23}} + \color{red}{M_\alpha}) + \delta - 127 = -\frac{1}{2}[\frac{1}{2^{23}}(\color{blue}{E_y \cdot 2^{23}} + \color{blue}{M_y}) + \delta - 127]$
</center>

<p>This looks pretty bad, but after some simplifying and rearranging…</p>
<center>
$\color{red}{E_\alpha \cdot 2^{23}} + \color{red}{M_\alpha} = \frac{3}{2}2^{23}(127 - \delta) - \frac{1}{2}(\color{blue}{E_y \cdot 2^{23}} + \color{blue}{M_y})$
</center>

<p>We know that anything of the form $E\cdot 2^{23} + M$ is just the bit representation of the number, and we know the bits of $y$ is just <code>i</code>, so</p>
<center>
$\color{red}{\alpha}_{\texttt{bits}} = \frac{3}{2}2^{23}(127 - \delta) - \frac{1}{2}\texttt{i}$
</center>

<p>That magic constant <code>0x5f3759df</code> is the hexadecimal (not totally sure why there is so many changes of bases) approximation of that constant $\frac{3}{2}2^{23}(127 - \delta)$. So what we do in this line of code is we bit shift <code>i</code> once to the right to halve it, and take that result and subtract it from <code>0x5f3759df</code> to correct for all the constants that came with our approximations of $\log(y)$. Not totally sure why the developers felt the need to write a variable for <code>threehalfs</code> and not this number, but what can we do.</p>
<p>But now note we are storing this value in <code>i</code>. So, from here on <code>i</code> no longer refers to the bits of $y$, but the bits of $\alpha$, our desired number. The bits, though, aren&#39;t particularly helpful since we want the <code>float</code> and decimal representation of $\alpha$, so we do just that:</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">      y  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">float</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>i;
</pre></div>

<p>Just like how we casted the bits of a <code>float</code> $y$ into a <code>long i</code>, we now do the reverse and cast the bits of <code>i</code> into a <code>float</code> $y$.</p>
<p>At this point, we&#39;re technically done: $y$ currently stores an approximation of $\frac{1}{\sqrt{\texttt{number}}}$, using 0 steps of slow division! But we can do better for a marginal amount of extra computation.</p>
<h2 id="1st-iteration">1st Iteration</h2>
<p>Say we wanted to solve for the zeroes of the function</p>
<center>
$\large{f(y) = \frac{1}{y^2} - C}$
</center>

<p>where $C$ is any arbitrary constant. Solving for $y$…</p>
<center>
$\large{0 = \frac{1}{y^2} + C \rightarrow y = \frac{1}{\sqrt{C}}}$
</center>

<p>If we could find a way to approximate the roots of this function, we&#39;d then in turn have a way to approximate the inverse square root of any number!</p>
<p>In a <a href="https://xperimex.com/blog/fixed-points/#newton-raphson-method">previous post</a>, we discussed a technique to precisely do that: the Newton-Raphson Method (sometimes just called Newton&#39;s Method).</p>
<p>Let&#39;s say we have a random function $g(x)$. To find a solution, what can we do? Well, not a good idea, but <i>an</i> idea, we could just guess a random number $x_0$ as a solution. If $x_0$ is a solution, then obviously $g(x_0)=0$.</p>
<p><img src="/img/fast-sqrt/newton0.png"></p>
<center style="color: #666;">
<p>A pretty bad first guess.</p>
</center>

<p>As you&#39;d imagine, the chances of guessing a root of $g(x)$ immediately is slim. So, the next step in Newton&#39;s Method tells us to draw the <i>tangent line</i> at our first guess $(x_0, g(x_0))$ to get our next guess $x_1$.</p>
<p><img src="/img/fast-sqrt/newton1.png"></p>
<center style="color: #666;">
<p>A better, but still not ideal, approximation.</p>
</center>

<p><em>Now</em> we&#39;re getting pretty close. That&#39;s the whole premise of the Newton-Raphson Method:</p>
<ol>
<li>Pick an initial guess $x_n$</li>
<li>Draw the tangent line at $(x_n, g(x_n))$ and find where it intersects the $x$-axis</li>
<li>Use that as your new guess $x_{n+1}$</li>
<li>Repeat steps 1–3 as needed</li>
</ol>
<p>So, if we do another iteration of our example above…</p>
<p><img src="/img/fast-sqrt/newton2.png"></p>
<center style="color: #666;">
<p>Now we&#39;re getting to a reasonable estimation.</p>
</center>

<p>There are some edge cases though where this obviously won&#39;t work, such as if our guess happens to hit an extremum.</p>
<p><img src="/img/fast-sqrt/newtontangent.png"></p>
<center style="color: #666;">
<p>In this case, there&#39;s no additional guess since our tangent line is parallel to the axis.</p>
</center>

<p>We could even get loops where we just continuously bounce back and forth between two guesses. Fortunately, we don&#39;t have to worry about that. If our first guess is already really accurate and near the actual solution, then our graph $g(x)$ begins to look like this:</p>
<p><img src="/img/fast-sqrt/localLine.png"></p>
<center style="color: #666;">
<p>Up close, smooth, continuous graphs look linear.</p>
</center>

<p>$g(x)$ starts to look like a line! And when a function locally looks like a line, it also locally looks like its <em>tangent line</em>.</p>
<p><img src="/img/fast-sqrt/newtonFinal.png"></p>
<center style="color: #666;">
<p>Can&#39;t really beat that now.</p>
</center>

<p>This is important to us since we already have a good estimate from all of our bit manipulation from earlier, so we do one iteration of Newton&#39;s method to get an even <em>better</em> approximation.</p>
<p>To put this in terms of some equations to compute, we want to estimate the root of</p>
<center>
$\large{f(y) = \frac{1}{y^2} - C}$
</center>

<p>Given an initial guess $y_n$, our next guess $y_{n+1}$ is the solution to</p>
<center>
$\large{f&#39;(y_n)(y-y_n) + f(y_n) = 0}$
</center>

<p>since this describes where our tangent line generates our next solution. Solving for $y$ we get that</p>
<center>
$\large{y = y_{n+1} = y_n - \frac{f(y_n)}{f&#39;(y_n)}}$
</center>

<p>Now it&#39;s just a matter of plugging everything in.</p>
<center>
$\begin{align}
y_{n+1} &amp; = y_n - \frac{f(y_n)}{f&#39;(y_n)} \
\newline
&amp; = y_n - \frac{\frac{1}{y_{n}^2} - C}{-\frac{2}{y_{n}^3}} \
\newline
&amp; = \frac{3y_n - Cy_{n}^3}{2} \
\newline
&amp; = y_n(\frac{3}{2} - \frac{C}{2}y_{n}^2)
\end{align}$
</center>

<p>With a small substitution of $x_2 = \frac{C}{2}$,</p>
<center>
$\large{ y_{n+1} = y_n(\frac{3}{2} - x_{2}y_{n}^2) }$
</center>

<p>If we look at the line of code that entails this &quot;1st iteration&quot;,</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">      y  <span style="color: #666666">=</span> y <span style="color: #666666">*</span> ( threehalfs <span style="color: #666666">-</span> ( x2 <span style="color: #666666">*</span> y <span style="color: #666666">*</span> y ) );
</pre></div>

<p>That&#39;s precisely the formula they have right there. You might wonder if that $\frac{3}{2}$ poses an issue at all in terms of division, but it is of no concern since we know its decimal expansion to be 1.5 so we can just use floating point arithmetic from the start; division becomes an increasingly hard problem when we <em>don&#39;t</em> know what the decimal representation of the quotient in question is.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Let&#39;s quickly recap what we&#39;ve learned about the fast inverse square root algorithm and how it works:</p>
<div style="background: #f8f8f8; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em; font-size: 12px"><pre style="margin: 0; line-height: 125%"><span style="color: #B00040">float</span> <span style="color: #0000FF">Q_rsqrt</span>( <span style="color: #B00040">float</span> number )
{
      <span style="color: #B00040">long</span> i;
      <span style="color: #B00040">float</span> x2, y;
      <span style="color: #008000; font-weight: bold">const</span> <span style="color: #B00040">float</span> threehalfs <span style="color: #666666">=</span> <span style="color: #666666">1.5F</span>;

      x2 <span style="color: #666666">=</span> number <span style="color: #666666">*</span> <span style="color: #666666">0.5F</span>;
      y  <span style="color: #666666">=</span> number;
      i  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">long</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>y;                     <span style="color: #408080; font-style: italic">// evil floating point bit level hacking</span>
      i  <span style="color: #666666">=</span> <span style="color: #666666">0x5f3759df</span> <span style="color: #666666">-</span> ( i <span style="color: #666666">&gt;&gt;</span> <span style="color: #666666">1</span> );             <span style="color: #408080; font-style: italic">// what the fuck? </span>
      y  <span style="color: #666666">=</span> <span style="color: #666666">*</span> ( <span style="color: #B00040">float</span> <span style="color: #666666">*</span> ) <span style="color: #666666">&amp;</span>i;
      y  <span style="color: #666666">=</span> y <span style="color: #666666">*</span> ( threehalfs <span style="color: #666666">-</span> ( x2 <span style="color: #666666">*</span> y <span style="color: #666666">*</span> y ) ); <span style="color: #408080; font-style: italic">// 1st iteration</span>
<span style="color: #408080; font-style: italic">//    y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed</span>

      <span style="color: #008000; font-weight: bold">return</span> y;
}
</pre></div>


<ol>
<li>We first take our number as a <code>float</code> $y$ and store its bits in a <code>long i</code>.</li>
<li>Noting that $\log_2(y) \approx \texttt{i}$, we approximate $\frac{1}{\sqrt{y}}$ using bit shifting and the magic number 0x5f3759df.</li>
<li>We then perform one iteration of Newton&#39;s method to get an even better approximation.</li>
</ol>
<p>These three steps required a fair bit of knowledge to properly unpack, but it&#39;s incredibly insightful when thinking about the lenghts programmers go to optimize their code. Remember: this is all to avoid using any division! What we consider such a simple operation is almost never such for a computer, and when it comes to teaching computers to do these things, they are as blind as a bat. But it&#39;s this difficulty and blank slate of a circuit board that makes computers be able to teach us, just as much as we teach them.</p>
]]></description>
         <link>http://xperimex.github.io/blog/fast-sqrt</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/fast-sqrt</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
      <item>
         <title><![CDATA[Pleasing Panormas and Matrix Multiplication]]></title>
         <description><![CDATA[Capture the world as it (almost) is 

 <p>Out of all the apps on my phone, the camera is one that I can&#39;t see myself without anymore. Between being out with friends, or travelling with family, the camera rarely remains idle as I capture memories forever. Though, there is one particular feature of mobile photography I&#39;ve come to especially love: the panorama.</p>
<p><img src="/img/panorama-homography/grandCanyonEx.jpg"></p>
<center style="color: #666;">
<p>Even this struggles to capture how well the Grand Canyon lives up to its name.</p>
</center>

<p>If you have an Android phone, you can get even more incredible types of otherwise impossible photos with Google&#39;s staple Photo Spheres:</p>
<p><img src="/img/panorama-homography/PHOTOSPHERE.jpg"></p>
<center style="color: #666;">
<p>An &quot;unwrapped&quot; Photo Sphere; normally this would be an interactive literal sphere of the environment.</p>
</center>

<p>While these are cool, it does beg the question: how are these made? How does your phone unite multiple images into a single cohesive one? We&#39;ll explore a little bit of linear algebra to manipulate our photos exactly how we want to.</p>
<h2 id="the-problem">The Problem</h2>
<p>Before anything else, let&#39;s first define what a panorama is. In computer graphics, a panorama is a type of <strong>mosaic</strong>, that is, a unification of two or more images. A panorama in particular, though, is a mosaic in which all the photos to be stitched together are all taken from the same camera position. When you take a panorama on your phone, all you&#39;re doing is spinning in place, so that&#39;s what we want to recreate.</p>
<!-- inset image -->
<p>So, if we&#39;re given two images from different angles, </p>
<p><img src="/img/panorama-homography/desk1.jpg">
<img src="/img/panorama-homography/desk2.jpg"></p>
<p>how do we combine them into a single unified image? Thinking about it this way is not super helpful, since, well, that&#39;s what we already know about panoramas. What do we want to get out of a panorama? If our panorama is done well, then objects in one image should overlap properly with the same objects in the other image.</p>
<p>For example, take a look at the top left of my computer monitor:</p>
<p><img src="/img/panorama-homography/desk1Corner.jpg">
<img src="/img/panorama-homography/desk2Corner.jpg"></p>
<p>In our panorama, these two points should overlap, since we obviously recognize these to be the same object in the real world. But to the two pictures, they are wildly different! In the first picture, the corner of my monitor is closer to the left side of the frame, while in the second picture, it is almost on the top-right edge of the image. So, if we try to manually align these two corners so that they overlap, we get:</p>
<p><img src="/img/panorama-homography/firstPanoAttempt.jpg"></p>
<p>While our single corner of the monitor is aligned between the two images, I don&#39;t think I have to try very hard to convince you that this isn&#39;t a great panorama. I mean, just look at the rest of the overlap.</p>
<p><img src="/img/panorama-homography/firstOverlap.jpg"></p>
<p>The skew angles of the resting laptop and the monitor itself don&#39;t align at all, and while my cable management is bad, it&#39;s not <em>that</em> bad. This is the real challenge at the heart of making panoramas: images are <em>flat</em>, while the motion of a panorama is <em>cylindrical</em>. Ideally we would take a &quot;cylindrical&quot; photo and unwrap that into a rectangle, but we can&#39;t. Undoubtedly, we will have to warp our images somehow to align.</p>
<p>How do we find the right way to warp our image? The first thing we will need to do is get more data! Having one point line up between the photos is not great, but, say, 10 different data points might not be bad.</p>
<p><img src="/img/panorama-homography/desk1labels.jpg">
<img src="/img/panorama-homography/desk2labels.jpg"></p>
<p>So, our final panorama would like the same numbered red and blue points to overlap. With data to use, the second thing we will need is a way to actually warp our image; how do we actually make our points between photos line up? For that, we turn to linear algebra.</p>
<h2 id="rethinking-coordinates">Rethinking Coordinates</h2>
<p>If you had a random ordinary point, how might you describe its position to someone?</p>
<p><img src="/img/panorama-homography/point.png"></p>
<center style="color: #666;">
<p>A lonely, solitary point living in the plane.</p>
</center>

<p>A common choice we&#39;re all familiar with in some way is by using a <strong>coordinate system</strong>. That is, we define a place to be $(0,0)$ and locate every point relative to that <strong>origin</strong> in terms of its $x$ and $y$ coordinates $(x,y)$.</p>
<p><img src="/img/panorama-homography/coordinateSpace.png"></p>
<center style="color: #666;">
<p>A still lonely, solitary point living in the plane, but with more lines.</p>
</center>

<p>In the above coordiante space choice, we might say the point is at $(3,2)$. But what exactly do we <em>mean</em> by the point being at $(3,2)$? What this really implies is that the point is 3 steps to the right of the origin, and 2 steps above the origin.</p>
<p><img src="/img/panorama-homography/basis.png"></p>
<p>So, instead of thinking of this point in terms of separate coordinates, we can think of it in terms of these two <strong>basis vectors</strong>. Let&#39;s use $\color{blue}{i}$ to represent the blue, horizontal vector, and $\color{red}{j}$ to represent the red, vertical vector. So, our point is really the combination of $\color{blue}{3i}$ and $\color{red}{2j}$, or simply, $\color{blue}{3i} + \color{red}{2j}$, which itself repsents another vector (the one pointing from the origin to the point $(3,2)$).</p>
<p>This might seem extra and unnecessary, since we just rewrote a vector as the sum of its horizontal and vertical components, which is what coordinates literally do in the first place. But the useful insight here is that there is nothing that says our basis vectors have to be in the unit directions! We can now rewrite points in multiple ways depending on our choice of $\color{blue}{i}$ and $\color{red}{j}$.</p>
<p><img src="/img/panorama-homography/basisNew.png"></p>
<center style="color: #666;">
<p>A new, quirky choice of basis vectors.</p>
</center>

<p>With a new choice of basis vectors, the vector $\color{blue}{3i} + \color{red}{2j}$ has a totally new position as that now encodes the coordinate $(5,3)$ since neither $\color{blue}{i}$ nor $\color{red}{j}$ represents horizontal or vertical steps anymore, but rather skew, diagonal steps. </p>
<p>But look at that! We&#39;ve basically accomplished our goal of warping points! We&#39;ve managed to transform the point $(3,2) \rightarrow (5,3)$ by manipulating $\color{blue}{i}$ and $\color{red}{j}$; both points are techincally at $\color{blue}{3i} + \color{red}{2j}$, just for different basis vectors.</p>
<p>This is what linear algebra and matrices encode geometrically. If we write our basis vectors $\color{blue}{i}$ and $\color{red}{j}$ in a matrix and multiply that by the vector representing our initial point, we will get a new point representing our transformation (a.k.a., our warp). How do we write our basis vectors in a matrix? Each vector implicitly has coordinates associated with themselves! In the above picture, $\color{blue}{i}$ points at $\color{blue}{(1,-1)}$, since from its tail to its tip it moves one step to the right and one step down. $\color{red}{j}$, on the other hand, points at $\color{red}{(1,3)}$, and these are precisely the vectors we see in our matrix.</p>
<p>For the unit basis vectors that point at $(1,0)$ and $(0,1)$, to differentiate them from any old pair of basis vectors, we call them $\color{blue}{\hat{\imath}}$ and $\color{red}{\hat{\jmath}}$ wearing a little hat, and their respective matrix the <em>identity matrix</em>, since it leaves vectors unchanged after multiplication.</p>
<center>
$a$
</center>

<p><img src="/img/panorama-homography/matrixMult.png"></p>
<center style="color: #666;">
<p>The underlying idea of linear transformations.</p>
</center>

<p>These $2 \times 2$ matrices represent <em>linear transformations</em>. They&#39;re transformations in they way that they transform points from one coordinate to another, and they are linear in the sense that keep all grid lines parallel, evenly spaced and, well, linear after the transformation. This is best seen through <a href="https://youtu.be/kYB8IZa5AuE?t=227">video</a> and not stills. For this post you don&#39;t need to understand the mechanics of matrix-vector multiplication, but just understand that it represents some transformation on a point.</p>
<h2 id="warping-images">Warping Images</h2>
<p>So why should we care? Why is this helpful in any way? If we think of each pixel on our images as a coordinate, we can just apply our transformation to all pixels on that image, find where they land and color them, and generate a new image. Let&#39;s take this picture as an example.</p>
<p><img src="/img/panorama-homography/canyon.jpg"></p>
<p>We can scale it, rotate it, or even shear it by applying the same transformation matrix to every pixel.</p>
<p><img src="/img/panorama-homography/warpImage.jpg"></p>
<center style="color: #666;">
<p>An example transformation acting on our image.</p>
</center>

<p>But we have a <em>big</em> problem here: the typical linear transformation does not allow for translations. By the qualities of linear transformations, the origin cannot move, therefore forcing the bottom left corner of our images to always overlap! That&#39;s pretty restrictive in terms of the panoramas we can make—and for practical purposes—a complete nonstarter. If we want to continue through with making a panorama, we&#39;ll need to find a way around translations.</p>
<h3 id="homogenous-coordinates-and-affine-transformations">Homogenous Coordinates and Affine Transformations</h3>
<p>There&#39;s a very sneaky workaround being confined to the origin. To do so, we&#39;ll need to do something that might seem a bit weird to do translations. Let&#39;s rewrite our 2D points with a <em>3rd</em> coordinate. For a given $(x,y)$, let&#39;s rewrite that with a $z$-coordinate $(x,y,1)$. If $z \neq 1$, then we can just divide all the other coordinates by $z$ to make it equal to 1: $(x,y,w) \rightarrow (\frac{x}{w}, \frac{y}{w}, 1)$ (we generally use $w$ to represent the $z$-coordinate to indicate that there is no &quot;real&quot; $z$ value since everything is projected into 2D; we use $w$ as a &quot;weight&quot; to say how much we scale our projections down to). This means we have multiple coordinates represent the same point. In this way, $(2,5,1)$ and $(4,10,2)$ and $(-3,-7.5,-1.5)$ and $(2w,5w,w)$ all represent the same point (we don&#39;t include points when $z=0$ as it represents a point at infinity).</p>
<p>This might seem arbitrary, but what we&#39;re doing here is not too different than our original, 2-coordinate system. When we look at a cross-section of the $xyz$ coordinate space, it looks exactly like the $xy$ plane. What we are doing here is projecting all of $xyz$ space onto the plane $z=1$. </p>
<p><img src="/img/panorama-homography/homogeneousCoords.png"></p>
<center style="color: #666;">
<p>The geometry of projecting points onto $z=1$ is equivalent to finding drawing line through the origin and the point, and finding where it intersects that plane.</p> 
</center>

<p>In fact, many of you are already familiar with <strong>homogeneous coordinates</strong> (representing 2D points with a 3rd scalar coordinate) and <strong>projective planes</strong>! When you take a photo on your phone, how does the camera know what&#39;s drawn in its frame? How does it take a 3-dimensional world and put it into a 2-dimensional picture? The many light rays that enter the camera lens (the origin) will intersect a plane ($z=1$) based on its focal length, and colors the pixel based on the projection.</p>
<p><img src="/img/panorama-homography/projectivePlane.png" style="width: 400px"></p>
<center style="color: #666;">
<p>A photo is homogeneous coordinates in disguise. While there&#39;s many sides to the building, our camera only cares about what it sees in front of it (a.k.a., what gets projected onto the frame). Our worldview is contained to a small projection.</p>
</center>

<p>Using this analogy with photos, clearly translations should be possible! If you&#39;ve seen any cat videos on the internet, clearly it is possible for the cat to enter and exit the frame freely without the camera necessarily moving, and that is precisely possible due to the fact the origin $(0,0,0)$ is not contained in our projective plane $z=1$, since all of our basis vectors have to stem out of the origin! (For those interested a translation matrix is equivalent to a shear along the $z$-axis.)</p>
<p>Think about what we&#39;re doing here: we&#39;re turning a linear transformation in 3-dimensions to create special non-linear <strong>affine transformations</strong> in 2-dimensions! When I first learned this geometrically, awe can&#39;t encapsulate the total shock I felt. So, if we&#39;re given a point $p$, we can transform it with a matrix $M$ to get its image $p&#39;$.</p>
<center>
$
Mp =
\begin{bmatrix}
a &amp; b &amp; c \\
d &amp; e &amp; f \\
g &amp; h &amp; i 
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
1 
\end{bmatrix}
=
\begin{bmatrix}
wx&#39; \\
wy&#39; \\
w \\ 
\end{bmatrix}
=
\begin{bmatrix}
x&#39; \\
y&#39; \\
1 \\ 
\end{bmatrix}
$
</center>

<p>(Notice how $M$ is now a $3 \times 3$ matrix as we are working with 3D coordinates now) These projections with homogeneous coordinates are known as <strong>homographies</strong>. When we take one picture, and reproject it according to a matrix like this but <em>keeping the same camera center</em> (like the origin), we call it a homography. Again, like homogeneous coordinates, people have been leveraging homographies artistically for a while now. That weird, perspective stree art you might have seen before? That&#39;s the most manual you can get to using homographies—literally warping images with the angle you look at them to make them appear at a normal proportion.</p>
<p><img src="/img/panorama-homography/manual-homography.jpeg"></p>
<center style="color: #666;">
<p>Street artists have used the power of perspective for a long time.</p>
</center>

<p>What we&#39;re doing is computing a homography to build a <strong>mosaic</strong>. Just like the decorative tile art, we are taking tiles of photos that we transform to overlap, and them stitching them all together into one, broader image.</p>
<p>Moreover, our homographies have a really funny interpretation to them. Since we are reprojecting pictures, what it geometrically looks like is that we&#39;re taking two photos which should be rotated in space (as you would spin taking the panorama), and <em>taking a photo of the two photos</em>. Photo-ception.</p>
<p><img src="/img/panorama-homography/photoception.png"></p>
<center style="color: #666;">
<p>If you take a photo of two existing photos, you get one photo that unites the two together. If we can find out the right way to take the photo such that the overlap is correct, we get a panorama.</p>
</center>

<p>There are other ways to reproject images to make other mosaics with the own benefits and downsides, but this is what we&#39;ll use for now. Benefits with this type of mosaics? They are (relatively) easy and fast(er) to compute. Downsides? Since we are projecting onto a plane like this, we can only take panoramas up to 180° wide (can you see why?).</p>
<h2 id="one-slight-issue-">One Slight Issue…</h2>
<p>While it&#39;s great that we are able to transform points with matrices, let me remind us what our goal is.</p>
<p><img src="/img/panorama-homography/desk1labels.jpg">
<img src="/img/panorama-homography/desk2labels.jpg"></p>
<p>We have these two photos, where we want to transform one image&#39;s points to overlap with the other&#39;s. In terms of our matrix arithmetic from before, we have $p$ and $p&#39;$, but no matrix $M$... Up to this point we have been finding our image points using our own matrices, but how do we find that intermediate matrix given a point and its image?</p>
<h2 id="regressions-and-4-dimensional-lines">Regressions and 4-Dimensional Lines</h2>
<p>Like homogeneous coordinates, many of you will already be familiar with solving for the intermediate matrix given a $p$ and $p&#39;$. Let&#39;s do it with a simpler example.</p>
<p>If you had the points $(1,2)$ and $(6,4)$, and I needed you to find the line $y=mx+b$ that went through them, most of you would be able to do that. We&#39;d set up a system of linear equations</p>
<center>
$\begin{align}
2 &amp; = m(1) + b \
\newline
4 &amp; = m(6) + b
\end{align}$
</center>

<p>and solve for $m$ and $b$ respectively. In this case, $m=\frac{2}{5}$ and $b=\frac{8}{5}$. Simple algebra with little to worry about here. What is important to note here is that we <em>could</em> solve for a unique $m$ and $b$, since two points define one unique line.</p>
<p><img src="/img/panorama-homography/ordinaryLine.png"></p>
<center style="color: #666;">
<p>An ordinary line going between two points.</p>
</center>

<p>But what if I introduced a third point $(p_3,p_3&#39;)$? Or even a 4th point $(p_4,p_4&#39;)$? How do we draw a line through those 4 points? There might be a line that goes through all 4 points, but it&#39;s highly unlikely.</p>
<p><img src="/img/panorama-homography/linRegression.png"></p>
<center style="color: #666;">
<p>While there&#39;s no one line through all 4 points, what&#39;s the <em>closest</em> to a line we can get?</p>
</center>

<p>We may not have <em>exact</em> values for $m$ and $b$, but what&#39;s the best value for both to get the <em>closest</em> solution to this system of equations?</p>
<center>
$\begin{align}
p_1&#39; &amp; = m(p_1) + b \
\newline
p_2&#39; &amp; = m(p_2) + b \
\newline
p_3&#39; &amp; = m(p_3) + b \
\newline
p_4&#39; &amp; = m(p_4) + b
\end{align}$
</center>

<p>That&#39;s a task as simple as plugging it into a spreadsheet and doing a <strong>linear regression</strong>. More specifically, we can use the common <strong>least-squares regression</strong> where we want to minimize not the sum of the errors, but the sum of the square of the errors (as the name would suggest). For those a little more comfortable working with matrices and linear algebra, here&#39;s a <a href="#aside-least-squares-with-linear-algebra">more in-depth explanation</a> of what we&#39;re doing with our data when finding a regression.</p>
<p>To many, this might seem like an obvious thing to do; everyone from middle schoolers to office workers have been finding trend lines forever. But what we did here is pretty useful when we think more abstractly: given a system of linear equations that correlated independent data $p$ with their dependent data $p&#39;$, we were able to solve for the <strong>best coefficients of that system of linear equations</strong> that most closely solved the system (in the previous case was $m$ and $b$). Finding a line was a nice byproduct, but what we&#39;re really doing here is solving that system of linear equations.</p>
<p>Now I promise this will be helpful. Let&#39;s look at our original expanded matrix equation of $Mp = p&#39;$.</p>
<center>
$
\begin{bmatrix}
a &amp; b &amp; c \\
d &amp; e &amp; f \\
g &amp; h &amp; 1 
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
1 
\end{bmatrix}
=
\begin{bmatrix}
wx&#39; \\
wy&#39; \\
w \\ 
\end{bmatrix}
$
</center>

<p>Remember, we&#39;re working in homogeneous coordinates, so $p&#39;$ might not land on the plane $z=1$, and we account for that with $w$ here. I also set $i=1$, since a) that corresponds with a certain scaling and is not necessarily unique vector, but more importantly b) gives us one less variable to solve for.</p>
<p>Here, we will need to actually do the matrix-vector multiplication, and carrying it out nets a system of linear equations! (I know I said you won&#39;t need to know the mechanics of these operations, but it&#39;s hard to avoid it now. If you can accept this fact, that&#39;s great, but I&#39;d recommend looking <a href="https://youtu.be/XkY2DOUCWMU">here</a> if you are unfamiliar.) </p>
<center>
$\begin{align}
ax + by + c &amp; = wx&#39; \
\newline
dx + ey + f &amp; = wy&#39; \ 
\newline
gx + hy + 1 &amp; = w
\end{align}$
</center>

<p>Using the third equation in tandem with the first two…</p>
<center>
$\begin{align}
ax + by + c &amp; = (gx + hy + 1)x&#39; \
\newline
dx + ey + f &amp; = (gx + hy + 1)y&#39; 
\end{align}$
</center>

<p>Just like before, we can solve for $a$, $b$, $c$, $d$, $e$, $f$, $g$, and $h$ with a least-squares regression! Since we have 8 variables, at minimum we need 8 equations or 4 pairs of $p$ and $p&#39;$ (since each pair contains two equations: one for $x&#39;$ and one for $y&#39;$). Though, just like we have 10 points, generally it is better to have more data and overfit than less (we&#39;d rather have an overall average fit, than just 4 points be <em>exatly</em> where we want them to be). It&#39;s weird to think of this geometrically, since what we&#39;re doing here is not finding the line between one independent variable and one dependent variable, but rather <em>two</em> independent variables $(x,y)$ with <em>two</em> corresponding dependent variables $(x&#39;,y&#39;)$; our regression exists in 4-dimensions!</p>
<h2 id="putting-it-all-together">Putting It All Together</h2>
<p>Let&#39;s quickly reflect on what we&#39;ve covered thus far.</p>
<ol>
<li>We&#39;ve redefined coordinates purely with vectors, allowing us to nicely compact our image-warping transformations in matrices.</li>
<li>Our original definition of coordinates failed to include translations—a key transformation. We described 2-dimensional points in 3-dimensions with homogeneous coordinates, resolving our worries.</li>
<li>We then ran into ANOTHER problem in that while we knew how to warp images <em>given</em> the transformation matrix, we really wanted to be able to find the matrix given a starting point and an end point to map to.</li>
<li>Using a least-squares regression, we were able to turn our unknown matrix equation into a system of linear equations that were much easier to work with to compute our homography (sort of, see the <a href="#aside-least-squares-with-linear-algebra">aside</a> below).</li>
</ol>
<p>Let&#39;s use this first photo to give our list of points $p$.</p>
<p><img src="/img/panorama-homography/desk1labels.jpg"></p>
<p>And we&#39;ll try to match those red points to these blue points on the second photo: our list of $p&#39;$.</p>
<p><img src="/img/panorama-homography/desk2labels.jpg"></p>
<p>Having the computer compute the transformation matrix, we take that matrix and multiply every pixel (remember, treating them as coordinates/vectors), and warping the first image. Then, we can overlay them to see how close our points line up! If our points were well selected, and our computed homography—with the least-squares regression—has minimal error, we should get a pretty decent attempt at a panorama.</p>
<p><img src="/img/panorama-homography/firstPano.jpg"></p>
<p>Sure, the blending isn&#39;t great, and it didn&#39;t <em>completely</em> fix the overlap issue, but the seams and photo stitching definitely is much nicer! And honestly, it&#39;s pretty cool seeing how the image was transformed and finding the outline of the images cross like that.</p>
<p><img src="/img/panorama-homography/firstPanoOutline.jpg"></p>
<p>With some simple masking and basic filtering (basically averaging every pixel&#39;s color with the pixels around it), suddenly it really begins to look clean.</p>
<p><img src="/img/panorama-homography/panorama.jpg"></p>
<p>While this is cool, it does reveal another unfortunate downside of our choice of mosaic: if we want a uniform picture, we have to sacrifice a lot of data. </p>
<p><img src="/img/panorama-homography/panoramaCrop.jpg"></p>
<p>Even so, it doesn&#39;t even look that bad. All in all, though, not a bad first attempt at building a panorama.</p>
<h2 id="what-next-">What Next?</h2>
<p>While we have a working prototype, we can do signficantly better. For one, I used only 10 labelled points to compute our homography, but if you use even more, it&#39;s not hard to get a better, and closer fit. With algortihms like <a href="https://zju3dv.github.io/loftr/">LoFTR</a>, finding lots of corresponding labelled points between multiple images is quick and easy.</p>
<center>
<video width="85%" playsinline="" autoplay="autoplay" loop="loop" preload="" muted="">
      <source src="/img/panorama-homography/loftr-homepage-demo.mp4" type="video/mp4">
</center>
<center style="color: #666;">
<p>Some really smart people made an algorithm specifically to finding high quality object matching between multiple photos. Credit: LoFTR Team</p>
</center>

<p>Also, since we are manually constructing our panorama, we can stitch and blend photos that have no right being together in a panorama.</p>
<p><img src="/img/panorama-homography/lightdark2.jpg"></p>
<center style="color: #666;">
<p>Going from a well-lit to a dark photo makes for some artsy renditions (even more if you blend it a little nicer).</p>
</center>

<p>We never really touched on our homographies, either. When we decided 10 initial points $p$ and 10 warped points $p&#39;$, our $p&#39;$ was decided as a result of lining up 2 photos. What if we didn&#39;t want to line up multiple photos, but rather just creatively warp a single photo? </p>
<p><img src="/img/panorama-homography/rectification.jpeg"></p>
<center style="color: #666;">
<p>Something not quite lined up? A simple homography can fix that for us.</p>
</center>

<p>This is know as <strong>rectification</strong>, as it is a means to correct for mistakes we might have had in our photo.</p>
<p>Finally, the last improvement we can make to our mosaics is trying new projections and warpings. If we want something even as simple as just wider, up to 360°, full views, we&#39;ll need to find something more robust than our previous approach. Or what if we wanted to make something akin to a full photosphere like from before?</p>
<p><img src="/img/panorama-homography/PHOTOSPHERE.jpg"></p>
<p>What we did today was simply <strong>planar projection</strong>, or just reprojection onto a plane. We did that with homogenous coordinates. For wider, more complete mosaics, we&#39;ll need either <strong>cylindrical</strong> or <strong>spherical projection</strong>, which is exactly what it sounds like. These have their own benefits like wider field of view, but because of the nature of projecting onto a curved surface, the images being stitched together do tend to, well, curve. The type of mosaic one uses comes down to preference and artistic need. For more on this, I recommend reading these <a href="https://inst.eecs.berkeley.edu/~cs194-26/fa21/Lectures/MoreMosaics.pdf">slides from UC Berkeley</a>&#39;s introductory computer vision and computational photography class.</p>
<p>I hope this gave an interesting peak at the intersection of linear algebra and photography, and more over, I hope this gave you an appreciation for the math your phone goes through every time you take a panorama. </p>
<p>If you&#39;re interested, here&#39;s a link to a <a href="https://colab.research.google.com/drive/1bgOaBnHTlKx-DYfLg2HmtsaFekWgwJFn?usp=sharing">Python notebook</a> where you can see some of my experiments during my struggle and exploration with panoramas and homographies.</p>
<hr>
<h2 id="aside-least-squares-with-linear-algebra">Aside: Least-Squares with Linear Algebra</h2>
<p>Okay, this previous section is really hard to describe without already knowing a fair amount of linear algebra, and it felt a little flat without having a more methodical procedure of solving a least-squares regression. I wasn&#39;t planning on including this section, but it felt incomplete otherwise. For those interested, feel free to peer over it, but this is not necessary within the scope of this post; all you need to understand is what our regression is accomplishing, thinking of that &quot;line of best fit&quot; idea.</p>
<p>Let&#39;s go back to when we were trying to find a line between two points. If you have 2 points, $(p_1, p_1&#39;)$ and $(p_2, p_2&#39;)$ being fit to the line $y=mx+b$, we have a system of linear equations like before.</p>
<center>
$\begin{align}
p_1&#39; &amp; = m(p_1) + b \
\newline
p_2&#39; &amp; = m(p_2) + b
\end{align}$
</center>

<p>We can solve this just like we did before to find $m$ and $b$, but there&#39;s a secret matrix equation embedded into this system. </p>
<center>
$
\begin{bmatrix}
p_1&#39; \\
p_2&#39;
\end{bmatrix}
=
\begin{bmatrix}
p_1 &amp; 1 \\
p_2 &amp; 1
\end{bmatrix}
\begin{bmatrix}
m \\
b
\end{bmatrix}$
</center>

<p>In a sense, that&#39;s what a matrix is: a system of linear equations, and you can freely go between either a system of linear equations or a matrix via matrix multiplication. (I know I said you won&#39;t need to know the mechanics of these operations, but it&#39;s hard to avoid it now. If you can accept this fact, that&#39;s great, but I&#39;d recommend looking <a href="https://youtu.be/XkY2DOUCWMU">here</a> if you are unfamiliar.)</p>
<p>If we write this in general terms, we are basically solving the equation</p>
<center>
$b = Ax$
</center>

<p>where $A$ is a matrix, and $b$ and $x$ are vectors, and we are solving for the latter. It might seem pointless to rewrite it, but what we&#39;re actually solving is</p>
<center>
$Ax - b = 0$
</center>

<p>Since $Ax$ is <em>exactly</em> equal to $b$; $Ax$ is the same vector as to $b$. We were able to find a unique line with $m$ and $b$ through them, no? Just as we were able to solve the system of linear equations before, we can easily solve this with matrix inverses:</p>
<center>
$A^{-1}b = x$
</center>

<p>Now, let&#39;s add more points.</p>
<center>
$\begin{align}
p_1&#39; &amp; = m(p_1) + b \
\newline
p_2&#39; &amp; = m(p_2) + b \
\newline
p_3&#39; &amp; = m(p_3) + b \
\newline
p_4&#39; &amp; = m(p_4) + b
\end{align}$
</center>

<p>Now we turn this into a matrix equation like before.</p>
<center>
$
\begin{bmatrix}
p_1&#39; \\
p_2&#39; \\
p_3&#39; \\
p_4
\end{bmatrix}
=
\begin{bmatrix}
p_1 &amp; 1 \\
p_2 &amp; 1 \\
p_3 &amp; 1 \\
p_4 &amp; 1
\end{bmatrix}
\begin{bmatrix}
m \\
b
\end{bmatrix}$
</center>

<p>We know that there&#39;s a good chance our four points don&#39;t all lie on the same line. So it&#39;s unlikely that $Ax - b = 0$. Moreover, now that our matrix $A$ isn&#39;t square, we can&#39;t just use inverses to solve for $x$. So instead, we want to get a line that gets <em>as close</em> to 0 (a.k.a. being a perfect fit). So our goal is to </p>
<center>
$\min||Ax-b||^2_2$
</center>

<p>We know $A$ and $b$ with $x$ as our unknown—this sort of looks like a parabola-y equation! When we minimize a single variable function, we do so with the derivative. We can do the same thing here except with the multivariable equivalent: the gradient. So, we know the minimum occurs where the gradient of this function is 0.</p>
<center>
$\nabla_{x}||Ax-b||^2_2 = 0$
</center>

<p>Even if you&#39;re not familiar with multivariable calculus, much of the following should still look vaguely familiar to the chain and power rules of single-variable calculus.</p>
<center>
$\begin{align}
\nabla_{x}||Ax-b||^2_2 &amp; = 0 \
\newline
2A^T(Ax-b) &amp; = 0 \
\newline
2A^TAx - 2A^Tb &amp; = 0 \
\newline
A^TAx &amp; = A^Tb
\end{align}$
</center>

<p>All finally simplifying to the very nice formula of</p>
<center>
$x = (A^TA)^{-1}A^Tb$
</center>

<p>I like this approach for it&#39;s intuitive roots from the geometry of single-variable calculus, but if you want a more strictly linear algebra approach, here&#39;s this excerpt from <a href="https://textbooks.math.gatech.edu/ila/least-squares.html">Georgia Tech</a> that explains another proof for the same formula:</p>
<hr>
<p><strong>Theorem.</strong> Let $A$ be a $m \times n$ matrix and let $b$ be a vector in $\mathbb{R}^m$. The following are equivalent:</p>
<ol>
<li>$Ax=b$ has a unique least-squares solution.</li>
<li>The columns of $A$ are linearly independent.</li>
<li>$A^TA$ is invertible.</li>
</ol>
<p>In this case, the least-squares solution is</p>
<center>
$x = (A^{T}A)^{-1}A^{T}b$
</center>

<p><strong>Proof.</strong> The set of least-squares solutions of $Ax = b$ is the solution set of the consistent equation $A^TAx = A^Tb$, which is a translate of the solution set of the homogeneous equation $A^TAx = 0$. Since $A^TAx$ is a square matrix, the equivalence of [facts] 1 and 3 follows from the invertible matrix theorem. The set of least squares-solutions is also the solution set of the consistent equation $Ax=b_{\textrm{Col}(A)}$, which has a unique solution if and only if the columns of A are linearly independent. </p>
<hr>
<p>Basically, it says if our system of linear equations contain only unique equations (i.e. no one equation is a multiple of another), we can turn our non-square matrix $A$ into a square one by multiplying by its transpose $A^T$, and solve our least squares the way we&#39;d solve it before with inverses. In other words, if our matrix follows the criteria listed above, our minimizing solution comes from creating an equivalent equation with an invertible matrix:</p>
<center>
$\begin{align}
Ax &amp; = b \
\newline
A^TAx &amp; = A^Tb \
\newline
(A^TA)^{-1}A^TAx &amp; = (A^TA)^{-1}A^Tb \
\newline
x &amp; = (A^TA)^{-1}A^Tb
\end{align}$
</center>

<p>Netting precisely the same formula as before.</p>
<p>Now, let&#39;s recall the our matrix equation from before of the homography we wanted to solve. </p>
<center>
$
\begin{bmatrix}
a &amp; b &amp; c \\
d &amp; e &amp; f \\
g &amp; h &amp; 1 
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
1 
\end{bmatrix}
=
\begin{bmatrix}
wx&#39; \\
wy&#39; \\
w \\ 
\end{bmatrix}
$
</center>

<p>Then, we expanded this into 3 linear equations, and further simplified them to the following two:</p>
<center>
$\begin{align}
ax + by + c &amp; = (gx + hy + 1)x&#39; \
\newline
dx + ey + f &amp; = (gx + hy + 1)y&#39; 
\end{align}$
</center>

<p>This, can be rewritten as another, secret matrix equation:</p>
<center>
$
\begin{bmatrix}
x &amp; y &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; -x&#39; \cdot x &amp; -x&#39; \cdot y \\
0 &amp; 0 &amp; 0 &amp; x &amp; y &amp; 1 &amp; -y&#39; \cdot x &amp; -y&#39; \cdot y
\end{bmatrix}
\begin{bmatrix}
a \\
b \\
c \\
d \\
e \\
f \\
g \\
h 
\end{bmatrix}
=
\begin{bmatrix}
x&#39; \\
y&#39;
\end{bmatrix}
$
</center>

<p>Wait, we turned our original matrix equation into another one? As awful as that may look, this is much more useful than our original equation since now, all of our unknowns are in a vector instead of a matrix; it really is no different than our previous least-squares examples, and we&#39;re still solving for the vector $x$ in</p>
<center>
$Ax = b$
</center>

<p>So, we can still solve it like before finding </p>
<center>
$x = (A^{T}A)^{-1}A^{T}b$
</center>

<p>And with that, we now have also gone through what our program is doing under the hood, and have gone through some of the tedium of justifying what a least-squares regression is from a linear algebra perspective.</p>
]]></description>
         <link>http://xperimex.github.io/blog/panorama-homography</link>
         <guid isPermaLink="true">http://xperimex.github.io/blog/panorama-homography</guid>
         <dc:creator><![CDATA[Adi Mittal]]></dc:creator>
      </item>
   </channel>
</rss>